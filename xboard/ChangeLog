ChangeLog for XBoard/WinBoard
-----------------------------

(latest entries created by git log --no-merges --pretty="%ai %an <%ae>:%n%s%n%n%b" vlast.. )

2013-08-27 22:55:52 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix -zippyVariants option

Due to the change of cps->variants from (char []) to (char *), copying
zippyVariants to it on behalf of v1 engines would no longer work. This
is fixed by using ASSIGN() in stead of safeStrCpy().

2013-08-26 18:25:55 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix initial board sizing WB

The initial board size was based on the assumption the board would be 8x8.
This could push auxiliary windows off screen if the board was smaller,
after which EnsureOnScreen would undock them and park them in the upper-
right corner before the board assumed its true size. InitPos() is now called
before the initial sizing to et the board format correctly, InitDrawingSizes()
had to be made resitant to calling before a board size was picked for this
(because InitPos() might call that too).
  ActivateTheme() now uses the new board size, not the previous one (as was
indicated by size -2), so that -boardSize specifications inside a theme
will take effect.
  Board size petite should not be forbidden for Shogi; all pieces exist there.

2013-08-26 14:40:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix grabbing of selected piece

A second static click on a selected piece should deselect it, but an attempt
to drag an already selected piece should not 'bounce off'. It was already
possible to move a selected piece to another square, but the dragging was
not animated. This is now fixed, by only skipping the code to start dragging
when the second click is part of the only-move double-click for only capture.
(Before it was skipped on any second click.)

2013-08-26 13:35:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow entry of negative numbers in spin control (WB)

Windows numeric controls do not accept negative numbers, so in case the
range of a spin option can go negative, the style ES_NUMBER should not be
set on the control.

2013-08-26 11:37:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow drops / promotions/ deferrals to be edited into book

For no real reason only NormalMove would be accepted when parsing the list
of book moves.

2013-08-26 11:28:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix GUI book after setup position

The routine to send move to the engine would automatically append a 'go'
is a preious setboard had put the engine in force mode, but this should
not happen on a book hit, where the engine should even be put in force mode
if it was not yet there.

2013-07-05 18:32:46 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix book creation

Due to duplicate use of the same file pointer variable the game file would be
closed before any games were read from it.

2013-05-20 11:14:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make PGN parser immune to unprotected time stamps

The parser choked on time stamps of the form dd:dd or dd:dd:dd if one
of the fields happened to be 00, because it wouldmistake that for a
non-compliant king-side castling. By excluding this interpretation when
the 00 is immediately preceded or followed by ':' this is now prevented.

2013-05-05 08:03:00 -0700 Arun Persaud <arun@nubati.net>:
updated po files for new release (make distcheck)


2013-05-05 07:57:22 -0700 Arun Persaud <arun@nubati.net>:
new version number for release 4.7.1


2013-05-05 07:53:54 -0700 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.


2013-05-02 22:47:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update zippy.README

It is explained how to generate multi-line commands for -zipyGameEnd.

2013-04-01 20:43:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Xaw file browser

The 'next page' entry of the Xaw file browser contained a \177 character
to keep at sorted at the bottom. This caused trouble for gettext.
Now the sorting range is adapted so the 'next page' is never part of it.
  More seriously, the listbox fill code had a wrong cast when testing for
an empty listbox on the first element, so that it only tested the low byte
of the pointer, in stead of the entire pointer for NULLness. As a result
the contents of the listboxes could suddenly disappear when even when it
was non-empty, because the first filename was allocated at an unlucky address.

2013-03-22 19:23:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make Chat Box window obey -topLevel option

It was always popping up as a dialog of the main board, covering it.
One could argue it should always be to-level.

2013-03-19 13:20:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix scrolling of Chat Box

Seems the problem is that scroll_to_iter does not work until after some time,
needed to calculate line heights. Use scroll_to_mark instead, after clumsily
adding a text_mark.

2013-03-17 10:33:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix GTK SetInsertPos

SetInsertPos() was not yet ported to GTK, with as a result that the cursor
was positioned at the start of a line recalled in the ICS Input Box,
rather than at the end. The code also called SetInsertPos to force scrolling
to that point in the text (which in Xaw is an automatic side effect). So for
multi-line text edits this function calls ScrollToCursor(). For some reason
this does not work when replacing texts in the Chat Box memo, when switching
chat, although it does work in the same memo when a line is added to the
existing text.

2013-03-07 21:38:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Print score of final position in Analyze Game

The score/depth of the final position of the analyed game is added
(as an explicit comment) behind the PV of the forelast position.
To make this work, a new 'addBraces' mode (3) had to be added to
AppendComment, which suppresses stripping of the score/depth from
the comment.

2013-03-12 18:50:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix horrible bug in reading scores from PGN

Reading scores like -0.94 flipped the sign, because the integer part
-0 would read as 0, and thus was no reason for sign flipping.

2013-03-10 12:43:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix disappearence of pieces that were moved illegally

Dragging damages the from-square, but it is not marked as such, because
selective board redraws to update highlights and such would draw the piece
that is really still there, making it flash on the from-square before
the position after the move is drawn. This, however, backfires when the
move was illegal, as then there is no draw of a new position, and the
from-square stays empty. For now this is solved by making DisplayMoveError()
order a total redraw. (As this is rare, only done in case of an error,
and might even throw up a pop-up, the performance cost of this is acceptable.)

2013-03-20 17:50:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix quoting of book name in tourney file

The argument of -polyglotBook was written to the tourney file unquoted,
which effectively made it disappear if it was an empty or blank string.

2013-03-07 18:11:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Provide compatibility with Alien Edition setup command

The setup command of the Alien Edition has a board-size specifier
(possibly as prefix on a parent-variant name) between pieceToCharTable
and FEN. The regular version would choke on that, precluding engines
designed for the Alien protocol extension to have their setup processed
when running under regular XBoard. This patch makes it skip the extra info.

2013-03-07 17:52:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix saving of analyzed game

Anotated games after batch-mode Analyze Game were not auto-saved,
because the GameEnds() call supposed to do that was called with a NULL
argument for resultDetails. Now it is called with the resultDetails as
pre-existing in the gameInfo, or an empty string if none exist. This bug
was masked by the fact that in standard game ends (mate, etc.) the
analyzing engine would declare game end and supply a message.
 Also makes a distinction between Analyze Game and regular Analyze mode
when resuming analysis after loading a game; only the former now would
trigger a batch analysis.

2013-03-07 17:48:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix spurious popup after batch-mode Analyze Game

A batch analysis of games was not properly terminated, because the game
mode was tested after it had already been changed. No oldGameMode is
tested in stead.

2013-03-02 22:21:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let XBoard -autoBox option also affect move type-in


2013-03-02 22:17:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix GTK box popup

Key values > 255 are used for PgUp, PgDown etc., so to pop up only on
printables needs a two-sided test.

2013-03-01 12:50:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix fatal error on unsupported board size

When a board size unsupported by the engine was requested through the
New Variant dialog, this was discovered while the dialog was still up,
causing the error message to pop up as a child of the New Variant dialog,
so that it would immediately be taken down as the latter closed.
As a result it could not be confirmed, so that XBoard would not exit, and
was left in a pathologic state (ignoring window-close). This is fixed
by performing Reset (which detects the error) after PopDown of New Variant.

2013-03-01 12:39:40 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Accept setup command for non-standard board size

The code to test if board-size is standard for the current variant
has been moved to a subroutine, to allow its calling when receiving
a "setup" command from the engine.

2013-03-01 11:57:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix buffer overflow in feature parsing

String features (variants, egt, myname and option) relied on a buf[MSG_SIZ]
for processing their value. The Nebiyu engine had combobox options that
required more than that. All string features are now stored in allocated
memory rather than in static arrays, and StringFeature allocates a buffer
of sufficient size for them. Only limitation now is the low-level input
buffer in the InputSource threads, whih is a static buffer of 4096
(=INPUT_SOURCE_BUF_SIZE) characters.

2013-02-27 23:44:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix vertical sizing of GTK board

The clipping of the boad at the bottom was due to resizing of the clock
height when we first write it with a big font. This patch delays calculation
of the final size until after the clock height changes.

2013-02-26 21:13:32 -0800 Arun Persaud <arun@nubati.net>:
Updated German translation


2013-02-26 20:27:24 -0800 Arun Persaud <arun@nubati.net>:
Updated Ukrainian translations


2013-02-26 17:59:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix of argument error

Oops. Pevious patch for skipping unknown multi-line arguments
was still buggy.

2013-02-26 17:44:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let popping up of WinBoard chatbox for channel open it

WinBoard now issues a +ch command for a channel when you pop up a chatbox
for that channel. A work-around is added for the fact that the public
FICS seems to ignore the first such command.

2013-02-26 17:27:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make skipping of unknown option smarter

To make XBoard better resistant to the presence of disbanded or future
options in its settings file, encountering those is no longer a fatal error.
But the error recovery only consisted of skipping the rest of the line.
This fails badly on string options with a multi-line value, which is
enclosed by {braces}. We now detect that case, to skip to } instead.

2013-02-26 17:15:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add -backupSettingsFile option

For better configurability of WinBoard, an option is added to optionally
read a settings file, namely if no other settings file (other than the
master file) was read so far. This can be used to import settings from
a previous version, without destroying its settings file.

2013-02-26 16:55:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Repair WinBoard compile error

__GITVERSION was not defined in WinBoard, as it was only defined with a
compiler flag by ./configure, which WinBoard does not use.

2013-02-26 16:47:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Work-around for Xt selection bug

In some Xt implementations calling extend-end with 0 params causes a crash,
although the mmanual specifies this should default to a call with 'PRIMARY'.
The default selection is now explicitly mentioned in all extend-end calls.

2013-02-24 09:31:57 -0800 Christoph Moench-Tegeder <cmt@burggraben.net>:
fix bug #38401: xboard.texi doesn't build with texinfo-5.0 (tiny change)

xboard-4.7.0's documentation is not buildable with texinfo-5.0, it fails with a lot of error messages from makeinfo like
./xboard.texi:1026: @itemx must follow @item
makeinfo seems right, @itemx is not used as described in the texinfo manual.
Attached patch puts each item of the "Options" menu in it's own @subsection and formats the description of each item as a @table as neccessary. This way, xboard builds again and the manual doesn't look too bad.

2013-02-24 09:09:54 -0800 Arun Persaud <arun@nubati.net>:
updated po/pot files


2013-02-24 09:04:48 -0800 Arun Persaud <arun@nubati.net>:
new version number for developer release


2013-02-20 21:28:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Try to make life more bearable in Xaw menus

The alignment still sucks, but not as much as before.

2013-02-20 19:26:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix -topLevel option

This option was copletely ignored, after the refactorig.

2013-02-20 18:16:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix testing for valid window placement Xaw


2013-02-20 12:15:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress printing of status line in dual-board mode


2013-02-20 11:56:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix sizing of slave board GTK

For lack of a known method to specify a default size for Graph widgets,
we have to use the same system as for the main board: create with 0x0 size,
and measure the size of the outer window to determine margins.
After every popup we then resize to the required board size plus these
margins. (Awful...)

2013-02-20 10:08:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Better handling of undefined window parameters

Repositioning and resizing a newly created dialog was based on the width
parameter of the stored sizing info being valid. Now it is separately
tested if the position is valid, so that sizing and moving can be done
independently. This allows us to store position info, but not size info
for the slave board, so that it automatically will use the size of the
main board when first opened.

2013-02-19 19:14:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Limit debug print to debug mode


2013-02-19 19:14:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix repositioning of GTK windows

After 'hide' and 'show' GTK would not position the window in the same place,
but center it on the parent. Now we reposition the window after 'show' based
on the WindowPlacement data (if available).

2013-02-19 18:52:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remember window params of slave board

The slave board now has been assigned a WindowPlacement, which is also
saved in the settings file, through new options -slaveX/Y/W/H.

2013-02-19 17:48:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix repairing of arrow damage

The '2' bit in damage[][] to indicate the arrow was erroneously cleared,
rather than kept.

2013-02-18 19:55:20 -0800 Arun Persaud <arun@nubati.net>:
fix OK-response in gtk dialogs, see c7f8df124

the fix in c7f8df124 needs to be applied to both of those if cases

2013-02-18 17:11:32 -0800 Arun Persaud <arun@nubati.net>:
removed two more translations from debug output


2013-02-18 17:09:30 -0800 Arun Persaud <arun@nubati.net>:
fixed segfault of g_markup_printf_escaped which needs utf-8 strings

defined text-domain as utf-8 solved this

2013-02-18 13:38:51 -0800 Arun Persaud <arun@nubati.net>:
fixed gtk-warning


2013-02-18 10:06:36 -0800 Arun Persaud <arun@nubati.net>:
removed some translation calls for messages in the debug log


2013-02-18 09:46:53 -0800 Arun Persaud <arun@nubati.net>:
add keyboard shortcuts back into Xaw version


2013-02-17 14:13:30 -0800 Arun Persaud <arun@nubati.net>:
in debug mode also print the git-version if available during build


2013-02-18 21:19:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Print game-list timing messages only in debug mode


2013-02-18 21:01:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix title of top-level windows


2013-02-18 18:51:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Cure GTK warning in top-level windows

There is no OK button in top-level windows, so the 'response' signal is
not defined, and should not be connected.

2013-02-18 18:33:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix graying of Revert menu item

The new code was checkmarking it in stead of enabling it!

2013-02-18 11:38:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add -onlyOwnGames option

This suppresses auto-saving of ICS observed games.

2013-02-18 11:17:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow display of 50-move counter in zippy mode

No chance it could be considered cheating there.

2013-02-18 10:48:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add new vertical pixel fudge

With the new GTK window type the board is 13 pixels too small.

2013-02-18 10:29:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Don't add PV moves on board clicking in AnalyzeMode

Playing PV moves by right-clicking the PV was only intended for clicks
in the engine Output window, selecting from multi-PV analysis output,
where by default it plays only the first move. PV walkig by right-clicking
the board, however, would start the walk at the end even in AnalyzeMode,
and thus add the entire PV. Which is probably not useful. So adding moves
in that case has now completely been suppressed, so it can be used for
harmless viewing of the latest PV.
 The behavior has also been made subject to a persistent Boolean option
-appendPV, configured to true, with a checkbox in General Options.
 A checkbox has also been added there for controlling the -variations option,
which is now also configured to true.

2013-02-18 10:25:40 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove checkbox for 'Move Sound'

This function is better controlled from the Sounds dialog.

2013-02-18 09:59:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make switching between board windows absolute

Selecting the window in which to draw the board when the slave board for
-dualBoard was up was done by a toggle. For unknown reason this could cause
a situation where the drawing took place in the other window than the
intended one. The code is made more robust by explicitly specifying which
window to draw in, based on the partnerUp flag.

2013-02-18 09:50:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Warn about experimental nature of dual board

The message field, which for now is unused, now contains a warning message.

2013-02-17 10:49:21 -0800 Arun Persaud <arun@nubati.net>:
add close buttons to gtk windows

use windows instead of dialogs for toplevel elements

2013-02-16 19:02:52 -0800 Arun Persaud <arun@nubati.net>:
keyboard accelerators for both front ends.

moved them out of the string definition, so that gtk can add them automatically.
Also wrote a function that loads them for X11.

TODO: add them again when creating X11 menu names

2013-02-15 11:03:02 -0800 Arun Persaud <arun@nubati.net>:
added rotated shogi pieces for -flipback option and moved them to the themes directory


2013-02-14 17:27:27 -0800 Arun Persaud <arun@nubati.net>:
add test for pkg-config

exit configure in case we can't find it.

2013-02-14 13:02:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Only perform e.p. capture if there are rights

The heuristic for e.p. capture was such that any non-forward move with
a Pawn to an empty square would delete the piece behind its new location
(Xiangqi exempted). This is now limited to cases where EP_STATUS indicates
that the deleted piece was a Pawn that performed a double-push on the
previous move. (Or if there is unknown EP_STATUS.)
 This makes XBoard more generally suitable for use with variants that have
non-conventional Pawn moves (with legality testing off). To guarantee this
will not have any unexpected effects in normal Chess, this patch will only
be active if legality testing is off.

2013-02-11 16:25:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Unreserve tourney game on exit during engine load

While waiting for the feature timeout we are not yet in TwoMachines mode,
so quitting XBoard at that stage would not unreserve the upcoming game.
A global flag 'startingEngine' similar to 'waitingForGame' now signals
this condition.

2013-02-10 13:40:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Better fix of feature timeout

The previous fix of the 2nd engine's done=1 aborting the 1st engine's
feature timeout by starting the game caused problems with v1 engines,
or other engines that would never send done=1. It is now fixed by
explicitly testing for a pending feature timeout after resurrecting
the 1st engine, rather than having TwoMachinesEventIfReady wait for
initDone to be set by reception of done=1.
 Also refrain from freezing the UI between match games, as in TwoMachines
mode the UI is mostly disabled anyway.

2013-02-08 16:24:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Connect Ctrl key in WinBoard

The Control key is now checked during move entry, for excluding moves
during analysis, or for copying pieces when editing a positions. But the
WB front-end did not read it out yet!

2013-02-08 16:23:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Makefile for install of Xiangqi pieces


2013-02-08 15:35:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add Xiangqi piece images to project

Let the images install in themes/xiangqi.

2013-02-08 15:14:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Revive -flipBlack option

The -flipBlack option in the cairo version is now implemented the same
way as it was in XBoard, swapping white and black pieces in filpView mode.
This requires a set black piece images that are the upside-down versions
of the white ones.

2013-02-07 13:55:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove empty-square SVG images from project


2013-02-06 19:00:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add desktop stuff for .xop MIME type.

Icons and desktop file were missing, as was the automake code to package them.

2013-02-06 16:48:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update NEWS file


2013-02-06 14:48:27 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add boolean -autoBox option

This option controls the automatic popup of the ICS Input Box on typing
a printable character, which was annoing to some. The option can be
set from the ICS Options dialog.

2013-02-06 10:56:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Draw both coords in a1

The lower-left board square needed two inscriptions, but DrawOneSquare()
only allowed one, so that the file ID would not be written. Now two strings
can be passed, and when align > 1 to indicate the alignment of the top
string, it is still checked if a bottom string is present as well, which
then is drawn with alignment 1 (= bottom right).
 The rank coord or piece count can now also be double digit.

2013-02-05 23:03:42 -0800 Arun Persaud <arun@nubati.net>:
updated po files for new release (make distcheck)

2013-02-05 23:02:07 -0800 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.

2013-02-05 22:52:42 -0800 Arun Persaud <arun@nubati.net>:
new version number for release of 4.7.0

2013-02-05 11:56:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let initial setting of Twice checkbox reflect current state

The Twice checkbox in the Tournament dialog of WinBoard was by default
starting unticked. It is more convenient to have it preserve the current
state, however, based on the -lpi or -lgi value. Like the auto-incremet
checkbox already did.

2013-02-04 22:07:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put GTK warning in about-box


2013-02-04 21:59:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix warnings of build server


2013-02-02 15:58:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix GTK error auto-raising board

The variable mainwindow is not set in the gtk2 version. Unfortunately
it is still used to determine default board size...

2013-02-01 19:42:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update Dutch WB translation


2013-02-01 19:37:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add some new strings to WB translation template


2013-02-01 19:34:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Assign shortcut char to WB menu item

The new Save games as Book item did not have a shortcut yet.

2013-02-01 19:31:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let WinBoard start in its installation folder

The current directory in WinBoard was not automatically the same as the
installDir returned by SearchPath. Especially not if used without shortcut
by file association.

2013-02-01 19:29:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix warning in WinBoard


2013-01-30 14:25:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix expose of to-square with grid off

The code relied on drawHighlight to request an expose evet for the entire
square, but when lineGap = 0, drawHighlight is a no-op.

2013-01-29 08:39:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix library order

On OS X dialog windows could not get focus if -lXaw appeared after
-lX11 -lXt in the linker command. This was cured by moving
@FRONTEND_FLAGS@ (which expands to -lXaw) first in the LDADD parameter
of the automake file.

2013-01-28 17:38:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Preserve PGN tags when loading engine

Switching to EditGame mode would normally erase the tags, but when analyzing
a loaded game this would be undesirable. When the engine is playing, keeping
the tags is dubious, but it is not obvious what to put in a new name tag,
so we leave that for now.

2013-01-28 17:23:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Preserve mode on engine loading (sometimes)

That the mode always switched to EditGame after engine loading was
particularly annoying at the start of a game (where leaving BeginningOfGame
mode would disablethe Time Control dialog, and the engine would not
automatically reply if you start playing) and AnalyzeMode. These two
modes are now preserved, BeginningOfGame by refraining from calling
EditGameEvent() and sending 'force' to the new engine, and AnalyzeMode
be calling AnalyzeModeEvent() after the engine is loaded and repositioned.

2013-01-28 14:14:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Catch unknown engine in tourney games

When an XBoard instance is playing on a tourney it can happen that it is
using a settings file with an engine list not yet containing a certain
participant, because that participant was just installed in the instance
that created the tourney file, but it did not save those modifications yet.
This error is now caught, and leads to an error popup and stopping of the
tourney play. This error was made non-fatal to allow the user to decide
if he wants to quit with or without saving the settings (which, after all,
does not seem up-to-date).

2013-01-26 18:08:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Adjudicate pawn-drop mate as loss in Shogi

Mating with a Pawn drop is illegal in Shogi, but rather than burdoning
the legality-testing by this complex rule, we simply invert the result
for such a mate. After all, Shogi customs are such that everything illegal
leads to an immediate loss.

2013-01-25 10:05:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Adjudicate perpetual checks as loss also in Shogi

The Xiangqi code for recognizing perpetual checks is now also activated for
Shogi, but in this case we bail out before checking for perpetual chases.
The mini-Shogi case is then recognized as a win for gote.

2013-01-25 09:55:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Stalemate is a win in Shogi

In regular Shogi this never occurs, but in the mini variants it happens
often enough.

2013-01-22 20:49:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix engine timeout problem in match mode

Reload of a reuse=0 engine would cause a done=1 event which would be
abort the feature timeout of the other engine in the first game.

2013-01-22 20:32:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Enforce -popupMoveErrors

One move error was using DisplayError(), in stead of DisplayMoveError(),
and thus did not obey the -popupMoveErrors option.

2013-01-21 15:30:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file


2013-01-21 10:26:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some warnings


2013-01-20 19:09:05 -0800 Arun Persaud <arun@nubati.net>:
Updated German translation


2013-01-19 17:54:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Do delayed board draw also with -stickyWindows false

Only CoDrag needs to be suppressed on a configure event with
-stickyWindows false, not the board redraw.

2013-01-18 11:11:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let tellothers command add comment to PGN in local mode


2012-12-30 15:19:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow use of ~ in pieceToChar for shadow pieces in any variant

The use of shadow-pieces for promoted Pawns was limited to Crazyhouse and
Bughouse. But this is not necessary, and in fact undesirable, as it made
it impossible to implement Crazyhouse960, which combines shadow promotions
with Fischer castling (only available in variant fischerandom)s, and thus
has to be played as 8x8+5_fischerandom, using the Crazyhouse -pieceToChaTable.

2012-12-30 15:06:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Resend engine-defined options after reuse=0 reload

When the engine process is re-spawned for a new game under -xreuse setting,
any alteration of engine settings brought about through the Engine Settings
dialogs would be lost, and revert to the engine's default. This is now fixed
by re-sending all options (known from the previous load of the same engine)
with the current settings immediately after "protover 2", and ignoring the
engine's option features. Rather than clearing the option list, and
redefining it from the option features.

2012-12-30 14:58:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement aborting of games on engine request.

A new game-end command is added. For bakward compatibility it is disguised
as an old one, namely "1/2-1/2 {Engine Abort Request}". These resultDetails
are recognized as special, and rather than ending the game in a draw (which
GUIs not implementing this), the game will be completely 'expunged' from
the match or tourney it is part of, leaving no trace in the saveGameFile.

2012-12-30 14:54:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Store some more tourney params in tourney file

The hash and threads settings, as well as ponder and book options are now
also saved in the tourney file, so that tournaments can be played in
parallel where these parameters differ, and no mess up can occur on
restarting a touney after doing something else.

2012-12-23 11:26:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Do not automatically save aborted games in tourney PGN

When the game result is 'unfinished', we prompt for a filename rather
then using the specified saveGameFile if a tourney is in progress.

2013-01-19 08:35:52 -0800 Arun Persaud <arun@nubati.net>:
fix configure bug that showed up on OS X (couldn't find X11/Dialog.h)

X_CFLAGS (set by AC_PATH_XTRA) was not used in Makefile.am. It was used in tests for X11/Dialog.h, etc. so configure worked, but make didn't.

2013-01-18 22:26:13 -0800 Arun Persaud <arun@nubati.net>:
Updated Ukrainian translations


2013-01-09 07:57:43 -0800 Arun Persaud <arun@nubati.net>:
removed trailing whitespace


2013-01-09 07:49:20 -0800 Arun Persaud <arun@nubati.net>:
Updated copyright notice to 2013


2012-12-22 22:46:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Do not move to forwadMostMove when unpausing AnalyzeMode


2012-12-22 22:44:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use Ctrl key in AnalyzeMode to exclude entered move


2012-12-22 20:40:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement insufficient mating material for Knightmate

KBK is draw with Royal Knight. With exo-pieces also KNK and KFK.

2012-12-22 20:25:51 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix rep-draw detection in drop games

In games like Crazyhouse every move is reversible, as captured pieces
can eventually change sides again, and be dropped back on the board.
So we have to search back a full 100 ply for repetitions, passing captures
and Pawn moves.

2012-12-11 22:33:07 -0800 Arun Persaud <arun@nubati.net>:
updated po/pot files


2012-12-11 22:18:05 -0800 Arun Persaud <arun@nubati.net>:
new version number for developer release


2012-12-10 14:48:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Prefer pause mode on pondering engine over 'easy'

If the thinking engine is stopped after its move because it does not
support pause, is is still better to use pause on the pondering engine
than to switch of its pondering with 'easy', as the latter might not
be instantaneous. Also switch off pondering in the thinking engine before
it gives the move, just in case it does not respond immediately to
easy / hard.

2012-12-10 13:40:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update WinBoard translation template


2012-12-10 13:35:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix min-Shogi promotion zone

In integer arithmetic N*2/3 is not the same as N - N/3, with as a result
that the white promotion zone was 2 ranks deep on 5x5 boards. This only
happened in LegalityTest, but because this would classify all moves to
4th rank an non-promotions, they would be printed with a faulty
deferral (=) sign as promochar in SAN.

2012-12-10 13:32:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Do not clear PGN tags on Analyze File


2012-12-10 13:28:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix -fSAN in AnalyzeFile mode

The exception that a PV relates to currentMove rather than forwardMostMove
applies not oly in AnalyzeMode, but also in AnalyzeFile. Furthermore,
PvToSan did not properly restore the pushed game tail in this case.

2012-12-08 16:02:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Improve scaling of border bitmap (WB)

The StretchBlt mode is set from dither to delete.

2012-12-05 16:34:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement use of pause / resume protocol commands

Engines that implement feature pause=1 will be paused during their move
on a pause event; pondering engines will be controlled either through
'pause' or (if they don't support that) 'easy', which both should work
instantaneously. If the thinking engine does not support 'pause', the pausing
will be deferred to when it produces its move, and is implemented by not
relaying the move, and switch off pondering for both.

2012-12-03 12:58:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Loop-Chess promotions

Loop Chess is not a supported variant, but hould be playable as Crazyhouse
with an altered pieceToCharTable, not defining the shadow promotion pieces.
But with legality testing on promotion to shadow piece would take place
even if the shadow piece was not defined.

2012-12-02 22:44:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix move highlighting with animation off

In WB the moving of SetHighlights to after the animation had broken the
highlighting of engine moves, because it was also moved after DrawPosition.
While it is DrawPosition that actually draws the highlights. Now it has been
moved to just before DrawPosition.

2012-12-02 11:09:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Start browsing in currently-selected folder (WB)

The folder-browse dialog always started at My Computer, while file browsing
started in the globally last-used folder (which might not be related at all
to the file entry we are now browsing for).

2012-11-29 23:38:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement book-creation functions

A new menu item triggers conversion of the currently loaded PGN file
to a Polyglot book, saved with the GUI-book filename. A (volatile) option
-mcBookMode alters the probing algorithm to build a book from scratch by
playing games (and using a form of learning).

2012-11-29 22:23:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use colors in Board-Options dialog also for font pieces (WB)

The piece color settings now control the pieceColor or fontPieceColor
settings, depending on the setting of -usePieceFont.

2012-11-29 22:14:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement auto-creation of ICS logon file

Under control of the new option -autoCreateLogon (which can be set from
the ICS Options dialog) the first two lines in response to the ICS "login:"
pompt will be saved on a newly created logon file (if logon from such
an existing file failed).

2012-11-29 21:56:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add Themes dialog (WB)

This dialog, done by the generic popup, contains controls for many settings
that so far could only be controlled by options. It also introduces the
concept of 'themes', sets of options stored in the multi-line option
-themeNames.
  Add some dummy routines to suppress compile errors in functions that
cannot be called yet in XBoard.

2012-11-29 21:32:03 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow external piece bitmaps and board border (WB)

The -pieceImageDirectory is now also used for WinBoard, to indicate
a directory of .bmp files, used to replace the built-ins. The outline
and solid bitmaps can be full-color. This allows winBoard to use the
WinBoard-zeta graphics. A new option -border can indicate a bitmap file
used to draw a half-square-wide border around the board.
  A white background has to be drawn underneath the black pieces, to avoid
color-interference with the board, just like happens for the white pieces.
These backgrounds now always use bright white, rather than -withePieceColor.

We still have to work on the scaling of the zeta (600x600) bitmaps to
the actual board size, as for some bitmaps the stratchblt is ugly.

2012-11-29 21:05:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add 'Continue Later' button in Tournament dialog (WB)

This button makes it possible to accept the values specified in the
dialog without immediately starting the tournament (as OK does),
so you can re-open the dialog later, and OK it then.

2012-11-29 20:25:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Load opponent logo based on handle in ICS play (WB)

The logos for handles on FICS are sought in folder logos\freeches.org\*.bmp,
etc. If no logo for the handle is found there, the logo of the ICS is
displayed as usual.

2012-11-19 20:35:05 -0800 Daniel Dugovic <dandydand@gmail.com>:
Fix configure script for --enable-zippy  (tiny change)

reported and patch by Daniel.

edited by Arun Persaud:
- also fixed #ifndef ZIPPY -> #if !ZIPPY
- didn't change #if -> #ifdef

2012-11-10 00:12:34 -0800 Arun Persaud <arun@nubati.net>:
don't define X_LIBS when using gtk-frontend


2012-11-07 22:16:09 -0800 Arun Persaud <arun@nubati.net>:
updated po/pot files; added new frontend files


2012-11-07 22:14:20 -0800 Arun Persaud <arun@nubati.net>:
fix configure script for --with-Xaw and --with-gtk

made Xaw the default and included xaw or gtk sources as extras
in case the other frontend is selected for make distcheck

2012-11-07 21:13:38 -0800 Arun Persaud <arun@nubati.net>:
new version number for developer release


2012-10-31 09:55:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Draw frames around memos and listboxes


2012-10-30 17:39:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt lineGap during sizing


2012-10-30 15:04:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix clock highlighting


2012-10-30 10:59:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Chat Box

The genric TypeInProc is re-instated, and replaces ICSKeyEvent as primary
handler for special keys in one-liner text edits.

2012-10-29 19:46:27 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Pay attention to NO_CANCEL dialog flag


2012-10-29 14:18:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix clock clicking with GtkEventBox

Like in WinBoard the button-3 case is now handled in the primary
event handler (and communicated to it in a kludgy way). It would be
better if this was absorbed in ClockClick().

2012-10-28 22:25:22 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix logo placement

Graphs were not recognized as possible SAME_ROW elements. A Graph requesting
FIXED_H (which only the logos did) is now packed into a (borderless) aspect
frame.

2012-10-25 23:04:42 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add window positioning

Sticky windows now sort of works, but needs unexplained fudge factors.
Reopening a persistent dialog centers it on the board, and disobeys
the positioning command. The WindowPlacement of the BoardWindow was
again added (it was commented out during development).

2012-10-22 22:41:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make board sizing work through subtracting fixed height

There is now no attempt to give a size to the board drawing area, so it
can later be sized as small as we want. The frame width is determined
by subtracting the nominal board size from the actual window size,
(because the clocks will have that width, and the board will startas 1x1),
while the vertical margin is determined as the difference between the
bactual window height, the drawing-area height minus a fudge of 25 pixels
to compesate for the erroneously allocated blank space below the board.

2012-10-22 21:09:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix warnings

The highTextStart/End are now declared in engineoutput.h, shared between
nengineoutput.c and xengineoutput.c. Unused variables were removed.
Also fix warnings in xboard.c and xoptions.c.

2012-10-22 17:40:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Delete emptied front-end files, and move rest to gtk directory

Remove #ifdeffed-out Xt code that has GTK implementation. The xgamelist
and xhistory have been completely cleared off content, and were removed.

2012-10-27 00:12:42 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add copy-paste

The code from gtk-xt could be used with almost no modification.

2012-10-21 09:09:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Some experimenting with sizing

Does not work as intended yet.

2012-10-21 23:04:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add task-bar icon

Funny enough it was necessary to swap the two svg icons to make this work!

2012-10-20 10:29:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make some tall dialogs multi-column

A dummy button was added to the last row of New Variant to make the
number even. A legality-test warning as put in the New Variant dialog
Fix width of tourney-file in Match dialog

2012-10-20 21:14:33 -0700 Arun Persaud <arun@nubati.net>:
updated some icons to SVG


2012-10-20 19:57:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add displaying of icons

A new Option type, 'Icon', was added for this as in GTK Icons and Labels
need different types of widget. The icons are now svg, so we could
remove the icon pixmaps.

2012-10-20 14:25:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix button bar


2012-10-20 14:03:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add BarBegin, BarEnd options

This makes the button bar display correctly. Also fix v-sizing of menu bar.

2012-10-20 10:01:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add listbox double-click callback

This function was formerly performed by WheelProc.

2012-10-19 17:29:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add hiding / showing second Engine Output pane

The handle of the GTK table for the second engine is stored in the
EndMark handle by GenericPopUp, so it can be used later to hise/show
that table.

2012-10-19 17:15:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Use different tables for different dialog columns

Making the same table wider (in steps of 3) to get multiple columns
does not work, because it forces options to align vertically. This
wrecks dialogs like Load Engine, where one column contains a very
high option (listbox). Now differnt tables are created for each column,
packed in a new itermediate hbox. In case of the Engine Output window,
a vbox is used instead to cause vertical stacking.
  Only multi-line text-edits and listboxes are now allowed to take up
vertical space changes, while only the middle colum of the table
can take up horizontal size changes. Within packing boxes space is
equally distributed.
  The labels above the particiant-selection widgets had not the same width
as the textview / listbox, leading to misplacement of the second label.
  For Engine Settings the spontaneous breaking into columns did not
involve a SAME_ROW flag, so the 'columns' were stacked vertically.
In addition the columns were too tall for GTK. They are now 20 options max.

2012-10-19 13:46:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Deselect first char in Move Type-in and ICS Input Box

After popup the Move Type-In had the typed character in it, but it was
selected, so that typing a second character would erase it again.
Same for the ICS Input Box. A prototype for CursorAtEnd is now also added.

2012-10-19 13:33:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Close Move Type-in on Enter

The code is squeezed into the ICSKeyEvent callback.

2012-10-18 21:57:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add access routines to checkboxes and FocusOnWidget

The <Enter> handler of the filter field needs it to return focus to
the listbox.

2012-10-18 21:42:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add game-list callbacks

The callbacks for listbox and filter text are treated by the same callback,
which does both key presses and button double-clicks.
Giving focus back to the listbox after filtering does not yet work!

2012-10-18 16:27:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add optional callback to Label Options

For some reason this does not work. The callback isn't called!

2012-10-18 13:40:55 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add type-in event to board for popping up box


2012-10-18 13:12:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add Shift detection

The state of Shift and Ctrl was only probed on button clicks, so it
is now read out of the button-event struct in the relevant button handlers.
For backwad compatibility, they store it in a global, so the routine
ShiftKeys can take them from there.

2012-10-18 12:35:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove some unneeded low-level X11 code

Things like tabbing between controls, mouse-wheel scolling etc. are all
automatic in GTK, and thuse don't need to be ported.

2012-10-18 10:12:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add file browser

The gtk-xt code for browsing in response to menu items rather than dialog
browse buttons) was grafted. It seems desirable to merge the two browsing
functions, though. Pass extra params used by Xaw to FileNamePopUpGTK.
The code was altered to use DelayedLoad.

2012-10-18 09:54:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ListBox, and add some support routines

The srolled-window for the listbox used a uninitialized variable for its
width, causing a crash. Now it pays attention to the Option.max and .value
size hints. The access routines were copied from gtk-xt. HighlightWithScroll
could just a wrapper for HighlightListBoxItem, as GTK auto-scrolls.

2012-10-17 20:01:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Connect CommentClick handler

This can make use of generic memo callback, so it could be entirely
backend. Therefore it was moved to dialogs.h. As it shared a global with
some other back-end popup routines to remember the current move, these
could now be moved out of xboard.c too. (Well, not so for the X11 front-end,
so it has now been put in a header. :-( )

2012-10-17 19:41:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix animation

Because FrameDelay does block the event loop, even though it releaes the
CPU, expose events start to lag behind the actual drawing. By combining
expose events for overlapping squares, rather than decompose them into
3 rectangles, this problem seems to go away. But only if there is an
extra exposure on the squares to be drawn also non-overlapping frames
will be properly drawn (?!).

2012-10-17 14:40:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement highlighting in engine output by through generic method

HighlightMove was made generally available for all text. It is now just a
wrapper for the generic HighlightText, and could be moved to the back-end.
(This requires the initialization to be widget specific, and the flag
indicating it has been done is now stored in the Option.min field.)

2012-10-17 14:33:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let engine-output memos use new generic callback


2012-10-17 13:53:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add scrolling of Move History

To have access to the textview, its handle is now stored in the
Option.textValue field.

2012-10-17 13:11:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add highlighting in move list

For now it is assumed the normal background will be white (for clearing
the highlight).

2012-10-16 19:44:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make generic memo-event handler, and connect history callback

Large text widgets can now define a user handler in their Option.choice
field. If they do, agneric callback is added tothem, which catches mouse
events. Button release and pointer motion pass their coordinate and type
to the specified user routine. Button presses in addition retrieve
the text from the widget, set the cursor in it to the clicked point,
and convert it to a character position, also passed to the user.
  The user is responsible for ignoring events he is not interested in.

2012-10-16 15:58:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add key-handler for ICS Input Box

In contrast to the X11 code, all intercepted keys are now treated by
the same callback. The ICS Input Box callback triggers on Up, Down and
Return key, and refers to these symbolically.

2012-10-16 15:05:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Highlight Pause button


2012-10-16 13:52:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Better cleansing of xboard.c from X11 types

The #includes for X11 files were still in there.

2012-10-16 13:28:32 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add text insertion in engine-output memos


2012-10-16 09:34:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Append recent engines to engine menu

This is now entirely moved to the back-end, by doing it in the table
from which the menus are later generated. The special callback for engine
items is abandoned, and the euProc for such items is left NULL to flag
that RecentEngineEvent should be invoked with the applicable engine number.
To calculate the latter a global variable firstEngineItem is dynamically
set to the length of the regular engine menu.

2012-10-15 22:17:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Transfer more gtk-xt code, and add some new

Add input-source handling
Graft color picker (<Enter> callbeack in the text field is still missing!)
Handle contents of label widgets (store handles in Option for access)
Add printing of clocks
Add printing of window title
Pay attention to BORDER attribute of Label Options (pack in frame)
Delete ReadBitmap code (also remove #including of bitmap files for icons)
Fix layout of textviews (adapt to newer Option format, incl. wrap, scroll)
Support vertical stacking in Break Option (no table widening when !SAME_ROW)
Make default horizontal scroll policy automatic (for engine-output window)
Fix disabling of unused spinners in TC dialog

2012-10-15 20:47:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Connect dialog Browse buttons to GTK browser


2012-10-15 19:52:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement menu checkmarking and enabling

odes in the (later over-written) handle field specify which items
are to be checkmarked, and by what style button.

2012-10-15 16:18:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Attach expose handler and connect to mouse events

The GraphExposeProc is conected to the Graph widgets. A gdk draw routine
is used to copy the buffer bitmap to the display. It is also connected
to button and motion-notify events.
  In this version the board can be fully operated with the mouse.

2012-10-14 22:00:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Transfer most available gtk-xt code to xoptions.c

GenericPopUp and PopDown are grafted from gtk-xt into gtk2.
The version compiles, but segfaults before doing anything, with error
messages about unexpected cases in GenericPopup for Graph and PopUp Options
of the main board. The spin options need special treatment in GetWidgtText.

2012-10-15 11:41:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Give LoadListBox two extra parameters

It often occurs that we just want to swap two elements, and reloading
the entire listbox would be a very inefficient way to do this in widget
sets that allow access to a single element.

2012-10-14 20:36:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove all X11 code by #ifdeffing it out

With #ifdef TODO_GTK we disable all X11 code, in order to get a compiling
X11-free version. The disabled sections can then be replaced by code
for another widget set, the X11 version still showing what it was supposed
to do.

2012-10-14 17:37:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move timer functions to new file xtimer.c

The timers for the clocks, periodic analysis events and ScheduleDelayedEvent
go into a separate file.

2012-10-14 15:31:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make xevalgraph.c backend

The only front-end stuff left in xevalgraph.c was an unnecessary reading
of the window size (which could be obtained from the WindowPlaceent struct),
and drawing (all cairo now). The drawing was moved to draw.c, and the
remaining part renamed nevalgraph.c.

An attempt to list them in a less chaotic way.

2012-10-14 14:34:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Cleanse back-end code of all references to X11 types

When compiling for X11, common.h #included X11/Intrinsics.h so that
X11-specific data types could still be used throughout the back-end part
not shared with WinBoard. By temporarily disabling this, error messages
could be generated on all such occurrences, and were then solved. This
included the following:
  The InputSource struct is not uses in usystem.c at all, and its definition
could be moved to xboard.c. InputSourceRef, which logically should heve been
defined as (InputSource *), is in reality (void *), so the back-end can
pass it around.
  Some non-platform-dependent stuff of general interest had prototypes
(or external vars) in xboard.h. This is now moved to a new header xboard2.h,
to allow it to be shared without bringing in X11 dependence.
  The EngineOutputProc was defined inconsistently, but the header was not
sufficiently shared to flag this error. This has been repaired now, by moving
the template to menus.h.

2012-10-14 13:39:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove xedittags.c, .h from project

The tiny bit of code that was left was absorbed in dialogs.c, the one
prototype to menus.h.

2012-10-14 12:53:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove inclusion of frontend.h from backendz.h

This did not seem to serve any purpose at all.

2012-10-14 12:49:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Split xhistory.c in front-end and middle-end part


2012-10-14 12:21:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move MarkMenuItem to xoptions.c

This to make xoptions.c completely independent from the inclusion of
frontend.h. The prototype is moved to menus.h.
  Loose end: DrawPosition in board.c does not see the prototype.
Very suspect that it wants to see it. Why would it have to correct the
flipView setting??? Better se to it that it is correct to start with!

2012-10-14 12:14:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
move testing for no options to back-end

The test if an engine has options and display a note instead of
the Engine Settings dialog when this is not the case is moved
to outside of GenericPopUp, to make the later independent of calling
other routines.

2012-10-14 11:20:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove some unnecessary header includes


2012-10-14 10:47:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move ICS-engine analyze and AnalyzeGame code to shared back-end

This code was still duplicated between WB and XB in the front-ends.
Because of its incorporation in AnalyzeModeEvent the 'middle-end'
function AnalyzeModeProc could be eliminated. AnalyzeModeEvent was made
to return an int to flag its success, and keep the JAWS code based
on it out of XBoard.
 The AnalyzeGame code  is now incorporated in AnalyzeFileEvent().

2012-10-26 10:28:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add configure switches for Xaw vs GTK.

This patch is an adapted version of the one Arun made at the end of the
gtk2 branch. It uses the exact same version of his configure.ac, but the
Makefile.am is adapted to the situation in master at the beginning of it,
after duplication of the X11 front-end files in the xaw directory for
preserving them, while the versions that will be modified to GTK front-end
are still in the xboard directory.

2012-10-25 11:12:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Prepare xoptions.c for middle-end changes

Some changes that can be pre-empted, such as the splitting of Label
into Label and Icon Option type, and some dummy wrappers are already
implemented, so they can be used when needed by GTK.

2012-10-25 09:20:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Preserve copies of the X11 front-end in xboard directory

The X11 front-end has been moved to the xaw directory, but copies
are retained for modifying them to gtk versions.

2012-10-24 08:55:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move X11 front-end to directory xaw


2012-10-31 18:18:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix initial enables in TC dialog


2012-10-30 14:47:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix image extension used for browsing to .pgn


2012-10-28 21:39:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WinBoard compile error on enum PEN


2012-10-30 11:20:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash in promotion popup

There were not enough entries for Capablanca Chess with legality-testing off,
where King is also presented as a choice.

2012-10-28 18:19:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix message in New Variant dialog

Even in -ncp mode the message was referring to the 'current engine'.

2012-10-28 18:16:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on animation after resizing

The animate buffers were still holding pointers to a discarded cairo surface.

2012-10-21 14:49:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix variant-dependent pieces

The code to select the actually used piece images from the available ones
(from InitDrawingSizes) is now made into a subroutine, and also called
after resizing the pieces.

2012-10-26 10:18:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Replace marble texture pixmaps by png


2012-10-26 10:13:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Replace xiangqi board pixmaps by png images


2012-10-26 10:08:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove the texture pixmaps from project

These were already replaced by png textures.

2012-10-23 15:02:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix re-rendering of svg on resize

The previously prepared bitmaps were retained if we resized, rather then
rendering the svg atthe new size.

2012-10-21 15:48:30 -0700 Arun Persaud <arun@nubati.net>:
update po/pot files


2012-10-21 15:47:12 -0700 Arun Persaud <arun@nubati.net>:
new version number for developer release


2012-10-21 11:10:36 -0700 Arun Persaud <arun@nubati.net>:
we still need a few bitmaps, so the directory needs to be included in Makefile.am

make distcheck complained about this

2012-10-21 15:56:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Rename svg shogi pieces, so they become usable

Only white pieces are present. For black they would have to be flipped.

2012-10-21 15:54:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in resizing on variant switch

The fix of the garbage pixels had unfortunately broken this.

2012-10-21 15:15:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in fallback mechanism

After failure to load a piece from a specified -pieceImageDirectory
the default theme was not tried, because the cairo function to load
from a pgn file returns a valid handle even if the file does not exist.

2012-10-21 14:58:42 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Get svg error message


2012-10-21 14:49:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix variant-dependent pieces

The code to select the actually used piece images from the available ones
(from InitDrawingSizes) is now made into a subroutine, and also called
after resizing the pieces.

2012-10-16 12:08:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove caveat on available pieces fromNew Variant dialog

In the cairo version all pieces are available at all board sizes.

2012-10-21 11:41:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove some unused images from png directory

Currently only the three board texture files are used. But the piece
images are still left, because they might be useful if we ever want
to mae XBoard configurable for not using librsvg.

2012-10-21 10:40:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in resizing

The nominal size of the window was not set in the correct Option struct.

2012-10-21 09:58:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Prevent odd-width line shift in length direction


2012-10-21 09:48:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Print missing-pieces error message to console

The GUI might not yet be up at this point.In addition, suppress
the rest of the code, because it could give segfaults.

2012-10-21 09:30:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix garbage pixels on the right of the board

The extra pixel that is requested in sizing the board window back to
an available size because we ofte get one less pixel than we ask for
can lead to a line of garbage pixels next to the board. This is combatted
by limiting expose events to the true board area, remembering that in the
Graph Option rather than the actual window size, and suppressing resizing
when the latter only exceeds the stored width by more than 1 pixel.

2012-10-15 10:27:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Trim board-window size

The board window will sometimes be a pixel larger than requested.
The ReSize routine will now reset the size values in the Graph Option
to what they were supposed to be, to prevent expose events will
draw nonsense in the extra space.

2012-10-13 23:26:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt docs for svg/png in stead of bitmap/pixmap


2012-10-13 09:35:31 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Spontaeous changes in gettext stuff


2012-10-13 08:03:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move Shogi svg pieces to own directory


2012-10-13 07:57:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove unnecessary Xt colors and call to MakeColors


2012-10-13 07:50:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Code cleanup: move expose redraw to draw.c


2012-10-13 07:37:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress warning for InitDrawingHandle


2012-10-13 07:33:15 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make fallbackPieceImageDirectory hardcoded


2012-10-13 07:18:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Increase drag delay too 200 msec

On my slow laptop it can take more than 100 msec to reallocate bitmaps
in the generic expose, with as a consequence that the DelayedDrag event
is not processed before the timeout expires. The timeout event then triggers
a redraw, which again takes so long that the timeout expires before the
event to reset the timer could be processed, and this just perpetuates
itself, leading to a large series of queued redraws, and a long waiting time
for an image to appear after the sizing stops.

2012-10-13 07:01:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix segfault on faulty command-line option


2012-10-12 14:42:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress anti-aliasing in -monoMode

In the color-substitution code, always use bi-level alpha and color.

2012-10-12 13:34:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove piece pixmaps from project


2012-10-12 11:47:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement proper fallback cascade

Try in order cached svg, cached bitmap, user png, user svg, default svg.

2012-10-12 11:06:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Cache svg handles


2012-10-12 10:45:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Install svg pieces in themes/default

The svg pieces are installed with the XBoard data in the directory
.../xboard/themes/default . A new option -fallbackPieceImageDirectory
is added, and is configured in the master settings file to point to
these pieces. This options, which replaces -svgDirectory, is volatile,
and the menu control to set it is removed. The -pngDirectory option
is renamed to -pieceImageDirectory (-pid).

2012-10-12 10:02:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove bitmaps from project


2012-10-12 09:55:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Install the wood textures as png

The xboard.conf has to be edited to set these as default textures,
in stead of the .xpm files.

2012-10-12 09:50:31 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add hatched board texture

A png file with hatching is added, so it can be used for dark squares
in a monochrome theme. It is installed in a new data directory
.../xboard/themes/textures.

2012-10-11 22:21:06 -0700 Arun Persaud <arun@nubati.net>:
added a black and white theme to replace the mono option


2012-10-11 20:56:42 -0700 Arun Persaud <arun@nubati.net>:
added SVGs to dist files in automake


2012-10-11 19:44:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix exposure of atomic captures

The grid lines had to be repaired too, so damage marker 2 had to be used.

2012-10-11 19:13:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix animation with textures off

The blank square was not shifted to (0,0) when drawing the animation buffer.

2012-10-11 19:08:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix 1-pixel offset of grid lines on some cairo implementations


2012-10-11 09:51:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Solve odd lineGap problem

Not all cairo versions seem to round the same when an odd-width line
is to be drawn at integer coordinates. So now we explicitly ask it
to be drawn centered on half-odd-integer coordinates.

2012-10-09 18:52:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -trueColors option


2012-10-09 14:56:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Always render svg pieces anew on size change

The svg pieces are now unconditionally rendered to supply the pngPieceImage
master source otherwise read from png file. This is then fed into the
original png code (so that if for some reason it fails, we fall back on png
pieces, and finally on built-in pixmaps).

2012-10-09 14:06:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix rsvg version in configure.ac


2012-10-08 19:54:19 -0700 Arun Persaud <arun@nubati.net>:
initial svg rendering


2012-10-08 18:34:05 -0700 Arun Persaud <arun@nubati.net>:
added cairo and librsvg to configure process


2012-10-08 18:32:55 -0700 Arun Persaud <arun@nubati.net>:
added SVGs

converted from inkscape SVG to plain SVG before adding

2012-10-10 21:19:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt Eval Graph code to new drawing system

The eval graph now triggers an expose after drawing, and gets its size
from the Option fields.

2012-10-10 20:37:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix expose requests seek graph


2012-10-10 20:07:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make draw handle for board globally available


2012-10-10 19:45:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let expose requests pay proper attenton to widget

So far, expose requests were always assumed to be for the board widget,
preventing display of the labels.

2012-10-10 18:45:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix initial display of logos

The logos were selected and printed during the initialization,
before the main event loop was started. So the expose events during
widget creation, which created the drawing surfaces, were only processed
after the initial drawing of logos, so that there was nothing to draw on!

2012-10-10 17:25:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix alignment of highlight expose


2012-10-10 17:19:52 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
remove NewSurfaces


2012-10-09 13:57:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make expose handler generic

The Graph Option now returns two handles in hitherto unused fields of its
Option struct: Option.choice is a cairo handle of a memory buffer the user
must draw to, while Option.textValue is the handle to the widget.
Expose events copy the memory buffer to the display for the exposed area.
A routine DrawExpose() is supplied to let the user generate expose events.

2012-10-06 21:30:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reload piece images when pngDirectory is changed

The OK function of the board options dialog now tests for a change
in pngDirectory and passes a parameter to InitDrawingParams to tell
it to destroy the old images. This cause a reload on scaling the pieces.

2012-10-06 20:16:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress redraw during sizing


2012-10-06 20:10:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in resize trigger

Even if the square size does not change, the window has to be shrunk
back to fit the board.

2012-10-06 19:54:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make Piececolor options work on png pieces

The scaled, antialiased bitmaps are now colored according to the option
settings. This is done by decomposing every pixel in a white, black and
transparency component, which is possible because the opacity is
directly give in the alpha channel, and black originally was a hard zero.
So what you se in the red channel must be white (as the original white
was #FFFFCC), and the rest of the opacity must be due to black.
  The color to be replaced (white for the white pieces, black for the black
pieces) is then replaced by the original weight of this color times the
color from the option.

2012-10-06 17:53:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Plug resource leak on rezising with pixmaps


2012-10-06 16:19:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fall back on built-in pixmaps if png pieces unreadable


2012-10-06 14:21:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Do coordinate text alignment with cairo


2012-10-06 13:40:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Some cleanup


2012-10-06 12:14:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Clean up drawing code

Now all routines only draw through cairo, the destination surface can
be passed to them, making it possible to do the duplicate drawing
to the memory board image in a cleaner way.

2012-10-06 11:37:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Check in draw.c, draw.h


2012-10-06 11:26:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove all bitmap & pixmap drawing

All Xt code for drawing the board is now removed, as are the
-pixmapDirectory and -bitmapdirectory option. This version is now
completely dependent on cairo for handling of all graphics anywhere.
(The build-in pixmaps are still left, though, for later use as an
alterative cairo source when no png files are found.)

2012-10-06 10:29:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Separate off drawing routines from xboard.c

A new source file draw.c is created to hold all code associated with
board drawing. The routines for loading bitmaps and creating colors
were left in xboard.c, though, as they are also used for handling
icons and colors of widgets.

2012-10-05 19:53:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix erasing dots in seek graph

The cairo dots were just a little bit bigger than the old ones, so they
were not properly erased, but left a remnant.

2012-10-05 19:25:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Cleanup CairoOverlayPiece


2012-10-05 19:22:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Draw arrow also on backup image


2012-10-05 19:16:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix highlight clearing


2012-10-05 18:59:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove acceleration trick


2012-10-05 18:54:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement variant-dependent png piece symbols


2012-10-05 18:42:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix clearing of markers dots with promo popup


2012-10-05 18:32:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Also render coordinates to backup board


2012-10-05 18:30:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove debug print


2012-10-05 18:29:13 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let cairo also do evenly colored squares.


2012-10-05 17:56:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make dragged piece for excluding moves transparent


2012-10-05 17:42:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix DrawSeekText


2012-10-05 17:40:55 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo coordinate / piece-count printing ith cairo


2012-10-05 15:40:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Also use cairo on slave board

With dual-board observing the drawing should be redirected to the
slave board, so SwitchWindow should also switch the xlib-surface to
one for the slave window.

2012-10-05 15:12:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Cure flashing of piece on from-square

In a drag-drop move the piece was flashed on the from square after the
user dropped it on the to-square, because highlights were set before the
move had updated the board. And highlighting with arrow can cause a redraw
of the last board. Same with setting or clearing marker dots.

2012-10-05 14:20:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Specify proper condition for using cairo animation


2012-10-05 14:07:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow resizing of board window

In full png mode the size of the board window is no longer locked.
After resizing, the square size is calculated as the largest one that
would fit the window, and the window is then shrunk around it. To prevent
excessive redrawing during sizing, the redraw is delayed by putting it
in DragProc.

2012-10-05 10:41:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Switch to using 64x64 png images

The bitmap scaling works better when the needed factors are not too large,
as the svg rendering's anti-aliasing did not blur more than 1 pixel.
So after shrinking too much the images are not effectively anti-aliased
anymore.

2012-10-05 10:16:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Maintain in-memory copy of the board image

As reading back from the xlib-surface proves incredibly slow (cairo probably
converts the entire image from Xt format to cairo format when we set it
as a source, even though we only want to read a few dozen pixels), we now
keep an exact copy of the board image as a cairo bitmap in memory. This
restores the speed of the animation, but unfortunately leads to awful code.

2012-10-04 22:15:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Do animation with cairo

Unfortunately this is incredibly slow.

2012-10-04 18:36:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow back-texture files to be PNG, (drawn with cairo)


2012-10-04 15:10:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add png pieces

A new directory with 256x256 png piece images is added to the source tree.

2012-10-04 15:01:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add mode to draw PNG piece images through cairo

The PNG images have to be supplied as files in a -pngDirectory (a new
option) with a 256x256 bitmap. They are then scaled by cairo to the
desired square size. This does not work very well for the smaller sizes.

2012-10-03 14:45:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo marker dots with cairo


2012-10-03 14:27:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo highlights with cairo


2012-10-03 14:07:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make convenience routine SetPen globally available

The routine to set a pen as specified by  a color string that was used
in xevalgraph is moved to xboard.c, where there also is lots of demand
for it. The arrow drawing now uses it for setting the highlightSquareColor.

2012-10-03 12:28:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo grid with cairo


2012-10-03 12:00:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo arrow highlighting with cairo


2012-10-03 11:20:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo seek graph with cairo

New front-end services DrawSeekOpen() and DrawSeekClose() have been
added, and are called from the back-end to enclose any drawing activity.
In WinBoard these had to be defined as dummies.

2012-10-02 15:31:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo logos with cairo

The logos must now be .png files, and are internally handled as their
filenames. (So no preparation of a drawable from it at startup.)
Cairo allows them to be scaled to the requested logoSize.

2012-10-02 14:02:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Eval Graph resolution problems

Anti-aliasing had to be switched off to get a crisp graph. A second problem
was that the dashed lines were drawn in both directions, with interfering
dashes.

2012-10-02 10:54:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo Eval Graph drawing with cairo


2012-10-21 10:21:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix button-border-width bug in monoMode

The kludge of signalling we are dealing wih a button rather than a label
was wrongly implemented in case of momoMode.

2012-10-21 10:14:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reserve more space for button bar

In some board sizes the button bar was wider than the code guessed,
so the window width would be determined by the message + buttons row rather
than the board.

2012-10-21 11:24:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WinBoard compile errors


2012-10-13 09:33:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix non-NLS compile error for XFontStruct


2012-10-12 12:04:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix browsing for path

A pathname was still prefixed with the cuurent directory.

2012-10-07 21:00:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Use Pause state in AnalyzeMode to imply move exclusion

The pause state was not used in AnalyzeMode so far. Now it is used to
imply all entered moves are for exclusion/inclusion.

2012-09-30 18:55:13 -0700 Arun Persaud <arun@nubati.net>:
new version number for developer release


2012-09-30 22:16:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix broken -ics and -cp options

The patch to specify engines and ICS by nickame broke the use of the
regular options to do this, because they could also reset them. Now
this is fixed by only setting them (through |= in stead of =).

2012-09-30 22:01:52 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file

The description of exclude-moves, multi-game ananalysis and duo-analysis
is added.

2012-09-30 10:07:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Resolve conflict between -mps and -inc options

The age-old problem that a persistent valid -inc value will cause -mps
to be ignored is solved by the kludge of storing these two as a single
option (-mps) in the settings file, and declaring the other (-inc) volatile.
The range of negative numbers (invalid as -mps value) was available for
that, and now is used to store the negated value of -inc in msec.
For backward compatibility, specification of -inc causes interpretation
of -mps in the old way. The forcing of -inc to -1 in the master settings file
could be safely removed because of this change, so that the time increment
now is a persistent option.

2012-09-29 23:13:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow entry of fractional increment in WB time-control dialog

The numeric edit is changed to a general text edit, and code is added
to convert the text it contains to and from float, with proper error check.

2012-09-29 23:05:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Preconfigure -icsNames in xboard.conf

Although XBoard has no startup dialog with an ICS combobox, the -icsNames
option is now used to select lines from with the -is option, and in
interpretation of positional arguments. The most common ICS are configured
together with a short nickname, so that commands like "xboard fics" will work.

2012-09-29 22:58:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow ICS nickname as positional argument

If an argument is encountered that is not preceded by an option name,
it is now first checked if it corresponds to the nickname of an ICS
in -icsNames. If so, it is assumed to be the value of an -is option,
selecting -ics mode with that ICS and all the options installed with it.

2012-09-28 20:28:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Cure some sick behavior in XBoard Engine Output right-clicks

When a PV-walk is in progress, the PV is highlighted by selecting it,
and this focuses the attention of the scroll bar on it, so it remains in
view. But after release, that line was kept in view, rather than scrolling
back to the top of the window (where the header line bust be available
for clicking)

2012-09-28 13:28:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow Analyze Game to auto-step through entire game file

If the game index is set to auto-increment (-lgi -1), the Analyze Game
function will automatically load the next game of the current game file
(starting to auto-play/annotate that) when the end of the current game is
reached. This flushes the annotated game if auto-saving was set,
so that eventually all games in the file will be annotatd and saved.
  The game index is automatically set to auto-increment when we load
a file while in Analyze Game mode, but switching this mode on while a game
is already loaded will stop at the end of that game, as usual (if -lgi was
not explicitly set).

2012-09-28 13:24:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let second engine move in lockstep during dual analysis

When the second engine is also analysing (as indicated by its stat variable
second.analyzing), we send all moves / undos / positions /  in&excludes that
go to the first engine also to second.

2012-09-27 19:07:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow second engine to analyze too

Clicking the Analysis menu when analysis is already in progress will
now toggle the secon engine to analyze the same position. For now,
this lasts only until the position changes (or you leave analyze mode),
after which the second engine is always switched off, and the Engine
Output window returns to single pane. Each pane now has its own header
line; the exclude header is suppressed in the second pane.

2012-09-27 18:11:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add options -fe, -se, -is to load installed engines/ics from list

The volatile string options -fe, -se ('first/second engine') load the first
and second engine of the given nickname in the -firstChessProgramNames list,
including all options that were installed with it (similar to when in
WinBoard the that engine line had been selected through the Startup Dialog's
combobox). The option -is is similarly used to retrieve the line for an
ICS in the -icsNames list.

2012-09-27 18:02:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add check on validity of tourney participants

Before allowing OK of the Tournament Options dialog, it is now checked
whether all participants (which are given as nicknames) can be found
in the list of installed engines, so that no problems will occurr with
non-existing engines during the tourney (if typos crept in after hand-
editing the list).

2012-09-25 16:21:42 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement --help option

The list of options is printed before exiting. Some attempt is made
to do it in a nice way.

2012-09-23 20:10:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement variant seirawan in -serverMoves option

Write the gating moves such that the ChessLive! viewer will understand them.

2012-09-23 20:05:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Workaround for FICS bug

FICS does not properly understand SAN, and thinks bxc3 can be a Bishop move.
This broke 'Upload to examine', because that uploaded in SAN. In case the
SAN starts with Bx or bx, it now uses long algebraic (with = before the
promo char).

2012-09-20 18:17:55 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Define XOP mime type for XBoard

Supply a white-knight icon for this mime type, called application/x-xboard-opt,
and a sesktop file to associate it with running XBoard with this settings file.

2012-09-20 17:24:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Pay attention to extension of 'positional' arguments

An argument without preceding option name was assumed to be an -lgf argument.
This patch still does that by default, but if the argument ends in .fen, .epd,
.trn, .ini or .xop it is considered an -lpf, -tf or -opt argument.
  In addition, an implied -lpf or -lgf argument also imply the option -viewer,
which inserts the -viewerOptions string into the command line, and proesses it
as options. A new option -tourneyOptions is similarly inserted for an implied
-tf argument. These strings should contain all options needed to start XBoard
fully configured as game viewer or tourney playing agent on the mentioned file.

2012-09-20 15:29:42 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let windows stick to right display edge (WB)

Auxiliary windows docked to the board window from below or to the right, which are
pushed out of view when the board window resizes, will be trimmed to just touch the
diplay edge (if sufficient width or height remains). When the board window shrinks,
auxiliary windows touching the edge will be resized so they remain touching it.

2012-09-20 15:20:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Round board size to one where piece images available (WB)

When using built-in bitmaps, in sizes where unorthodox pieces are needed, but not
available, the size is temporarily rounded to one of the sizes where they are.

2012-07-03 17:21:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in Edit Position

Due to = in stead of == the variant was always set to S-Chess in
EditPositionDone().

2012-08-28 21:24:51 -0700 Daniel Macks <dmacks@netspace.org>:
bug #37210: Mishandling of X11 -I flags (tiny change)

AP: applied patch from bugtracker and added one missing 'save_cppflags="$CPPFLAGS"'

2012-06-02 14:31:18 -0700 Arun Persaud <arun@nubati.net>:
bug #36229: changed ICS_* from define to enum


2012-05-28 13:58:00 -0700 Arun Persaud <arun@nubati.net>:
bug #36229: changed STATE_* from define to enum

enabling better compiler checks

2012-05-28 13:50:50 -0700 Arun Persaud <arun@nubati.net>:
bug #36229: changed PEN_* from define to enum

This should allow better checks by the compiler

2012-05-28 13:01:15 -0700 Arun Persaud <arun@nubati.net>:
fix bug #36228: reserved identifier violation

variables and macro names beginning with _ are renamed to XB_. More consistent naming of include guards.
See link in bug report.

2012-05-28 12:36:37 -0700 Arun Persaud <arun@nubati.net>:
Updated German translation


2012-04-30 20:06:00 -0700 Arun Persaud <arun@nubati.net>:
new version number for developer release


2012-04-24 11:23:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Decapitalize promoChar in move parser


2012-04-23 14:12:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Keep track of virginity of back-rank pieces in variant seirawan

The forelast rank of the Board array is now used in VariantSChess to
contain flags that indicate virginity of the back-rank pieces, one bit
for white, the other for black. Legality checking of gatings now makes
use of this info. FENs mention all virgin pieces not implied by castling
rights in the castling field, by printing the corresponding file IDs,
as long as holdings are non-empty. The FEN reader now also understands
this format. EditPositionDone fakes virginity for all pieces that are
on their starting square.

2012-04-17 19:49:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress clear-board message after pasting FEN

The message field is now always cleared when you leave EditPosition mode.

2012-04-17 19:45:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix faking of castling rights after editing position with holdings

The queen-side rook was always imagined at X=0, which is in the holdings
when these exist, so that Q-side castling in such games was never allowed
after EditPosition.

2012-04-20 10:29:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WB Engine Settings window

The listbox patch has broken this window, by making it only list the
first option of the engine, by switching to the next column based on a >=
test rather than == test. Fixed by using 1000 as invalid value for the
break point, rather than -1.

2012-04-20 00:01:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix key binding of DebugProc

The name used for binding was DebugProc, while the ite was named Debug.

2012-04-16 20:51:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ICS Text Menu popup

The space for the option names needed to be allocated.

2012-04-16 20:37:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix disabling of Load Engine menu


2012-04-15 22:53:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Port chat boxes to XBoard

A new menu item Open Chat Window is added to the View menu. It opens a
window that can handle 5 chats. A row of buttons on top selects which is
the foreground chat partner, to which we type, and whose incoming messages
will be displayed in the memo. The leftmost 'button' is not really a button,
but a text edit, and the active partner is displayed there (so it can be
altered). Selecting another chat partner through a button, moves that partner
to the text-edit, and reshuffles the buttons. Incoming messages in a chat
that is not foreground make the corresponding button color orange.

2012-04-16 20:27:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow chaining of single-line text-edits to top

For the benefit of the chat window, a text-edit plus leading description
can now also be chained to the top edge of a dialog. The chaining of the
(degenerate) multi-line ICS Input Box and Move Type-In was entirely to the
bottom, which has now been corrected.

2012-04-12 09:30:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add logo widgets in main board window

New options -logoSize and -logoDir are added. The former enables logo display,
when non-zero and not too big. The latter is used by -autoLogo. The options
 -firstLogo and -secondLogo also work. Problem is that the clock height
is larger than the logo height, and for now a nasty trick in GenericPopUp
is used to position the next element (message field) w.r.t. the clocks,
rather than the last element of the row above (the logo): in case of a
SAME_ROW Graph element, 'last' is kept at the previous element.

2012-04-19 10:48:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on time forfeit with -st option

When fixed time per move was set from the command line, the time-control
strings were not set. This let to a crash when an engine forfeited.
The GetTimeQuota function is now made resistant to a NULL pointer here.

2012-04-19 10:39:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Solve WinBoard name clashes, fix zippy-analyze menu graying

Some of the function names used in the refactored X11 front-end collided
with Windows system names from winboard.h, or with names of internal routines
in WinBoard front-end files (so they could not be declared in frontend.h).
These were renamed. Some prototypes in engineoutput.h contained X11 types,
and they were moved to xboard.h.
  In addition, two menu-item names were corrected to two-part names.

2012-04-18 12:00:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Offer primitive paging in file browser

If there are more than 1000 files that would have to be displayed,
the number will be limited to 999, and a 'next page' entry will appear
at the bottom. Clicking that will give you the next group.
 This is an emergency measure only, as it interferes with sorting
(grouping is based on order inside the directory, i.e. kind of arbitrary,
and sorting is only done within a group.) There is no such thing for the
folder list yet. There is no way to go back to a previous page, other
than closing and re-opening the browser, or selecting another file type.

2012-04-18 11:16:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add pixmap as file type known to browser

Users can browse for a pixmap to set the board texture.

2012-04-17 15:45:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix warning about signedness

Note: the promoChar in ExcludeMoves was explicitly defined to make
sure the kludge promoChar = -1 for indicating best move works. But it
should be equivalent to casting the promoChar to (signed char) just
before the comparison.

2012-04-17 15:44:15 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix warnings about character index


2012-04-17 15:37:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move ManProc to xboard.c

It calls ManInner, which requires X11 data types, even if the values are NULL.

2012-04-17 15:27:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move FileNamePopUp to dialogs.c


2012-04-17 15:15:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix readout of numeric combobox

As currently no numeric comboboxes are used, this bug was silent.

2012-04-17 15:10:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Shuffle prototypes to correct header, or add them there


2012-04-17 14:15:15 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix MenuNameToItem

This function could crash when called with ann argument that did not
contain a period, while the idea was that it should handle this as if the
item is in noMenu (for user-specified key binding to non-menu funtions).

2012-04-16 19:43:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix click-click under-promotion animation save


2012-04-17 11:02:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Define TOPLEVEL in winboard.c


2012-04-17 10:59:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add two new strings to WinBoard language file


2012-04-17 10:51:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix second-engine variant test

The test whether the second engine supports the selected variant took place
before the second engine was loaded, thus always coming to the conclusion
that the variant was not supported, and aborting the TwoMachines command.
The test is now moved to after second-engine loading (but before its
initialization, where non-supporting would become a fatal error).

2012-04-16 12:11:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix clearing of ICS input box after send


2012-04-16 19:08:10 -0700 Arun Persaud <arun@nubati.net>:
enable -Wall -Wno-parentheses for all compilers that understand them


2012-04-16 13:18:37 +0200 Byrial Jensen <byrial@vip.cybercity.dk>:
Remove 5 unused variables from zippy code


2012-04-16 13:14:06 +0200 Byrial Jensen <byrial@vip.cybercity.dk>:
Remove unused static function ShowTC


2012-04-16 13:10:58 +0200 Byrial Jensen <byrial@vip.cybercity.dk>:
Remove unused static function MenuBarSelect


2012-04-16 13:07:01 +0200 Byrial Jensen <byrial@vip.cybercity.dk>:
Remove unused variable first_entry from function find_key


2012-04-16 13:01:09 +0200 Byrial Jensen <byrial@vip.cybercity.dk>:
Remove unused variable tm from function SaveGamePGN


2012-04-16 12:56:46 +0200 Byrial Jensen <byrial@vip.cybercity.dk>:
Remove unused variable delayedKing from function QuickScan


2012-04-16 12:52:57 +0200 Byrial Jensen <byrial@vip.cybercity.dk>:
Remove unused variable pdown from function UserMoveEvent


2012-04-15 04:25:59 +0200 Byrial Jensen <byrial@vip.cybercity.dk>:
Change some double literals to floats.

To avoid unnecessary implicit promotions of float variables to double.

2012-04-15 11:12:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove debug printf


2012-04-14 22:43:03 +0200 Byrial Jensen <byrial@vip.cybercity.dk>:
Translate "NPS" also in engine output window


2012-04-14 16:19:34 -0700 Arun Persaud <arun@nubati.net>:
removed unused variables (-Wunused-variable)


2012-04-14 15:37:05 -0700 Arun Persaud <arun@nubati.net>:
added m4 directory to search path for aclocal. As suggested by Michel Van den Bergh


2012-04-14 23:21:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Eval Graph scale in drop games


2012-04-14 23:16:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ArrowDamage out-of-bounds access on drop moves


2012-04-14 21:33:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement automatic partner observe

Starting a game, or starting to observe one, now automatically issues a
'pobserve' command if dual-board is switched on, so that the partner game
will pop up in the secondary board (assuming it is bughouse).
 The secondary board now displays the players in the title. (This (lightly)
breaks WinBoard again.) When the primary game ends, the secondary board
closes automatically. Initial sizing of the board is repaired, and now uses
the actual current board size, rather than the initial size of the main board.

2012-04-14 15:43:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash due to empty PV

Reception of a stat01 command before the first PV could cause a crash,
as apparently the parser cannot handle this.

2012-04-14 13:27:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress testing for availability in bughouse drops

Give up on testing legality of bughouse drop moves; this only causes problems,
because the move list sent by the ICS is not accompanied by holdings updates.
So XBoard parses it thinking the holdings are empty, making every drop move
an ImpossibleMove. Bughouse can only be played on ICS, and we might as well
trust the ICS that it will only pass us legal moves. A user should not be
able to enter illegal drops; unavailable pieces cannot be grabbed from the
holdings, and typing is diverted to the ICS directly (which would reject the
illegal drop without XBoard even knowing about it).
  Also improve switching to bh/zh, based on drop move in initial board.

2012-04-14 09:11:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some compile errors / warnings


2012-04-13 19:06:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix promotionPopDown on new move entry

The promotion popup is non-modal, and old XBoard versions popped it down
as soon as the user clicked the board, so he could just enter a new move
to abort the promotion. This was broken in the new version, because the code
to do the PopDown and abort in HandleUserMove had not been ported.

2012-04-13 18:38:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Use in-place sweep-selection for click-click under-promotion

With detour under-promotion a piece cycles through all possible choices
during backwards dragging. But in a click-click move there is no dragging.
This used to be solved by letting the second click start a drag event of
the default promotion choice, which you could accept by immediately
releasing the mouse button, or drag around to change it first.
 The dragging in this case seemed a little unnatural, because the to-square
was already indicated by the down-click. So it has been changed now to the
promo choice appearing on the down-clicked to-square, followed by
EditPosition-like sweep-selection on that square when one wants to under-
promote. The move is always accepted no matter where the up-click takes
place, except when it takes place on the from-square (which offers a last-
resort abort possibiliy).
 Note that click-click promotion is essential in variants where it is not
obvious from the from-square alone that a promotion is imminent, but where
it depends on the to-square. (Such as Shogi.) There drag-drop detour under-
promotion is not possible.

2012-04-13 16:05:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Improve arrow drawing

The arrow is now erased together with the border highlights, by marking
the damage it did, and then doing a selected redraw of the board to let
the damaged square be re-drawn. Highlights of a previous move are now
cleared on the down-click that selects a new piece, so there never is an
arrow to infavorably interact with animation of dragging.

2012-04-13 14:57:15 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Also do selective redraw with showTargetSquares on

The XBoard DrawPosition now also keeps track of the previous marker state,
and redraws squares for which thi shas changed. As a result, the routine
MarkTargetSquares does no longer have to force to complete redraw.
(Breaks WinBoard?)

2012-04-13 00:33:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix click-click sweep promotions to empty square

These did not work, because DragPieceBegin would fail on an EmptySquare.

2012-04-12 23:58:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move clearing of target squares to after drag end

A dragged piece that would partly overshoot its destination into a square
with a marker would effectively protect that marker from erasing, when the
erasing was done before the piece was released, because redrawal after the
move only would draw the target square. (Unlike erasing, which forces a full
redraw.)

2012-04-12 23:49:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix double promotion popup

Only the up-click of a click-click move gives a promotion popup now.

2012-04-12 23:32:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix promotion popup

The new GenericPopUp did not like it if the first button had 'SAME_ROW' set.

2012-04-12 17:28:32 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow clearing of marker dots in any mode

There might already be dots when you change to a mode where there should
be none, and you don't want them to stay on forever in that case...

2012-04-12 17:00:55 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix redraw of secondary board on flipping view


2012-04-12 10:30:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let clocks of secondary board count down

The back-end now remembers what is the active clock, and the time left on it.
This is then decremented and updated together with the clocks of your own
game, using the partnerUp flag to divert the clock display to the secondary.

2012-04-12 09:47:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix 3 forgotten symbolic widget references


2012-04-11 19:24:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add sound files to browser menu


2012-04-11 13:04:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add New Directory button to file browser


2012-04-11 09:54:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Detect engine exit during startup

The case where engine startup failure does not result in a fatal protocol
message, like "No such file", but where it simply exits, is now also covered.

2012-04-10 22:55:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress popup for fatal error after tellusererror

For cooperating better with Polyglot, and allowing more to-the-point
error messaging, the (awful) default message will be suppressed if the
dying engine already provided an explanation for its demise to the user.

2012-04-10 20:28:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Engine Output icon heights in international versions

The text in a label option could not be an empty string, or it would be
'translated' to something of enormous size. So it is set to a space now.

2012-04-10 20:21:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix internationalization

The internationalization was broken by moving the XtSetLanguageProc
to behind 'bindtextdomain'.

2012-04-10 20:03:46 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make reference to board widgets symbolic


2012-04-10 18:39:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Don't strip path from engine name if directory given


2012-04-10 17:54:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix vertical chaining of Buttons and browser ListBoxes


2012-04-10 15:53:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix auto-play

The 'narrow search' modification had broken auto-play, because all selected
games were marked as matching position 0, so that they would all start in
thr opening position.

2012-04-10 13:30:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
updated po/pot files


2012-04-10 11:54:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
new version number for developer release


2012-04-10 13:22:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update POTFILES.in


2012-04-10 13:21:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Makefile EXTRA_DIST


2012-04-02 17:53:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Use Ctrl key in EditPosition mode to copy pieces


2012-03-28 23:51:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in FRC castling for position search

In FRC it is essential that both pieces are taken off the board before
any of them is put back, lest they obliterate each other.

2012-03-28 12:25:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug on loading engine

A newly loaded engine was put at the end of the game, rather than at the
current position, (which is required in EditGame mode).

2012-04-06 17:02:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add 'Narrow' function to position search


2012-04-06 10:52:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reorganize main() a bit

The font stuff goes into a separate routine, and the X11 stuff is
moved backwards as far as possible.

2012-04-04 21:55:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Give the dual-board option a separate board window

The second board window pops up whenever an alien board is received
during your game. Moves in it are highlighted by an arrow, irrespective
of the 'Highlight with Arrow' setting. The clocks are displayed, but do
not count down.

2012-04-05 11:23:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Port engine grouping to Match Options dialog


2012-04-05 15:18:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Change default directory in Load Engine to "."


2012-04-05 10:49:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Port grouping to XBoard Load Engine Add highlight to Load Engine grouping


2012-04-06 17:19:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix default file types for browse buttons


2012-04-03 09:14:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
New browser

Redo file browser with GenericPopUp

This had to solve quite some problems, because it wanted to use a ComboBox
option while a transient dialog could be up, was a non-engine dialog
while an engine dialog is up, and XRaiseWindow does not work properly.
  Sorting is done alphabetically, or for digit groups by numeric value.

2012-04-02 14:43:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Use ListBox in stead of ComboBox in Match-Options dialog


2012-04-02 14:09:15 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Use ListBox in stead of ComboBox in Load Engine dialog

Make Load Engine listbox sensitive to double-clicking

2012-03-26 17:06:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add message about enabling in New Variant dialog


2012-03-31 20:27:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move LoadGamePopUp to menus.c


2012-03-31 20:25:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move DisplayMessage to dialogs.c

Use the wrapper SetWidgetLabel to make it back-end.

2012-03-31 15:23:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix switching debug option during session.

Switching on debug mode during the session did not create the requested
debug file.

2012-03-31 15:22:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Correct texi file for use of .Xresources


2012-04-02 19:19:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix recent-engines menu

A new primitive to create an item in a given menu was added to do this.

2012-03-31 10:54:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Switch back two two-part menu names

The menu code is again completely changed; a handle field is added
to the MenuItem tables to store the widget for the item, and this info
is used to alter sensitivity or marking. MenuToNr is replaced by
MenuNameToItem, which looks up the two-level name directly in the
menu tables. Put all currently unused MenuProcs in noMenu table,
so they are available for key binding through the new method.

2012-03-24 18:36:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo main board window with generic popup

Some of the improvements in GenericPopUp (committed earlier) were added
especiall for this (menu and box Option types), and the commits that used
them to make a fully functional board, listed below, were collapsed into
this one.

This uses the new box and menu features of the Generic popup.
Make option table shadow board consistent with refactor
Do main menus in shadow board
 The board made by GenericPopUp now also has (functional) menus. The Expose
 callback now also uses the new format (passing coordinates).
Use BoxEnd callback to decide about smallLayout
 The shadow board now dynamically decides whether it should use smallLayout
 positioning of the title-in-window widget, using a callback in the BoxEnd
 option for the menu bar: If no reasonable amount of space is left behind
 the menu bar, the title is forced under the clocks (smallLayout).
Do some mouse handling on shadow board
 Only button 1 events for now. We have to keep track if the button is down!
Connect button 3 to shadow board
 For now only for piece and PV manipulation: no context menus yet
Symbolic reference in option formatting
choice <-> textValue xboard.c
Improve expose callback shadow board
Implement context menus of shadow board
 This uses the new generic PopUp option
TopLevel xboard.c
Make mock-up board available through menu item
Make clocks of shadow board sensitive to clicking
Make button bar of shadow board operational
 The back-end Event functions are specified as user callbacks directly;
 this is not very clean, as they are parameterless, but called with an int
 argument. This should have no bad consequences, though.
Switch to using shadow board as main board
 The menu marking and enabling had to b switched off for this, as it
 only worked on the old menus. Remove HandleUserMove.
Deleting of unused shell variables, clocks to dialogs.c
Move BoardPopUp to dialogs.c
 This required passing on fome front-end vars as parameters, and returning
 apointer to the option list, to make the handles available in xboard.c.
Simplify InitDrawingSizes
 Now that all widgets of the main window are properly chained, there is
 no need to resize them when the board format changes: setting a new width
 for the shell suffices.
Cleanup some unused Xt Args

2012-03-31 10:53:46 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove unnecessary menu unmarking for Edit Tags


2012-03-29 19:09:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Split sync-after options in Match dialog into checkbox + label

Now the checkbox texts are highlighted on hovering, we don't want the
explanatory text behind it to be highlighted with it.

2012-03-26 17:12:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make variant-unsupported-by-second error non-fatal


2012-03-23 20:06:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo Eval Graph with generic popup

The Graph option of the GenericPopUp is used to implement the Eval Graph.
Compared to the previous implementation, which was drawing directly in the
form widget, the new one has one extra widget layer, but that did not
affect the code anywhere. Adapt eval title to width of eval graph.

2012-03-23 15:17:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo Engine Output window with generic popup

A new file nengineoutput.c holds the X-independent code. This makes use
of new capablities of GenerciPopup, for having Label widgets on same row,
stacking panes after a Break, and chaining Label and Text widgets.

2012-03-21 23:00:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo Game List with generic popup

Check in ngamelist.c
Redo Game List with generic popup
 The X-independent code (i.e. almost all) is moved to a new file
 ngamelist.c.
Make button in Game List to pop up Game List Options
Fix scrolling game list
Fix popup of existing Game List after loading file
Wheel-scroll game list
Symbolic reference game list
TopLevel game list
Put format flags with listbox options

2012-03-21 17:58:27 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo Game List Options with generic popup


2012-04-05 21:56:52 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -dialogColor and -buttonColor options

These only override system defaults if they are non-empty strings.

2012-03-28 15:52:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -topLevel option

This persistent Boolean option determines if the auxiliary windows
(Game List, Move List, Engine Output, Eval Graph, Tags and Comment)
use top-level shells (with their own icon on the task bar, and
independently closable). Other dialogs will always use transient shells.
(Also he modal Error and Promotion dialogs, for which the modality
presumably only serves to pop them down without special attention.)
A control for this was added in the General Options dialog.

2012-03-20 15:30:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo ErrorPopUp with generic dialog

<Enter> keeps popping down error popup.Multiple Error popups remeain tricky;
add comment to describe problem with multiple ErrorPopUps.

2012-03-20 10:22:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo PromotionPopUp with generic dialog

The dialog is no longer modal.

2012-03-19 21:56:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo AskQuestion dialog with generic popup


2012-03-19 21:55:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Major refactoring of GenericPopUp

Allow more transient dialogs in GenericPopUp
Remove grab from promotion popup
Fix other generic popup over transient popup
 To use the generic dialog generator for 'asynchronous' popups (Ask Qustion
 or Error popup caused by engine), the currentOptions setting has to be
 restored for the combo and checkbox callbacks of the transient to still
 work after the asynchronous dialog returns. Note that only transient dialogs
 can have check and combo controls.
Make generic calcel button suppressible
 Also #define some more symbols for Option.min flags,
 and move them to dialogs.h.
Change TypeInProc to general OK handler
 The move type-in now has its own option list, to distinguish it from
 the ICS input box, and give it its own OK handler. Rather than having
 the translation for <Enter> on the text widget call TypeInEvent directly,
 we let it call GenericCallback, which calls GenericReadout, which calls
 the OK proc, which does the job.
  To be able to call GenericCallback from the TypeInProc, the recognition
 of OK and cancel buttons had to be changed. This because it was too difficult
 to arrange the calling widget had label OK or cancell. So these buttons are
 no longer recognized by name, but by the option number passed as client data.
 (This solves the problem that a user could not make buttons named 'cancel'
 or 'OK'.)
Make Cancel button optional
Fix closing multiple popups of same kind
 The GenericCallback figures out its own shell, so all buttons of
 multiple dialogs keep working. External calls to PopDown only work
 on the lastcreated instance of that kind, though (including those from
 the Delete Window button, which can do 'cross-closing'). shellUp is now
 a counter, and PopDowns are only prevented when it reaches 0 or the
 current shell does not exist. (To know this, PopDown now resets shells[n]
 to NULL when is shell is destroyed.
  Beware of double PopDowns (through OK procs); they wreck the system.
Fix Delete Window button of multipe ErrorPopUps
 The action routine for handling the Delete Window now pays attention
 to the shell widget that the system passes to it, and temporarily
 replaces shells[n] by it to let PopDown act on the proper instance.
Add ListBox dialog type to GenericPopUp
Fix vert sizing of ListBox
Put listbox widgets in viewport
Put listbox in viewport
Improved xoptions.c support for focussing and listboxes
Fix OK-row button positioning
Let GenericPopUp take parent and modality as arguments
 This makes the code a bit more explicit and less kludgy. It also becomes
 possible to call the same dialog (e.g. Load Options) from the main menu
 and from another dialog (e.g. the Game List).
Support scroll function for generic popup listboxes
Fix scrolling
Move HighlightWithScroll to xoptions.c
Change scroll algorithm
Add mouse-wheel scroll to generic list boxes
Implement tabbing between text edits
Implement same-row text labels in generic dialog
Allow labels to specify their chaining in generic popup
 The opt.min variable is used to specify the chaining: 0xF0 are the bits
 for (left, right) chaining of the left side (0xC0) and right side (0x30).
 The 0xC bits determine top or bottom chaining of the entire label.
 Without anything spcified (0), the chaining is XtRubber.
 TextBox options can also specify top-chaining of their top. All this was
 needed to allow decent implementation of the Engine Output window with
 the generic popup. (Although tags and comment popup ca benefit from the
 latter feature.)
Let GenericPopUp support a Graph option
 The Graph option results in an area where one can draw something. It is
 positioned / chained similar to Label options. A handler for expose events
 can be specified in the textValue field of the option.
Implement box widgets and menu buttons in GenericPopup
 To enhance the capabilities of GenericPopUp such that it could create the
 main window, it needs to be able tha packaging of controls into a box widget
 (for mennu and button bar). Menu buttons are also required elements
 (although they do look a lot like comboboxes?) Option types BoxBegin and
 BoxEnd can now be used to bracket a group of controls that will be put
 in a box widget. (Cannot be used recursively!) The positioning of the box
 is similar to that of a Label, and is specified in the BogBegin option.
  The code to shrink the menu buttons to fit is also incorporated, to act
 on any box widget: if the BoxBegin option specifies a width, the elements
 in it are shrunk to meet the requirement. Otherwise the box just gets the
 size of the sum of its children (plus spacings).
  Label options can now specify a font, casted into their textValue field.
 (This is needed to get the proper size for the clock widgets.)
Implement callback in BoxEnd options
 BoxEnd is a pseudo-option, to trigger packing the preceeding ones in
 an earlier-opened box widget. In the process it calculates the size of
 the box widget (and trims it if a size was specified for it in the
 corresponding BoxBegin). The Option.target field of BoxEnd is now
 interpreted as a callback, which can be use to take decisions based
 on the determined size for the remaining options in the list, before
 these are processed b GenericPopUp.
Refactor xoptions.c
 Make a subroutine to set args shared by almost all widgets. Swap meaning
 of '1'-bit in option.min flag of Break option, to be consistent with
 SAME_ROW interpretation in other option types.
Make option tables consistent with refactored GenericPopUp
 The flag for stacking in the Break option needed to be inverted, and
 the BoardPopUp needed to pass the font in another field. Better use was
 made of the improved chaining options too.
Improve Graph-option event handling
 The user-supplied callback now gets 3 arguments passed: the event type
 (0 = pointer motion, 1...5 button press, -1...-5 release, 10 = expose),
 and two coordinates. For ouse events these are the pointer (x,y), while
 for expose events they are the window size (w,h). The callback is now
 specified in the option.target field of the Graph option.
Store engine options in malloc'ed memory
 The Option.name field has been re-declared as (char*),  from (char[MSG_SIZ]).
 There are still MSG_SIZ chars allocated irrespective of actual size, because
 the field is also supposed to store the textValue, which can be changed by
 the user. But at least it means that unused options of the generous list
 now don't waste much space. (And the prparated Option tables in dialogs.c
 will shrink by a large factor as well.)
Improve GenericPopUp ComboBox handling.
 The dialog type is now passed to the combobox callback as well, and this is
 used to really figure out what option it is called for.
Allow numeric comboboxes
 When no list of strings is given in Option.choice, the target is assumed
 to be (int), and the number of the slected entry is stored there. Also
 adapts the Label options that act as fillers to the new method for making
 dummies (namely NULL in the Option.name field).
Put comboCallback in Option struct
 Rather than having a general comboCallback variable for the entire current
 dialog, each ComboBox option can now specify its own callback in the
 target field of the option: the COMBO_CALLBACK bit of Option.min indicates
 whether the target is a variable to be set or a callback. The callback can
 still fetch the choice from the values array.
Allow generic CreateComboPopup also to do main menus
 An extra parameter to CreateComboPopup determines if the menu texts
 should be taken from a list of strings (the old method with engine-
 supplied choices), or from a menu table of MenuItems. It can now also
 recognize "----" as a menu break, and keeps margins (for the marking).
Make subroutine for determining curren combo selection
Various fixes to GenericPopUp
Delete one border-width setting
Fix max nr of args in GenerocPopUp
Fix button release events of Graph options
Fix generic Graph callback pointer motion coordinates
Make all format referencing in Option tables symbolic
Let Option.choice define menu texts, rather than Option.textValue
 This is more logical than ussing textValue for it, because choice already
 has the correct (char**) type, while textValue was (char*), and needed
 casting everywhere. Note that for engine options, the fields were the
 same anyway, so no back-end change was required. The textValue now
 contains the (casted) list of actual string values, where these are
 needed. (But for numeric and function menus they aren't.)
Add PopUp Option type
 An new pseudo-Option is defined, to add a popup menu to a previous Graph
 option. The actual popping up is done by the expose handler.
 The function XUngrabPointer is the key to success here. A PopUp option
 specifies a callback for handling the selection from the menu, which will
 be called with the option number, exacty as with ComboBox options.
Update option explanation in dialogs.h
Make Spin and CheckBox callbacks pass dialog number
 No longer rely on 'currentOptions' for getting the option belonging to
 the callback, but get it out of the dialogOptions array indexed by dialog
 type. This way things cannot be messed up by an asynchrounous error popup.
 It also means that it is now save for non-modal dialogs to use these options.
Use button widget for text behind checkbox
Let listboxes use general formatting hints
Let GenericPopUp option always finish last pane after Break
Allow LisBox to specify select callback in Option.textValue
Use double-click to trigger ListBox callback
Make ListBox callback re-entrant
Fix multi-line Label options
Separate CreateMenuItem out from CreateComboPopup
Chain checkbox texts entirely left
Allow a user-specified callback to Label options
 This is needed to implement the clocks. Let the CheckBox callback handle
 it. For now ther is no distinction between different mouse buttons.

2012-03-21 11:15:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Prevent double PopDowns

Some DialogOK functions ordered an early PopDown themselves. This,
however, resulted in PopDown being called twice when they returned TRUE.
This interfered with the new system for allowing multiple instances of
the same dialog. So these functions are now fixed to suppress the
standard PopDown by always returning FALSE.

2012-03-20 19:10:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Split usounds.c and usystem.c from xboard.c

X-independent code was moved to separate files. The nef file usound.c
contains the sound handling, which in XBoard is trivial, because it uses
an external player, but could be replaced by a complex one on platforms
that have to handle the sound themselves.
  The usystem.c file contains all non-X Unix-like stuff, such as fork,
pipe, system, getenv. I also contains some color parsing for the xterm
colors. This stuff could be useful on platforms that support Unix-like
system calls.

2012-03-26 19:03:19 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make routine to probe shift keys

The code to probe Alt keys was taken out of MoveTypeInProc, and extended
to probing Ctrl and Shift keys too. These are now returned in the 6 LSB
of an int by ShiftKeys().

2012-03-19 13:15:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove one level of indirection on ICSInputBoxPopUp


2012-04-10 10:26:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Cleanup of xboard.c

Remove AskQuestionProc
A bit of cleanup on xboard.c prototypes
Remove dead file-browser code
Delete vestigial jail code
 All the stuff about jailColor was deleted. Only one fishy thing remains:
 xpmJailSquare seems under some conditions used in BlankSquare to draw a
 'neutral' square. it is set to a copy of a light square image. But in the
 current design 'neutral' means blacked out between board and holdings,
 and even with image use, it should not resemble a light square...
Remove registering of CommentPopDown and TagsPopDown
Merge CopyGameSelection into CopyPositionSelection

2012-03-19 11:38:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Move some back-endish routines from xboard.c to dialogs.c

Move ICS input-history handling to dialogs.c
Move ICS Input Box text handling to dialogs.c
Move DisplayXxxx routines to dialogs.c
Move DisplayTitle to dialogs.c
 A wrapper SetWindowTitle remains in xboard.c.

2012-03-18 20:10:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Split back-endish part off xoptions.c, and move to dialogs.c

Some MenuProcs for dialogs were also moved to dialogs.c from menus.c.
MoveTypeInProc which is an event handler for the board widget,
was moved to xboard.c, where it can be static.

Identify dialogs by enum type
 A new header dialogs.h is created, which defines an enum type DialogClass
 that is now used to identify the various dialogs done by GenericPopUp.
 The prototypes for GenericPopUp/PopDown, and other globals shared by the
 dialogs code and other modules can go in here as well.
Remove ClearTextWidget
 This did the same as SetWidgetText with an empty string.
Split X-code from PutText
Split back-end part from MoveTypeInProc
Take set-title out of comment popup
Sort MenuProcs in dialogs.c with their support functions
Declare globals in dialogs.c with functions where they belong
Add prototypes to dialogs.h
Move prototypes and globals from xoptions.c to dialogs.h
Make accessor DialogExists for dialog shells
Add dialogs.c to makefile: compiles and runs!
Combine 3 calls into front-end to InitDrawingParams
Move EditCommentProc and ICSInputBoxProc to dialogs.c
Pass option list as argument to GenericUpdate and GenericReadOut
Shorten argument name from currentOption to opts
 This to prevent confusing it with the global variable of that name.

2012-03-18 15:33:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Declare some shared global variables in backend.h

The vlobals twoBoards and partnerUp were only shared through an extern
declaration in xboard.c

2012-03-18 12:34:42 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Split back-endish part off drawing code and move to board.c

Split DrawSquare in front-end and back-end part
Back-endize DrawHighlights and DrawPosition
 The already existing wrapper FlashDelay is used as a kludge to do an XSync.
 We now pass a code for the line color GC to the highight routine. New
 wrappers are DrawGrid() and DrawBorder().
Back-endize atomic explosions
Back-endize DrawArrow and DrawDragPiece
 DrawDragPiece now calls DrawOneSquare with argument EmptySquare in stead
 of the X-type referring BlankSquare. A new wrapper DrawPolygon fixes
 DrawArrowBetweenPoints.
Move board-drawing logic to new file board.c
 All X-independent drawing logic (board, squares, arrows, highlights,
 some animation stuff) has been extracted from xboard.c, and moved to
 a new file board.c, which is back-end (but unshared with WinBoard).
 A new header board.h defines the cross-references (which of course
 required some functions to be no longer declared as static).
  A bit of code was moved from DragPieceBegin to BeginAnimation, which
 now has an extra argument to indicate which piece should appear from
 under a dragged piece. This makes DragPieceBegin free of XCopyArea calls,
 so it could be moved too.
Make board.c truly back-end
 Get rid of all X data types. For this the AnimState struct had to be
 redefined: the GC and Pixmap was taken out and put in front-end arrays
 indexed by anim agent (game and player). For this indexing a new enum
 was defined. The XPoint type was also replaced by our own type of an
 int pair (which is nasty, because the int size could be different).
Move more animation code to board.c

2012-03-18 10:08:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Contract some awful code replication

The code for making an X-color was replicated 6 times, and is now made
into a subroutine. The code for creating GCs was quite repetitive as well.

2012-03-18 08:34:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Move more back-endish menu-related stuff from xboard.c to menus.c

Move menu enabling to menus.c
 Only the wrapper EnableMenuItem stays in xboard.c. A new wrapper
 EnableButtonBar was necessary, because Training mode wants to enable/disable
 that too.
Move all back-endish MenuProcs to menus.c
 Many if the MenuProcs that could not be eliminated by listing the
 corresponding back-end MenuEvent function as handler directly, are
 still completely plactform indpendent. (E.g. when the MenuEvent needs
 a parameter.) These are all moved to menus.c now.
Convert all dead MenuProcs to using MarkMenuItem
 The MenuProcs for the option items that no longer exist were also
 converted for check-marking their item in the new way, because we
 might revive them for key binding.
Move the dead MenuProcs also to menus.c
Revive dead menu procs
Move GreyRevert to menus.c
Move ModeToWidgetName to menus.c
Move initial menu marking to menus.c

A new function InitMenuMarkers was split off from main() to do this.

2012-03-18 08:17:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Switch to use of short menu references

The prefixes menuXxxx. for the item names are abolished. This made it
necessary to also add a MarkMenuItem function that can handle short names
for putting the xMarkPixmap on the items, as the names returned by
ModeToWidgetName are used for both enabling and check-marking.
Let MarkMenu use MarkMenuItem wrapper

2012-03-17 10:47:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Refactor menu code, and move it to menu.c

Supply new method for key binding
 It is annoying that every menu item needs its X-specific handler routine,
 because this handler has to be registered to X for becoming eligible as
 a key binding. Another disadvantage of this method is that the user wanting
 to make the binding has to know the name under which the menu function
 is registered (e.g. FlipViewProc).
  A new method is now made available, which uses only a single (X-specific)
 routine, registered with X as "MenuItem", as generic key-binding handler.
 The bindings can then be made by the user specifying "MenuItem(FlipView)".
 This requires a new list of potential bindings, which should be filled
 by the menu-creation routines. (Currently only contains only a predeficed
 example.)
No longer register all MenuProcs with X
 The list with available menu procs is moved to the user-maintained
 menuItemList. Only QuitProc had to stay registered with X, because it is
 used in CatchDeleteWindow. (So it is in both lists now.) In the future,
 most of the list can be built automatically from the menu tables.
Alter type of MenuProcs to void(void)
 By getting rid of the argument list with X-types, most menu procs can
 become back-end. In the cases of ManProc and QuitProc the original
 version had to be kept as well, because in ManProc the argument was
 actually used (with key binding), while QuitProc is used for delete window.
Remove now unnecessary menu wrappers
 Now the MenuProc have an empty argument list, those that also call a
 single 'MenuEvent' without arguments have become completely redundant,
 and have been taken out of the loop by calling the corresponding MenuEvent
 directly.
Build menuItemList from menu tables
 Rather than having an initialized table of name-proc associations (which
 used to be the X registrations) for the menu items, we now build the list
 during menu cration from the menu tables. The menu "ref" is now used as
 proc name. This means the old MenuProc names used in the predefined
 key bindings had to be changed to conform to this. Note that the bindings
 would slice up names containing spaces in several parameters, so in the
 translations the spaces were squeezed out of the item names. This requires
 a hand-written comparison routine Equal() to identify the binding.
Remove prototypes of deleted MenuProcs
Move prototypes of platform-independent MenuProcs to menus.h
 Create a new header file for the menu stuff, so that we can move
 the corresponding handler routines out of xboard.c to a back-end file.
Extract back-end code from menu creation
 The menu tables and code to interpret them is moved to a new file menu.c.
 Only basic fuctions for creating a pop-down list and for adding an item
 to it remain in xboard.c.

2012-04-07 15:59:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove some unused (exclude-moves) variables


2012-04-07 15:57:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Install engine within current group


2012-04-07 15:53:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Switch to using listboxes for engine-selection in WinBoard


2012-04-07 15:36:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Narrow button in WB Game List


2012-04-05 15:15:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Silence unjust warning


2012-04-04 12:18:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix memory corruption through InitString and second-engine loading

The InitString and ComputerString options were not swapped when replacing
the second engine, so that the ChessProgramStates of the first engine
could point to an invalid (already freed) init string. Also make sure
that appData.directory contains its value in allocated memory, even
when hand-loading engines.
  Some of the rare options were not swapped either, and would thus
always be loaded for the first engine when -singleEngineList was true.
They are now also all reset to their default, before engine load,
to prevent options of one engine to linger on for a next that does
not specify them. The intentional exception is -firstHost.

2012-04-01 20:51:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix PV sorting during fail low

When an engine reports a fail low as thinking output, and then re-searches
the same move with larger window, it now gets a lower score. This line
would then be sorted below the earlier fail low, because it was mistaken
for a multi-PV line for an inferior move. This patch suppresses PVs
overtaking each other if they start with the same move.

2012-03-30 20:09:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Extend smallLayout regime up to size Medium

Because of the increase number of menus, there is not enough space for a
title next to the menu bar at smaller sizes. In fact it is questionable if
the title should ever go on the same line as the menu bar.

2012-03-30 10:38:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parsing crazyhouse promotions with legality testing off

With legality testing off, any promotion suffixes in a move are taken
'on faith'. But in crazyhouse the piece ID for normal pieces is used as
promotion suffix for promoted pieces, so this would Loop Chess rather than
Crazyhouse. Now attention is payed to presence of ID-less promotion pieces
(indicated by ~ in the pieceToCharTable), and if there are, these prevail
ovr the specified type.

2012-03-30 10:07:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix browsing for save file in WB

The generic popup browse buttons used the wrong flavor of browser,
which would only accept existing files. This was inconvenient when browsing
for a save file. The other flavor of browser is now used by default (so that
engine options also use it), and a new flag is added in the option.max field
(which was already indicating file type) to request readonly browsing for a
save file.

2012-04-02 10:18:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let clicking on header line exclude moves

The exclude header in the Engine-Output window can now be clicked, to
toggle the exlusion of the listed move. Clicking on 'none' resets all
exclusions, clicking on 'best' excludes the first move of the latest PV.
The pseudo-move 'tail' represents all non-listed moves.

2012-04-01 22:39:55 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Keep list of excluded moves in Engine Output header

As long as there is still space, excluded or included moves are added
to a new header line in the Engine Output window (prefixed with + or -
depending on whether they are currently excluded or included). Future
in/exclusions of that same move then alter the prefix.

2012-03-21 23:12:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix focus of Game List

After focus was transferred to the filter text-edit, it was impossible
to get it back on the game list (to make the arrow keys working again).
A translation to left down-click is now used to assign focus, just as
it would for text edits. For unknown reason this only worked if the
translations were instated by Overriding, rather than Augmenting,
which again required the normal translation of downclick, Set(), which
selects the clicked item, to be explicitly mentioned as well.

2012-03-16 22:41:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix taking effect of some option changes

This fixes a bug reported at Ubuntu: when switching off move highlighting
in Two Machines mode, the last move before the switch stayed highlighted.
The GeneralOptionsOK() now clears any remaining highlights when highlighing
is off. Similar problems with blind-fold mode and coordinates, which require
a total board redraw to take effect, are now solved by also forcing such a
redraw in GeneralOptionsOK() when they change.

2012-03-16 21:58:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add exclude and setscore to protocol specs


2012-03-16 14:47:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix clock stop after dragging

DelayedDrag always cancelled the previous drag timeout event, even when
this was no longer pending because it had already taken place, and the
event ID was resused by some other timeout (usually a clock tick).

2012-03-14 21:06:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement exclude moves

Dragging a piece by double-clicking it on the from-square in analysis mode
will not perform the entered move, but send an exclude or include command
to the engine for that move (provided the engine enabled this with
feature exclude=1), depending on if the move was already excluded or not.
To this end a map of excluded moves is kept, and cleared when we move to
another position through moving, undo, setboard or new. The user can see
whether he included or excluded the move, as exclude uses premove highlights.
  Commands "exclude|include all" are sent when we throw a double-clicked
piece off board (vertically or horizontally, respectively), but after
exclude all the most recent PV move is included again.
  Remaining problem is that promotions can only be excluded.

2012-03-14 15:13:18 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Mark new text "Click clock to clear board" for translation


2012-03-13 21:46:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
More thorough switch to -ncp on engine failure

The ProcRef and InputSource are now also cleared, and just to be sure there
are no surviving adapters, the child is killed when engine startup fails.

2012-03-13 21:25:22 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Install engines as ./exefile in XBoard

When a path name is split into directory and filename, the latter in Linux
must be preceded by ./ in order to make it executable in the directory
XBoard starts it in.

2012-03-13 14:11:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Inform user in EditPosition mode how to clear board

With -pieceMenu false the board is cleared by clicking the clock, but
since this is impossible to guess, it is now printed in the message field.

2012-03-13 14:06:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix fall-back on -ncp mode

When the requested engine could not be started, the user still had to
wait for the feature timeout to expire before the UI was re-enabled,
and the now-useless loading action would continue. In stead we now
cancel any scheduled continuation, thaw the UI immediately, and switch
the menus and gameMode to ncp straight away.

2012-03-10 18:55:24 -0800 Arun Persaud <arun@nubati.net>:
updated po/pot files


2012-03-10 18:54:32 -0800 Arun Persaud <arun@nubati.net>:
new version number for developer release


2012-03-06 16:37:02 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix typo (seach) in string. It is already fixed in branch v4.6.x


2012-03-04 14:52:34 -0800 Arun Persaud <arun@nubati.net>:
added some documentation about what's need to be done for a release and a bash-release script


2012-02-28 21:09:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix suspected bug in Makefile




2012-02-26 18:55:10 -0800 Arun Persaud <arun@nubati.net>:
add information about our webpage and were to report bugs into the help menu


2012-02-26 18:40:27 -0800 Arun Persaud <arun@nubati.net>:
fixed "make install-pdf": missing target for recursive make in po directory


2012-02-26 23:06:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress recent-engines menu items in ICS mode


2012-02-26 22:45:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix 50-move counter in ICS mode

Marking irreversible moves in the EP_STATUS did not work in ICS mode,
as ApplyMove,which did that is never executed there. Only the boards
sent by ICS are displayed,especially in observing mode. Now the status is
derived from the ICS mov strings (x in the SAN move, or P in the long move.

2012-02-26 17:18:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix two 64-bit warnings

Passing the engine number in a pointer variable to the callback needed
a two-step cast.

2012-02-26 16:53:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix piece symbols on switch back to variant normal

Variant switches were not properly detected, meaning the variable pieces
could keep a form belonging to a previous variant. (E.g. Queen remained
a Lance image after switching from shogi to normal.)

2012-02-26 14:07:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Keep XBoard windows attached on resize

Windows attached to bottom or right are displaced with the size increase.
Their perpendicular dimension is also scaled, to keep their edges at the same
fraction of the main window, unless they stick out. In the latter case the
fraction is clipped to 1, so that edge moves with the full size increase.

2012-02-25 22:40:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement -stickyWindows in XBoard

This makes the auxiliary windows  move with the main window when they were
touching, as in WinBoard. A control is added in the General Options dialog.

2012-02-25 21:14:03 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use more reliable X-call for getting window position

XtGetValues on XtNx, XtNy is unreliable. XGetWindowAttributes seems
to give more reliable results, and automatically accounts for the width
of window dressing. The -frameX/Y options are no longer needed bcause
of this, and were removed.

2012-02-25 11:55:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make frame width configurable in XB

New persistent options -frameX, -frameY now can be used to specify
the amount by which Xt lies about the window coordinates.

2012-02-23 20:01:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use combobox line for recent engines when available

The entry made in the -recentEngineList for the startup engine was
derived from the -fcp value, but this would ignore a possible nickname.
In WinBoard we now use the full combobox line to derive the entry.

2012-02-23 09:29:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix translation of EngineOutputTitle WB


2012-02-23 01:34:12 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Updated Danish translation


2012-02-23 00:59:36 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
One missed translation of cps->which


2012-02-22 19:58:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Undo translation of cps->which = first/second

The string in cps->which should not be translated, because it goes into
the debug file to label engine I/O, and many tools for processing
debug files (broadcasters, PGN extractors) rely on this being "first" or
"second". In all contexts where "first" and "second" need to be translated,
cps->which itself is already enclosed in _().

2012-02-22 18:27:40 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement -serverFile option

This writs an extra debug file with only engine communiation on it,
for the benifit of programs like TLCS.

2012-02-22 17:46:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement -autoCopyPV

This option causes automatic copying of the last position of a PV walk
to the clipboard.

2012-02-16 14:58:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Delete some load-game debug printing

The debug printing in Disambiguate was no longer needed. The printing
of the started process in XBoard that went to stderr is now diverted
to debugFP, so it ends up in the debug file.

2012-02-16 14:41:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Move change of debug file to before game load

Loading a game from -lgf is done before TwoMachinesEvent is called,
but logically belongs to the game. So the code to switch to the new
debug file for the game is moved to NextMatchGame now.

2012-02-16 14:09:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix button grab for sweep selection

The piece-menu initialization limited the grab of button events to those
occurring inside the board window (presumably intended to limit them to
the piece menu, but that does not pop up in sweep-selection mode).
This is now suppressed when -pieceMenu is off, so that selection continues
outside the the board. (Which is very convenient for pieces pu close to the
edge.)

2012-02-16 13:16:13 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Don't leave piece selected after piece menu

PieceMenuEvent left the just introduced piece selected, which is almost
never what one wants, as it makes it jump to the next square when selects.
Which is especially annoying if it captures the piece you wanted to grab...

2012-02-16 12:57:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix use of middle button for position setup

With sweep selection the actual drop is made on releasing the button,
and this event was not caught for button 2. Button-2 motion events were
also not caught by the sweep-selection handler.

2012-02-16 23:53:08 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix one more typo in the translator comments explaning "first" and "second"


2012-02-16 23:39:32 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix typo in translator comments explaning "first" and "second"


2012-02-16 23:23:20 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Add args.h to POTFILES.in and change the interface to ExitArgError() so msg is c format string

Having msg as a format string will ease translations because then
badArg doesn't have to come last.

2012-02-16 22:51:44 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Mark the strings "first" and "sencond" for translation.

... and assign the translated strings to cps->which in function InitEngine()

2012-02-16 18:42:10 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Use ngettext() instead of gettext() for a string to allow better translation.


2012-02-16 00:19:59 -0800 Arun Persaud <arun@nubati.net>:
translation: updated uk.po


2012-02-15 20:59:09 -0800 Arun Persaud <arun@nubati.net>:
modified configure and makefile for handling mimedb update

the default configure will install them using the xdg commands (if they exist on the system)

2012-02-13 22:29:48 -0800 Arun Persaud <arun@nubati.net>:
add configure test for xdg-programs to install mime types; can be disabled for building of e.g. rpms

in case the target system doesn't have the xdg-programs available, we test for them.
Distributions often have their own macros to install these, so we add an enable option to configure

2012-02-13 22:05:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove a debug printf

The parsePV debug printf becomes extremely verbose with -fSAN, -sSAN,
so it was deleted.

2012-02-12 22:18:24 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2012-02-12 22:19:37 -0800 Arun Persaud <arun@nubati.net>:
updated po/pot files


2012-02-12 22:17:03 -0800 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.


2012-02-12 07:52:54 -0800 Arun Persaud <arun@nubati.net>:
translation: updated uk.po


2012-02-12 11:38:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Leave height of row that only contains buttons free

All elements of the GenericPopUp are still scaled to the text height,
including buttons appended behind them (browse or color buttons).
But we now make an exception for a row that only contains buttons,
as there is no harm in it being a little higher (and the buttons look
prettier that way).

2012-02-12 00:01:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix OK button of error popup

The error dialog popped up as a child of the board window, even when
DisplayError was called from a dialog. Now it checks if a transient
dialog is up, and if so, it pops up as a child of that, grabs focus,
and suppresses the system popdown of the transient dialog through a flag
dialogError until it is popped down itself.

2012-02-11 20:07:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file


2012-02-11 10:18:02 -0800 Arun Persaud <arun@nubati.net>:
added some comments for translators


2012-02-11 10:08:46 -0800 Arun Persaud <arun@nubati.net>:
fixed comments for translators: comments starting with TRANSLATORS: are now copied to the po file


2012-02-11 19:01:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Also configure sweep selection

To make sure this feature is tested, we set -pieceMenu false in the
master settings file.

2012-02-11 18:26:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix date in copyright notice about-box


2012-02-11 17:15:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix switching animation masks on variant switch

The masks for variant-dependent piees (E,H in Seirawan, promoted Golds
in Shogi, the Gothic Chancellor) were no longer updated in InitDrawingSizes
because of the patch to reduce X-server calls.

2012-02-11 16:46:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure wider game list

The game list was by default too small, so that there was no room for the
filter field. Now a width of 500 is specified, whcih works at -size 49
as well as 72.

2012-02-11 16:29:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix button chaining and combo/textbox label height

Previous patches forgot to specify the height for the text labels on
-combo and -text options, so they were still too high. Buttons that go
on the same line as the previous element should be chained right, not rubber.

2012-02-11 15:52:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make -pgnNumberTag option setable from menu

The Save Options dialog now containes a checkbox for this.

2012-02-11 15:48:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure some new features switched on

The master settings file switches -showTargetSquares, -sweepPromotions
and -seekGraph on, so that they will get more testing.

2012-02-11 14:43:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix heigth of multi-line labels

The previous height patch overlooked that some labels are multi-line,
and need more height.

2012-02-11 14:10:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix popdown seekgraph on forward-event XB

Only the grid was drawn when the > or >> button were operated, because
a full redraw was not forced by ForwardInner. The recent patch to take
the seek graph down on such events did not account for that. (BackwardInner
always seems to do full redraw, however?)

2012-02-11 12:59:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put front-end support for -recentEngines in XBoard

The engines are added to the menu. Problem is still that in XBoard
startup engines are given by command, rather than selected by combobox,
so the command rather than the nickname ends up in the menu. If this is
then selected, it cannot be found in the list. To limit the damage,
Fairy-Max is now pre-installed without nickname. -recentEngines is now
configured to 4.

2012-02-11 11:53:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Better solution to button-height problem

In stead of adapting the height of text widgets to that of buttons,
(as represented by the message widget), we now do the opposite, and
adapt the button & label heights. This is made safe by obtaining textHeight
from the fontSet's max_logical_extent, though an XExtendsFontSet() call.
Turns out the default height of text widgets is not exactly that, but
4 pixels larger for borders and margin.
  The parameter XtNvertDistance is now used to align the checkboxes with
the following text widget, and their size is derived from textHeight as
well.
  The XtNvertDistance is set to -1 for the lower spin button, so that it
its border coincides with that of the upper spin button. Their height is
set to textHeight/2. This makes their combined height just 1 pixel more
than that of the preceeding text widget. (Uh? 2 x tw/2 -1 > tw?), so for
other buttons we use that too (i.e. textHeight = font_extent + 5).

2012-02-10 22:39:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix warning

Deleting debug printing had made a variable unused.

2012-02-10 22:26:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix sleeping bug

The text-edit-height patch introduced a bug that did not have any consquences
(yet), as the extra arg erroneously included leftover from a previous
SetValues call happened to be the same as one of the intended args.

2012-02-10 20:51:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix unloading of first engine on tourney start

Because NextTourneyGame was loading a new engine before ReserveGame was
called to unload it with dummy game nr = -1), the first engine proc kept
hanging.

2012-02-10 18:39:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove some of the most verbose debug output


2012-02-10 17:46:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Delete some unused WinBoard bitmaps

There waere up-side-down knight icons that apparently hid by mistake
in the bitmaps directory: they were not part of WinBoard

2012-02-10 17:39:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Cosmetic: change 4.5 to 4.6 in xboard.conf comment


2012-02-10 17:35:22 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on empty combobox menu XB

XBoard crashed when a combobox without items was opened, as could easily
happen in the Load Engine dialogs when -firstChessProgramNames contained
no items, as it would without configuring. Now the creation of the popup
menu is suppressed in that case.

2012-02-10 17:13:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix position of checkbox XB

With the large height the widget get in internationalization, the
checkboxes are position way too high above the text. To shift them down
a dummy borderless label widget is drawn above them (when needed).

2012-02-10 15:07:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix heights in Engine Output window XB

The icons did not fit in the space above the memos anymore, so the height
of this area is now left free.

2012-02-10 14:55:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Derive height of text-edits in dialogs from message widget

With internationalization the default height of buttons has inexpliquably
inreased compared to that of text-edits, messing up the layout of the
GenericPopUp. The message widget is now used as a emasure of how high
the widgets should be.

2012-02-10 14:21:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure XBoard engines and textures

The new -useBoardTexture option is needed in xboard.conf, as we want to
distribute with the texture on, while the compiled-in default is off.
A list of 4 engines has been configured (fairymax, fruit, crafty, gnuchess),
as the Load Engine and Match Options checkboxes crash XBoard when the list
is empty. The -recentEngines option is set to 0 to make sure the code
associated with it is never executed: the code is still experimental,
and the required front-end support is only present in WinBoard anyway.

2012-02-10 13:30:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update Dutch WinBoard translation


2012-02-10 13:18:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Create room in some WB dialogs for translations


2012-02-10 13:17:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add 5 missing strings to WinBoard translation template


2012-02-09 23:03:58 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2012-02-09 23:04:46 -0800 Arun Persaud <arun@nubati.net>:
updated po-filies


2012-02-09 22:59:05 -0800 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.

2012-02-09 22:44:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix non-bug in WinBoard

The IDM_RecentEngines was not used in symbolic form everywhere.

2012-02-09 18:46:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix MAXENGINES in WinBoard

The front-end arrays for expanding the engine list measured 1000 entries,
in stead of MAXENGINES, leading them to overflow.

2012-02-09 13:05:42 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement kludge to set options through Move Type-in

A leading "!!! " will cause the rest of the line to be parsed as
command line. Very dangerous, as an unknown option (e.g. because of a typo)
will cause a fatal error, which makes XBoard exit.

2012-02-09 13:04:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put move number in Eval Graph title


2012-02-09 13:00:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement -pgnNumberTag option

A new (persistent) boolean option controls if the sequence number is to
be written in saved tourney games as a Number tag, to make it easier
to correlate games with debug files.

2012-02-09 12:55:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Create separate debug fil for each tourney game

Users can now apecify a -debugfile with %d in its name, and this will
be replaced by the sequence number of the game. TwoMachinesEvent then
starts by opening a new file when the name has changed, so that each
game will go to a different file, with recognizable name.

2012-02-09 12:51:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in WB combobox readout

The previous patch exposed a latent bug in the readout of the generic popup.

2012-02-08 23:25:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow grouping of engines in engine list

Lines "# GROUPNAME" and "# end" enclose a group in -firstChessProgramNames.

2012-02-08 17:47:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix TidyProgramName

A trailing .exe was not removed if the engine name was quoted.

2012-02-08 17:45:42 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put recently used engines in WB menu

A new option -recentEngines specifies how many engines should be listed.
The list of nicknames is stored in the ettings file as -recentEngineList.
The engines are appended to the Engine menu.

2012-02-04 19:37:51 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix registering of EditTagsProg

This was registered with X as EditCommentProc!

2012-02-07 23:04:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Increase max nr of engines to 2000

Move the #define for MAXENGINES also to common.h, so that both the
Load and Tourney dialog use the same maximum.

2012-01-19 23:01:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix fix of switch to mono-mode

The previous fix had == in stead of != for testing if mono-mode had changed.

2012-01-19 22:21:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make New Variant dialog visible in mono-mode

All colored buttons did get a black background, and also black text...
Use timer background color in stead, which is white.

2012-01-19 20:48:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Incease size of WB array of translated items

For the BoardOptions dialog 42 items are now needed

2012-01-19 17:18:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Clone Tourney button XBoard

This makes use of the new GenericUpdate().

2012-01-19 16:34:13 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement GenericUpdate function

This does the opposite from GenericReadout: it copies the current
parameter values into the dialog.

2012-01-19 12:19:27 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix arrow damage with highlightDragging XB

With highlight dragging the highlights of the previous moves are cleared
when lifting the piece. Logically, this should also clear the arrow, but
to do that requires a board redraw, which is not done at this stage. (And
even then this would only be effective after marking the arrow damage,
which is not done yet either). As a temporary fix, we repair the arrow
by redrawing it.
  This patch has moved marking of the arrow damage from DrawArrowHighlight
to a separate routine, so a future better fix can also call that when the
arrow should be erased.

2012-01-18 16:01:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Prevent unnecessary loading of engines

For engines that can be reused, the unloading at the end of a pairing
is in some cases wasteful, as the same engine will be used in the next
pairing as well. In simple gauntlets the gauntlet engine will always
stay first engine, while in multi-gauntlets the oppent engine will stay
the same for an entire round. In these cases unloading is now suppressed.

2012-01-17 22:22:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reset protocol version before loading new engine

The protocol version was not reset, so if the previous engine was v1,
the newly loaded engine would not be sent a protover command, so
that its features would remain unknown!

2012-01-17 19:33:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Give focus to board window after ICS login

toprevent that the focus remains on any popped up chat boxes, it is
explicitlly set otherwise. The board window is preferred over the
ICS interaction window, because you can type from there to the ICS anyway,
and it makes all accelerator keys available.

2012-01-16 14:37:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix seek-graph popup and  popdown

Clicking outside the board area in WB (e.g.on the clocks) would also
trigger seek-graph 'popup'. This is now suppressed by testing for
y-coord > 0. In addition, the seek graph is automaticaly taken down
when we step to another position in the current game (using buttons,
arrow keys or whatever).

2012-01-15 21:29:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress empty lines when observing on VICS

Capture of the engine kibitzes when observing an engine game with
-autoKibitz on was still leaking a linefeed on the Variant ICS
(but not FICS or ICC!?).

2012-01-15 21:24:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix printing non-numeric kibitz with -autoKibitz

Messages that were not considered kibitzed engine PV info for lack of
numeric content, were kibitzed as coming from "your opponent", which
is nonsense if you were iobserving, and masked the source. Fortunately
star_match[0] is still holding the original name, at that point.

2012-01-11 17:33:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix 4 warnings


2012-01-11 17:00:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use same translation of "vs." everywhere


2012-01-11 17:08:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add new translations to WB language file


2012-01-11 16:20:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix re-allocation of PGN-cache memory

It  allocated 8 times too much!

2012-01-11 12:47:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix height board dialog


2012-01-11 12:34:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Enable WB time-control dialog even when no clock mode

The dialog could be called from the tournament dialog to set a TCfor
the tourney even when currently in game-viewer mode, so it'd better work.

2012-01-11 12:28:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Exempt variant seirawan from -disguisePromoted inheritance

This is not a variant where promoted Pawns have to be distingushed
from primordial pieces, as captured pieces do not go into the holdings.

2012-01-09 21:23:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add control for overrideLineGap in WB Board dialog

Make it a checkbox to choose between 0 and -1.

2012-01-09 20:56:40 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add Ctrl-D as alternative to Ctrl+Alt+F12 in WinBoard

The acellerator key Ctrl+Alt+F12 seems reserved on Windows 7.

2012-01-09 20:52:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix seek graph for VICS

The sought command on the open-source ICS code is ICC-like (no terminating
line), although the server is FICS like. So also accept prompt as seek-graph
trigger on FICS.

2012-01-09 20:27:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Open WB startup chat boxes only after logged on

The init code for opening the chat boxes ismoved to DisplayIcsTitle().

2012-01-07 20:31:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Install mime types directly


2012-01-07 20:29:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Install desktop files directly


2012-01-07 20:19:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Install icons directly

Rather than letting make-install copy the pixmaps to the XBoard data
directory they are installed directly from the source files. The name
of the TRN icon was also corrected and changed.

2012-01-05 18:41:13 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file and remove duplicate control

Some missing option descriptions were added. The highlight-dragging
control was removed from the General Options dialog, as it did the same
as Show Target Squares. -highlightDragging wa changed to a volatile option
with default value true, making it effectively disappear as an XBoard
option. (In WinBoard it is still persistent.)

2012-01-05 15:55:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove the direct commands to the engines


2012-01-05 21:15:11 -0800 Arun Persaud <arun@nubati.net>:
forgot to list new desktop files in EXTRA_DIST section in Makefile.am


2012-01-05 20:08:23 -0800 Arun Persaud <arun@nubati.net>:
added some autogenerated po files to .gitignore


2012-01-05 20:05:44 -0800 Arun Persaud <arun@nubati.net>:
added desktop and mime-type association to autoconf install process

This should install and uninstall the mime assocciation and also the icons.
Also renamed the desktop files to avoid possible name collisions.

2012-01-03 21:30:59 -0800 Arun Persaud <arun@nubati.net>:
code cleanup: make function definition confirm to GNU coding style

change everything in the main directory to

void
funcname (int a, int b)

format

2012-01-03 18:43:18 -0800 Arun Persaud <arun@nubati.net>:
Updated copyright notice to 2012


2012-01-03 21:32:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement -viewerOptions

A mechanism is added to allow the user to configure persistently if the
game viewer that starts on clicking PGN files will use -ncp mode, or
load an egine for analysis (or, in fact, do anything). This by introducing
a persistent string option -viewerOptions, which will be parsed as a
command line after the real command line when the option -viewer was present.

2012-01-03 11:29:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash in auto-comment

Trailing linefeeds in AppendComment were not properly stripped off,
leading to a mismatch between the allocted and used memory, and thus
possible buffer overruns.

2012-01-02 23:46:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash at match end

The -afterTourney option had broken old-style matches, because the ranking
string that was tested for "busy" is not set there at all, and remains a
NULL pointer, which strcmp doesn't like.

2012-01-01 19:56:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add desktop files for PGN viewer and tournament player

The desktop files define startup commands for handling PGN, FEN and
tourney files, calling xboard with the proper command-line options.

2012-01-01 19:53:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add xml file for defining mime types

The file xboard.xml defines application/x-chess-pgn, aplication/x-chess-fen
and application/x-xboard-trn as mime types for *.pgn, *.fen and *.trn files,
so these files can be associated with XBoard in various modes.

2012-01-01 19:41:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add icons for PGN and tourney files

Icons are provided in two sizes: 32x32 and 48x48.

2011-12-29 19:55:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Clear square markers on new game

Now that the markers can stay on after a first click, they need to be
explicitly cleared when moving to another board, including a new game.

2011-12-29 15:51:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Abandon single-letter menus in tinyLayout

Now that the items on the main menu bar are clipped, it iso longer
necessary to abbreviate them.

2011-12-29 15:38:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement peeking previous position in WinBoard

The backspace key is used to temporarily display the previous position.

2011-12-29 15:32:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parsing of faulty PGN tags

A closing bracket could be missed in a malformed tag

2011-12-29 15:29:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parser for variant seirawan

The new parser didnot understand gating suffixes with /, and did not
allow any suffix at all on SAN castling moves.

2011-12-28 22:32:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Try to not confuse ICS rating adustments as shouts

An explicit pattern match for the rating adjustment is added before
matching the shouts.

2011-12-28 22:21:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Describe -overrideLineGap option in texi file


2011-12-28 22:03:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use <Enter> in stead of Ctrl+. for peeking last move

I commented out the explicit detection of the Ctrl key, as this
is not needed when there are no 'unnatural' Ctrl keystrokes used
for binding.

2011-12-28 19:37:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Next try for menu-bar sizing

This time request the width needed to just fit everything, and then start
shaving off pixels from the currently largest until the entire thing fits.

2011-12-28 15:17:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Clip texts on menu bar

The width of the items on the main menu bar is restricted so the bar
will never exceed board width.

2011-12-28 14:01:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix format in temporary timing printf


2011-12-28 13:38:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Don't test drops as mate evasions in variant seirawan


2011-12-28 13:36:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ICS castling rights

Copying the castling rights together with CopyBoard seems to have
broken handling of ICS rights, where ParseBoard12 prepares a board
in a local variable, an copies it before parsing the rights.

2011-12-28 13:35:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix initial holdings ICS seirawan games


2011-12-27 18:31:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix sending of S-Chess gating moves to ICS

Normal moves did not get the gating suffix sent.

2011-12-27 17:56:07 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix menu grayout after illegal move

TheThinkingEnables were not reset to user state after the engine rejected
the entered move as illegal.

2011-12-27 13:26:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow setting of holdings with edit command

For the benefit of Fairy-Max' Seirawan Chess implementation, the edit command
no also sends holdings contents (if the engine sent feature xedit=1), encoded
as pieceType + '@' + holdingsCount (if the count is non-zero).

2011-12-24 17:54:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix out-of-bounds access in check test

Thepath to make the check test work with drops had broken the test
after null move (both have rf<0), which led to corruption of the high
word of the black clock.

2011-12-24 17:51:22 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix legality of Spartan promotion to king

In the check test promotion to King is only allowed if there are not
yet 2 kings.

2011-12-21 22:17:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix switching back from mono-mode XB

Suppressing unnecesary X-server calls in InitDrawingSizes had broken
switching back from monoMode, because the animVars have to be recreated
for that, and this was only done when the variant changed.

2011-12-21 22:09:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix showTargetSquares in mono-mode XB

Make the marker dots black (captures) and white, and draw a circle
in the opposite color around them in monoMode.

2011-12-21 22:00:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix arrow highlighting in mono-mode XB

Draw a line around it in darkSquare color in monoMode.

2011-12-21 17:48:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix alignment of generic browse button XBoard

The width ofthe browse button is now read back after creating it,
and subtracted from the preceding text edit.

2011-12-21 14:41:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add -afterTourney option

Only the instance pinting the tourney result will execute this.

2011-12-22 21:01:43 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix buffer possible overflow when writings tags

PGNTagsStatic() could overflow its buffer and is removed. PGNTags() do the work instead of calling it.
It starts by calculation the required buffer size and then allocate the buffer.
PrintPGNTags() now prints directly to the file without having a buffer.

2011-12-22 15:01:31 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
One more string marked for translation

And it is moved inside the if statement that uses it.

2011-12-22 14:30:08 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix checking of return value from snprintf()

snprintf() returns the needed space excluding the trailing 0 byte, so
it has truncated if the returned valued is greater than or EQUAL TO the buffersize

2011-12-19 16:49:31 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix unportable memory initialisation

Memory sat to zero by calloc() cannot safely be assumed to have the pointer value NULL

2011-12-19 13:16:58 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Add 2 strings for translation


2011-12-19 11:25:11 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Remove the last 2 compile warnings in gamelist.h


2011-12-19 11:17:48 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Add #include "moves.h" to gamelist.c for def. of CopyBoard()


2011-12-19 11:11:34 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Definition of TimeMark moved from 3 c files to backend.h


2011-12-19 01:21:46 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Transfer a pointer to the promoChar from PromotionPopUp() to PromotionCallback(). Fixes #34980


2011-12-18 17:24:07 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Duh! Initialise the argument to sscanf() inside the loop, so it always gets a known value when sscanf() fails.


2011-12-18 17:18:12 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Give numeric options the value 0 if a non-numeric text is entered (one more place). Before the value ended up undefined.


2011-12-18 17:08:46 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Give numeric options the value 0 if a non-numeric text is entered. Before the value ended up undefined.


2011-12-18 15:41:46 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix possible crash on 64-bit systems when copying game or position

The two convertproc's for X selections caused reads out of bounds on 64-bit systems.
I hope that this is the right solution. I am not experienced with X stuff, but it
follows that I have seen in other programs, testing shows that copying still works,
and the reading out of bounds have disappearinged with this patch.

2011-12-18 13:26:20 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix a possible crash in the file browser

If the OK button was selected in the file browser when no file was selected
there was a read out of bounds which could crash xboard

2011-12-17 22:54:34 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix a memory leak in Sound Options


2011-12-16 02:57:20 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Fix crash when selecting user soundfile due to free() of not malloc()'ed memory


2011-12-16 02:32:37 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Make GenericPopUp() more readable by using more named flags instead of numerals

Defines the flags SAME_ROW (value 1) and NO_OK (value 2) for use with buttons and endmarks.
There should no functional change.
Also add a code comment where a condition depends on an uninitialised value. There is no direct harm, as both
branches do the same (that is nothing) when the value is uninitialised.

2011-12-15 02:51:36 +0100 Byrial Jensen <byrial@vip.cybercity.dk>:
Add NO_GETTEXT flag for combobox. Fix bug #34991

Define NO_GETTEXT flag to avoid calling gettext() for comboboxes, and define COMBO_CALLBACK
flag to call comboCallback() when an item is selected in a combobox (no new code for this,
just a symbolic value instead of a number). The flags are used for the min field of struct Option.
NO_GETTEXT is used for the Select engine combobixes in the Match Options and Load engine windows.

2011-12-13 19:48:37 -0800 Arun Persaud <arun@nubati.net>:
only translate entries in CreateComboPopup if strlen>0; fixes #34991


2011-12-12 19:06:26 -0800 Byrial Jensen <byrial@vip.cybercity.dk>:
fix for repeating key issue, with this allissues this bug should be closed; fixes #35000


2011-12-12 18:45:05 -0800 Arun Persaud <arun@nubati.net>:
also don't translate selection in ComboSelect; fixes #34991


2011-12-12 18:40:23 -0800 Arun Persaud <arun@nubati.net>:
make entries in CreateComboPopup not translateable; fixes #34991


2011-12-10 16:06:47 -0800 Arun Persaud <arun@nubati.net>:
fix translation for engine list; fixes #34991

* click on browse button should be recognized in translated versions
* width of button should auto-scale

2011-12-10 11:04:17 -0800 Arun Persaud <arun@nubati.net>:
change keybindings that don't use ctrl, make MoveTypeInProc ctrl aware; fixes #35000

two keybindings were using keys without modifiers, adjusted these to use the ctrl key.
Furthermore when typing in moves we need to check if ctrl was pressed and ignore those inputs.

Also added documentation for these keybindings.

2011-12-10 10:51:18 -0800 Arun Persaud <arun@nubati.net>:
replaced unicode character for "'" in xboard.texi


2011-12-10 10:08:48 -0800 Arun Persaud <arun@nubati.net>:
removed Iconify function. Should be handled by the window manager.


2011-12-08 20:53:13 -0800 Arun Persaud <arun@nubati.net>:
marked an error messages for translation


2011-12-08 20:33:29 -0800 Arun Persaud <arun@nubati.net>:
translation: updated uk.po


2011-12-03 17:52:23 -0800 Arun Persaud <arun@nubati.net>:
fixed size of XBoard icon to 48x48

the icon gets installed in the 48x48 directory, but was >200 pixel wide. This gave a warning during rpm creation.

2011-12-03 08:07:32 -0800 Arun Persaud <arun@nubati.net>:
updated pot file

marked a lot of new strings for translation

2011-12-03 08:06:42 -0800 Arun Persaud <arun@nubati.net>:
added new files to po/POTFILES.in


2011-12-02 22:13:36 -0800 Arun Persaud <arun@nubati.net>:
marked more strings for translation


2011-12-02 20:08:01 -0800 Arun Persaud <arun@nubati.net>:
translation: added danish translation


2011-12-01 18:45:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change encoding of seirawan ICS gating-castlings

In stead of using upper/lower-case promoChar, the ICS now uses
RxK notation, like WinBoard writes in SAN, for better consistency.

2011-11-30 15:38:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put promo-suffix on ICS move in variant seirawan castlings

The distinction upper-case / lowercase determines gating at R / K

2011-11-28 11:56:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Refrain from making unnecessary resize X request

The window resizing code in InitDrawingSizes is suppressed when no
change is needed. Similarly, changing piece bitmaps is suppressed when
we stay in the same variant (and InitDrawingSizes is called e.g. because
of chaging lineGap through the Board dialog).

2011-11-27 22:27:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parsing of O-O castling in variant janus

The new parser did not realize it meant e1i1 rather than wild e1h1.

2011-11-26 22:28:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Show 50-move counter also when observing ICS games

To not cheat 50-move display was suppressed in ICS mode,
but for observing a game this made no sense.

2011-11-26 22:22:07 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Ignore ICS game starts when already in game

The advance switching of the variant on game-start messages was
disruptive for users with gin=1, which also sends such messages
for other games than your own. For now fixed by only reacting on
them when idle (detected by invalid game number).

2011-11-11 18:16:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WinBoard  clock-click bug

Clicking on the clock in WinBoard also called the LeftClick routine
for handling clicks on the board. This led to the from-square being set
to some inalid value, so that the next genuine board click was interpreted
as a to-click, with undesired effects, especially with legality testing off
or in EditPosition mode, where weird things are accepted.

2011-11-06 17:20:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add feature-override options

A few (dangerous) options are added to allow a user to override
engine features, or change their defaults, by supplying a string
with feature commands (e.g. "sigint=0") which tricks XBoard into
thinking the engine sent that. There is a -featureDefaults which is
processed before the engine features, and -first/secondFeatures
which is parsed just before engine initialization.
  This goes horribly wrong when the user wouldtry silly things like
including 'option' or 'done' features!

2011-11-05 12:32:39 -0700 Arun Persaud <arun@nubati.net>:
translation: updated uk.po


2011-11-04 21:58:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix handling of -secondOptions option

The -firstOptions and -secondOptions settigs were not swapped when
-singleEngieList was true, so the second engine's options would never
be set in that case, but used for the first engine.

2011-11-04 21:55:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Accept setup command in variant fairy even with legality testing on

Variant fairy does not really have a defined opening position, but lots
of pieces defined, so we might want to play with legality checking on,
but still rely on the engine for the opening position

2011-11-04 21:52:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Set pieceToCharTable by setup command even when ignoring FEN

When the user starts from a set-up position, the egines default
openingposition has to be ignored, but the pieceToCharTable would
still be relevant.

2011-11-04 21:48:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change default sweep-promotion choicein queenless variants

The initial scanning of the sweep piece until a defined piece is found
is now in the increasing direction (still starting at Queen), so that
the fairy pieces are suggested before R, B and N.

2011-11-03 16:38:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Clear board markers when moving to other position

Now the markers from -showTargetSquares would stay on after a first click
for the benefit of a click-click move, they would also stay on when not
finishing the move, but operating the < > buttons in stead to call up
other positions. ForwardInner and BackwardInner now clear the markers,
like they also cleared highlights.

2011-11-01 18:30:22 -0700 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.

2011-10-25 15:32:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix two warnings

2011-10-24 20:00:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Don't adjust clock on right-click in EditGame mode WB

This was a change that was already done for the left-clicks, but somehow
never made it togit for the right-clicks

2011-10-24 19:50:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Change chase message in .lng files

2011-10-24 19:31:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let perpetual-chase message mention square

In stead of a boolean, PerpetualChase now returns the square the chased
piece ends on (encoded as an int), and on adjudication it will be printed.

2011-10-24 19:26:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add mechanism to translate variable messages in WinBoard

A message prefixed with % in the lng file will be considered a match
if it matches the start of the text to be printed, and the remaining
part of the latter will remain untranslated. This was needed to allow
translation of the perpetual change message, now it indicates the square
of the chased piece.

2011-10-24 19:20:13 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Use other interpretation of Asia rules for chase detection

The detection of perpetual chases now ignores pre-existing checks.

2011-10-12 17:28:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on loading garbage game file

The code to cache games was not resistant to moves before a valid
game start, or a game filewithout any games at all.

2011-10-08 20:43:52 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Incorporate variant type in book hash key

This prevents booksforone variant being used for another, and allows
multi-variant books.

2011-10-07 15:41:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update language.txt file


2011-10-07 15:34:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update Dutch lng file


2011-10-07 15:21:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Load Options dialog WB

Defined fastkeys; reordered elements so that fastkeys focus edit they
are intended for. Changed some of the more obscure texts. Corrected
list of transatble dialog items, adding a few missing ones.

2011-09-13 20:01:42 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some warnings

Prototypes were added, ormoved from backend.c to backend.h.

2011-08-26 12:44:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Put 'Load Next' button back in WB Game List

The '>' button for loading the next (filtered) game is re-instated in the
WinBoard GameList. The main window has now accelerator keys Ctrl+Up and
Ctrl+Down for loading the previous and next filtered game.

2011-08-26 12:31:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Speed up position search and consider side to move

The position search is made to pay attention to the side to move,
which produces a speedup, because we only have to compare half the
game positions when looking for an exact position match. An addition
we now keep track of the total number of pieces, and abandon a game when
it drops below the number of pieces in the position we seek.

2011-08-21 23:16:15 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Dynamically allocate move cache

A small statically declared cache good for 250k moves (~3200 games)
will be expanded in steps of a factor 8 when it overflows.

2011-08-18 18:40:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Translate search strings


2011-08-17 22:55:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement flipped search


2011-08-16 15:29:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Debug position search cache


2011-08-15 18:44:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
profile


2011-08-18 18:01:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Translate search-mode strings


2011-08-15 16:59:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Quickscan


2011-10-23 16:04:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix duplicate loading of second engine in tourneys

To decide if new engines should be loaded, it was tested if first.pr
equalled NoProc, assuming that ReserveGame would have left the engine
loaded if the next game would need the same engines. But a reuse=0 engine
could have caused termination of the first engine process anyway, while
the second would still be alive. So unconditionally starting of the second
engine would cause redundant engine processes to abound.
  Now we only start new engine processes if both engine processes are dead.

2011-10-23 15:53:32 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix PV walking with -fSAN

The SAN options had broken the PV walking, because the shelving of the
walked PV to create space for the conversion to SAN of an incoming PV
would not be properly undone, but would add the walked PV to the game.

2011-10-20 12:39:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Refine clock adjusting

Adjusting the clocks by shift-clicking them is now only allowed with
autoCallFlag off, and an error-popup results when you do it otherwise.
Also, swtching to Edit Game mode won't reset the clocks to the stored
value anymore when you have just adjusted it.

2011-10-12 17:43:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on adding items near book end

When Edit Book would add so many entries near the end of an opening
book that the end of the added info would surpass the old end of the
file, the copying of the tail got stuck in an infinite loop, extending
the file without limit with repeating info.

2011-10-12 17:41:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Print message on wrong use of Clone Tourney

The user is urged to first provide the name of an existing tourney file
when he presses the button without one. The button is also renamed.

2011-10-12 17:38:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix invalid combobox entry WB

A combobox label that was not in the list (because the user typed
it, rather than selecting one) would cause a crash.

2011-10-12 17:23:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on loading garbage game file

XBoard crashed when a game file contained a PGN game result before
any valid game start, because data would be written in a game-list
node that did not exist yet. This would occur frequently when garage
was read; basically any asterisk in the data would do it.

2011-10-11 23:31:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add control to set -discourageOwnBooks WB


2011-10-11 20:53:52 -0700 Arun Persaud <arun@nubati.net>:
only require 0.17 of gettext

This seems to solve many build issues with older distrubtions and doesn't seem to be a problem with newer ones.

2011-10-11 23:31:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add option -discourageOwnBooks

This boolean option determines the default setting of the hasOwnBook
option before a tourney game starts. By setting it, the hasOwnBook
option is cleared, which would enable use of the GUI book, like the
engine was installedwith the /firstXBook option. An explicit option
on the engine install line can still overrule this, though.
 A control to set this option has been added in the XBoard Match dialog,
and it is saved in the tourney file to force consistency.

2011-10-11 22:58:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reset initString and computerString on engine load

These options are typically engine specific, and must thus be
reset to their default value before loading a new engine.

2011-10-11 22:43:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add Romanian lng file


2011-10-07 16:55:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reactivate Falcon Chess

Now the patent for this has expired, Fairy-Max plays it again.
So the XBoard support for it is now switched on, and an item for it is
added to the XBoard New Variant menu dialog. (WinBoard still had that.)
In the array the Lance was changed for the Falcon as a wild-card piece.

2011-10-03 09:59:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file for new features


2011-10-03 10:30:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file for position search

The new items in the Load Game Options dialog are described, as well
as the command-line options used to store them in the settings file.

2011-10-03 09:28:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove paragraph about .Xresources from texi file

Command-line options can no longer be set through .Xresources already
since version 4.5.0.

2011-10-03 09:13:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add Dutch WinBoard translation


2011-09-28 20:46:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Prevent Edit Book window from stealing focus (WB)

In WinBoard updating the book window would give it focus. Now the
focus is given back to the main window, except when the Edit Book
window is first created.

2011-09-28 20:42:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make book-window update part of HistorySet


2011-09-26 16:01:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix position loading in tourneys

In a tourney a position must be loaded when the engine is not yet
started, and the old version of LoadPosition could not handle that:
It would start up the engine, and send it commands unconditionally.

2011-09-26 15:58:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix resetting -fSAN on engine change

There were two places for loading another engine, Load (from menu) and
SetPlayer (in tourneys), and the previous patch for this missed the
second one.

2011-09-26 15:51:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make too-long game non-fatal

GameEnds is now called when the maximum number of moves is exceeded,
rather than DisplayFatalError. Not sure if this properly terminates the
game in all situations, but DisplayFatalError (after calling GameEnds)
would also wait for the user to confirm the error popup before really
exiting, so that in an unattended automatically running tourney there
was not much fatal, and the entire tourney would in fact be finished.

2011-09-26 15:46:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Keep book file open

Rather than opening and closing the book file on every probe, it is
now only closed and opened when the name of it changed.

2011-09-26 15:44:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress playing of book moves with weight 0

Bookmoves with weight 0 could be played when the sum of the weights
of all moves from the position was 0. So it was not possible to suppress
the only move by giving it weight 0. This is now corrected.

2011-10-01 15:00:47 -0700 Arun Persaud <arun@nubati.net>:
added NEWS for release of 4.5.3


2011-09-29 20:31:23 -0700 Arun Persaud <arun@nubati.net>:
better contrast for XBoard icon on a dark background


2011-10-01 13:09:59 -0700 Arun Persaud <arun@nubati.net>:
translationproject.org: updated Ukrainian translation


2011-09-29 20:49:42 -0700 Arun Persaud <arun@nubati.net>:
updated pot file and send to translation project


2011-09-22 12:09:39 +0100 Thomas Adam <thomas@fvwm.org>:
(tiny change) Clarify "-name" option is Xt-only

There's a set of standard options with will get used by Xt, before Xboard
itself will use them.  "-name" is an Xt-only option which will set the name
and resource of the window to the value requested.  It has nothing to do
with setting opponent/player names.

Signed-off-by: Thomas Adam <thomas@fvwm.org>

modified slightly by Arun Persaud (renamed itemx to item and fixed option name for CMAIL)

2011-09-22 17:17:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix LoadGameOrPosition starting up engine

When LoadGameOrPosition() is called from NextMatchGame(), the Reset() that
is called in LoadPosition() when you are running from a position file
would prematurely start up the engine (without waiting for features).
The kludge to suppress this behavior for the explicit call to Reset()
is now extended to encompass LoadGameOrPosition.

2011-09-22 17:14:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Clear fSAN option before new engine load

This to prevent the new engine will inherit it from the previous one.
As the command-line options an only set it, this has to be done by
explicit assignment.

2011-09-13 23:02:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some warnings (prototypes)


2011-09-13 19:55:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix write failures in concurrency

In WinBoard a flood of writes by differentprocesses to the same PGN can
cause a "permission denied" error in fopen. This patch causes retries after
a random (5-15 msec) wait, in such cases.

2011-09-13 19:52:19 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Move HistorySet to back-end

This existed in exact duplicates in both front-ends.

2011-09-13 19:46:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make DoSleep front-end wrapper for msec sleep

DoSleep was #defined as a macro for Sleep/ sleep, with an argument
indicating msec in WinBoard, but seconds in XBoard. Nuw it universally
uses msec, by defining it as a wrapperin the respective front-ends.
(For XBoard itwraps FrameDelay.)

2011-09-10 22:35:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix playing sounds when -soundProgram is empty

It made no sense to just send the names of the sound files to the shell.
So the soundProgram isnow tested for being an empty string, and if so,
PlaySound() is aborted.

2011-09-10 14:01:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -afterGame option

This option specifies a command line to be executed after each game of
a tournament. To execute the line, the function RunCommand() was added
in the front-end. For XBoard this was a simple call to system(); for
WinBoard part of the StartChildProcess code was cloned (without the pipe
stuff).

2011-09-10 13:52:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Upgrade -serverMoves option

The (undocumented) -serverMoves option was upgraded to conform to the
ChessLive! protocol extension for sending SAN tags. A bug that allowed
upper-case promoChar to leak through was also fixed, and code was added
to write engine PVs to file. Flushing of the game result to the -serverMoves
file was also fixed.

2011-09-10 13:50:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix AppendComment

The joining of two comments was not performed correctly if the second
one had the braces yet to be added: the closing brace was not added in
that case.

2011-08-30 19:39:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Auto-popup ICS Input Box

Typing to the board made the move type-in pop up, but in ICS mode
this is of course undesirable. Like in WinBoard, the ICS Input Box
should pop up in stead, and accept the typed character. This is now
realized. If the box already exists and has text in it, the typed
character is appended to that text, and the box is given focus.
Spaces now also are considered as printable.

2011-08-30 18:27:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Slightly decrease sensitivity of sweep actions

The sweep-selection of promotion and drop pieces, or step through the PV
was so sensitive that it was difficult to reliably make the intended choice.
It has now been reduced by a factor 1.5-2, and the sweep selection and
PV walk now also use a different value.

2011-08-27 21:16:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Extra buttons in WB Tournament dialog

A button to copy contents of the tournament fileto the dialog is added.
Buttons to invoke the Common Engine and Time Control dialogs are also added.

2011-08-27 21:15:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on typing non-existent enginein Load Engine dialog


2011-08-24 10:30:46 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix display state after failed analysis attempt

When an engine responded to the "analyze" command with an "unknown command"
message, a Reset was done without altering the display, causing a
discrepancy between display and internal state, which caused confusion
when it finally corrected itself. I replaced the Reset call by an
EditGameEvent call, to preserve the loaded game. The Reset was presumably
used to allow for the case where the engine would be so upset by the
analyze command that it needed to be reset by a "new" command, but this
seems overly paranoic for an engine that just recognized the command
as an unknown one.

2011-08-24 09:58:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix treatment of PGN score/depth info with linefeeds in them

This is needed to make the PGN more Arena-proof.

2011-08-24 09:51:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix quoting in Load Engine dialog

A (space-contaning)  engine name only needs quoting when there are parameters,
because the over-all engine command will be quoted anyway. For UCI engines
duplicate quoting is fatal, because when passed as the -ec argument of
Polyglot, it will be quoted yet another time, also with double quotes.

2011-08-23 21:24:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Replace Analyze File by Analyz Game function


2011-08-22 22:16:58 -0700 Arun Persaud <arun@nubati.net>:
new developer release


2011-08-22 22:26:56 -0700 Arun Persaud <arun@nubati.net>:
update po files


2011-08-22 22:24:23 -0700 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.


2011-08-22 22:09:19 -0700 Arun Persaud <arun@nubati.net>:
malloc.h is not needed


2011-08-20 22:21:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ICS move-list header mistaken for null moves


2011-08-18 18:53:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow two-games-per-opening to work with book

A new option -seedBase is added, and written to the tourney file.
It allows all XBoard instances working on a tourney to generate the same
'random' openings in a deterministic way, based on this one-time seed
and the game number. When -loadGameIndex equals -2, it uses the same seed
for an odd and the following even game.

2011-08-18 18:51:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix use of random

In some places rand() was called explicitly, rather than through the
(configured) place-holder random().

2011-08-18 17:34:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Translate search texts


2011-08-18 10:29:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -useBoardTexture and -usePieceFont options

These options suppress the use of the given texture files or piece fonts
without relying on the kludge to disable them by prefixing an asterisk
to the file or font name. Checkboxes have been added to the Board dialog
to control them. The user can now set piece font in WB font dialog.
The sample text can be used to specify the -fontPieceToCharTable,
the font name itself the -renderPiecesWithFont value.

2011-08-16 23:10:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on start without settings file

A primordial -1 in currCurrent caused a crash when WinBoard was started
without ini filein game-viewer mode.

2011-08-12 12:08:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix generic-popup failure after empty engine-settings dialog

The error exit ofthe Engine #N Settings dialog in case of an engine without
options forgot to clear currentCps, with as a result that the generic popup
thought every subsequent popup was an empty one, and kept repeating the
'engine has no options' error message for every dialog.

2011-08-10 11:27:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow substitution of engines during tournament

Two buttons are added in the tournament options dialog, for upgrading
and for replacing a tourney participant. Lots of tests on the validity
of the request are done, and if all are passed, the tourney file is
written with the new participants (and in case of replace) with the
results of the replaced engines erased from the -results string.

2011-08-08 11:00:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix up/down arrows in game list


2011-08-08 10:31:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add key bindings for loading next/previous game of list

These bindings are set both for the game list and the board window.
To make them useful, focus has to be transferred to the board widget
after loading (it tends to transfer to the tags window), which now
seems to work, but not always. From the game list the shellWidget
seems to get focus rather than the board, which is bad as it is not
sensitive to the key bindings.

2011-08-08 09:58:31 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow deletion of last book move

The book-edit function refused to delete the entiremove list,
for no good reason. This limitation now has been lifted.
Also the error message that the key for the current book entries
is different from that of the currentposition has been suppressed
if there were no entries found for the current position (so that the
book is positioned at the next key), so that it is possible to add
moves from scratch.

2011-08-08 00:19:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Speed up parser

Line numbers > 1, which are common, can exit already during move parsing,
to save lots of matching on resultsand castlings.

2011-08-07 15:13:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix missing files in file browser

The file browser was throwing away the first two files, assuming
they were "." and "..". Alas, this is no longer true on every Linux.
Now we actuallyc compare for these names, before skipping them.

2011-08-06 11:57:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Delay file loading to allow expose event first


2011-08-06 09:29:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix paging


2011-08-05 22:39:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Better fix of crash on empty game list

An empty list is now replaced by a list containig a simple message.

2011-08-05 20:31:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add plain arrows as key binding for stepping forward/backward


2011-08-05 20:30:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Debug position selection


2011-08-04 13:22:55 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Print progress during load / selection of game

The title bar of themain window is used to display a running count
of the number of games loaded / searched.

2011-08-04 12:44:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Parse PGN tags without allocating memory

In WinBoard malloc/free did not seem to work when preparing the game list,
leading to a huge memory list when ParsePGNTag was used. The added code
parses the required tags in an alternative way as a work-around.

2011-08-02 22:58:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement searching games in Game List for a position

For this it was needed to reconstruct all positions of the games
without loading them, so they could be compared to the currently
displayed position. A new routine GameContainsPosition is made for that.
 In Disambiguate, when the global quickFlag is set, we now do the
disambiguation ignoring check,and only if this leads to an ambiguous
move, we repeat it taking check into account to see if that resolves
the ambiguity. This causes us to miss if unambiguous moves are illegal
because they put their King in check, but who cares?
 We now do not make game-list line when not needed. If we do not filter
by text, but by position, there is no need for preparing the game-list
line for games that are not selected. All for efficiency.

2011-07-28 20:47:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow entry of variations in PlayFromGameFile mode

Adding variations is more like editing a comment,and not really editing
the game. Therefore we allow it on loaded games. As soon as we are in a
variation, we temporarily switch to a (hidden) EditGame mode, restoring
the original mode when we revert to the main line.
  We now also stay in PlayFromGameFile mode after loading a game,
And opening variation (fromtheComment window) in PlayFromGameFile mode
is also allowed.

2011-07-27 18:47:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Force Move History refresh after loading/reverting variation

The Move History window was not refreshed after switching to or from
a variation if that variation happened to have the same length as
the main line. Now a change in storedGames since the previous refresh will
force a full refresh to avoid this. For this to work, storedGames
did have to be decremented after ToNrEvent in PopInner, because ToNrEvent
calls HistorySet before the history is restored, so we don't want
it to snatch away the full refresh. A call to HistorySet had to be
added after PopInner is done restoring the move history.

2011-07-27 17:45:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Popdown Comment window on new game

What is in this window cannot possibly remain valid, and can even be harmful.

2011-01-19 11:46:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow null move in analysis and edit-game mode

In some games it is allowed to pass your turn. The internal
representation picked for such a null move is the drop of an empty
square, (EmptySquare,DROP_RANK,0,0). Computer-algebraic form is "@@@@",
SAN form is "--", (for compatibility with ChessBase / SCID), and the
non-compliant forms "null", "pass"and "Z0" are recognized in
the parser as well. ApplyMove() has to test for this special case
(to not actually clear a1), and a way to enter the pass for the user had
to be found (clicking the opponent clock, like in EditPosition mode).
 The null move is made move irreversible to prevent repetition draws
spanning null moves being adjudicated.
  Such entry of null move is now allowed in AnalyzeMode and EditGame mode.
Because Chess engines will not accept null moves, SendMoveToProgram had
to be adapted to send not the move, but the position after it in
case of a null move. This erases the move history in the engine,
so it will not react to 'undo' for that null move, so BackwardInner
had to be adapted to test for intervening null moves, and if one is
found, approach the target from the other side after loading the
earliest position before it not crossing another null move, and
then loading the moves upto the target.
  XBoard clock clicks had to be fixed, to pay attention to the shift key.

2011-07-25 21:58:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Give WinBoard Game List its own font

The font fort he Game List used to be shared with the Engine Output and
Move History windows, but this made it impossible to use a figurine font
in the latter two (which displays piece symbols for capitals) without
messing up the Game List. An option -gameListFont has been added to specify
the font for the Game List(and save it in the settings file), while a
control for it is added in the fonts dialog.

2011-07-21 19:02:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on OK after Save Changes in Tags and Comment popup.

The global variables tagsText and commentText were used to pass
a string obtained from a widget (and thus not malloc'ed), which
caused a crash when the GenericReadout tried to use those variables
for the new value. Fixed by using GenericReadout (which does malloc)
to read out the text,in stead of GetWidgetText.

2011-07-16 09:31:12 -0700 Arun Persaud <arun@nubati.net>:
Revert "fixed segfault in xengineoutput", fixed in the backend now (from HGM)

This reverts commit 33a0e73843115ff6d4eacaf963a38f2e8b20b295.

2011-07-16 14:53:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress some XBoard warnings


2011-07-15 11:21:29 -0700 Arun Persaud <arun@nubati.net>:
fixed segfault in xengineoutput


2011-07-11 20:04:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Disable -showTargetSquares in ICS mode

Help like this is considered cheating on FICS, so it is disabled for
all 'classical' ICS variants. (For variants eyont Shogi we don't care.)

2011-07-10 21:20:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Put grab on sweep-selecting in Edit Position

A right down-click starting a sweep-selection event did not grab the
mouse events, so that an up-click outside the window would go
unnoticed, and the pointer motion stayed coupled to selecting the
piece until the next click. By returning 2 from the RightClick back-end
routine we request the grab.

2011-07-09 13:50:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Write more labels on score axis of eval graph

The labels for +/-1 and +/-3 are now also written, provided there is
enough space.

2011-07-09 13:28:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Improve Eval Graph  with -evalZoom and -evalThreshold

The score range between -1 and +1 can now be blown up by a factor
specified through -evalZoom. The threshold below which histogram bars
are no longer printed (wich used to e hard-coded 25 centi-Pawn) can now
be set through the -evalThreshold option.

2011-07-09 13:18:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Print reversible plies done in stead of plies to go

Printing the number of plies left to the draw-adjudication point was
confusing when the N-move rule was set to a non-standard value.
In stead we now print the number of plies since the last irreversible
move, so the user can compare it to both the engine claim point (100)
and the adjudication point he set (which might be beyond 100).

2011-07-09 13:13:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let WB eval graph react ot single left-click

Unlike in XBoard, the WinBoard eval graph awatys had required double-
clicking to go the the corresponding move, while there really is no
reason for this, as it is no text edit, and single-clicks have no function
(like select).

2011-07-07 19:37:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -scoreWhite option

This is similar to -absoluteAnalysisScores, except that it works in
all modes, and flips the score given by the engines in the engine-output
window when black is to move.

2011-07-07 19:28:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Print 50-move counter in Engine-Output title


2011-07-07 18:50:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Display score/depth in Eval Graph title

No longer print it in the comment window.

2011-07-04 11:06:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let -sweepPromotions also work for click-click moves

A click-click promotion no longer causes auto-queening, but the down-click
on the to-square causes a Queen to stick to the mouse pointer, and then
allows the user to change it through dragging backwards before releasing it
with an up-click.
  In WinBoard this required a slight change in DragPieceBegin, because
the dragged piece there only was made visible when the mouse pointer
actually started moving (and dragInfo.pos was set), presumably under the
assumption that before mouse move the piece was already on the clicked
square. Which in the case of a to-square was of course not true. (Because
a piece jumps to the mouse pointer when the click is not centered on a
square, this gives less jittery static clicks.) So DragPieceBegin has
been given an extra argument now, to indicate whether it should attach
the piece to the mouse pointer immediately.
  To make the click-click sweepPromotions work in Shogi (for which the
drag-drop sweepPromotions could never work, because it is not clear the
piece has a posibility to promote when you pick it up), translation of
the sweep-selected piece to a Shogi promoChar had to e added.

2011-07-04 10:45:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Improve -showTargetSquares on click-click moves

The markers on move targets are now kept when a first click merely
selects a piece, rather than dragging it elsewhere. The second click
(by definition on the to-square) then clears the markers.

2011-07-04 11:23:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let PGN parser accept lower-case piece in drop moves

The @ sign prevents amiguity with other notations anyway.

2011-07-04 12:42:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parser.c line endings


2011-06-29 20:29:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix writing searchTime in tourneyFile

This had to be derived from the variable searchTime, which gives it
in seconds, as appData.searchTime (a string in minutes) is not reliable,
as it contains the command-line value, which might have been altered
through the time-control dialog.

2011-06-29 20:25:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix resetting searchTime if other TC mode is chosen (XB)

This fixes a bug in the new time-control dialog.

2011-06-29 14:32:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix coords display on large boards

The file indicators can now run upto 'w'. Only the lowest digit
of the rank number is printed, from a table that is valid to 22.

2011-06-29 13:53:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on making too-long FEN

The buffer for in PositionToFEN was only 128 bytes, which was not enough
for large boards such as 19x19 Go. It is enlarged to MSG_SIZ(512) now.
There also is some approximate overflow checking added (but it is not
fool proof in case there are holdings...)

2011-06-29 13:36:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix drop moves on boards with more than 10 ranks

The internal encoding for rank 16 is '@', and thus ambiguous with drop
moves. They were always printed as 16, breaking drop games on large
boards. The ambiguity is now solved (for boards with more than 16 ranks)
by checking if the preceeding letter is upper case, in which case it
cannot be a fileindicator, but must be a piece, and thus a drop.

2011-06-29 13:29:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Don't one-click move when legality testing is off


2011-06-23 21:18:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reorder controls in Engine Setings dialog WB

To get tabbing through the controls in left-to-right order, they are
now added to the template structure in that order. Also add a tabstop
to Label options, so that JAWS will read those.

2011-06-23 14:02:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add tab stops in WB generic popup

The WinBoard generic popup did not put tab stops on push buttons,
including the OK and cancel button, with as a consequence that these were
skipped when tabbing through the dialog controls. In addition the tabbing
could not begin before the user selected one of the controls with the mouse.
  Now all buttons have tab stops, and the cancel button is given focus
when the dialog pops up.

2011-03-10 20:06:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Grand Chess

Grand Chess requires a lot of exceptional handling similar to Superchess
and Great Shatran, because it also allows only promotion to a captured
piece. In addition it shares the enlarged promotion zone with Makruk and
Shogi, as well as the fact that promotion can be deferred. The 10-rank
board furthermore required a better generalization of double-pushes and
e.p. captures. On such a board double puhes are now allowed from 2nd and
3rd rank, e.p. capture from 5th and 4th.

2011-01-28 19:20:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow promotion to Pawn with legality testing off

In stead of ImpossibleMove promotionto Pawn now merely is an
IllegalMove, so it can be played with legality testing off.

2011-01-24 15:06:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Create some space in WB New Variant dialog


2011-06-20 23:53:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow double-digit rank numbers

The parser already understood double-digit numbers on input, and
CoordsToAlgebraic produced them on otput. This patch also fixes sending
of the moves to the computer, for which the moveList was used. The latter
stored 10 as ':', etc,to always get a 4-char move, the characters of which
were frequently being converted to fromY or toY by adding/subtracting ONE.
To not break that the one-character encoding of rank number is kept in
moveList, but in SendMoveToProgram, characters > '9' are converted to
double digits.

2011-06-23 11:26:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add Absolute Analysis Scores in Genral Options dialog XB


2011-06-23 11:16:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix texi file, and update it further


2011-06-20 12:15:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Modified po


2011-06-22 17:51:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file


2011-06-22 11:02:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Restore echo after ^C in ICS password


2011-06-22 10:45:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some warnings


2011-06-19 20:30:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Increase efficiency of SAN generation / disambiguation

**************** Risky patch! **********************
The algorithm used for disambiguating and generating SAN was extremely
inefficient, because it generated all pseudo-legal moves from the relevant
position, and then for each of those did a check test (involving generation
of all moves of the opponent), before determining if the move matched the
(proposed or given) SAN move. While it is pointless to generate moves
with a piece that does not match (let alone checking them for legality).
And for a piece that matches, it is pointless to test legality of moves
that do not match the to-square.
  To speed up the process GenLegal and GenPseudoLegal have been equiped
with an argument that can indicate the piece type of the required move,
so they can skip generating moves with other pieces. TestLegality,
Disambiguate and CoordsToAlgebraic make use of this facility, and set also
(through global variables rFilter and fFilter) a to-square filter to be
applied in the GenLegalCallback before it tests the move for legality.
  This patch is especially tricky for Crazyhouse, where the piece indicated
in the move might not be the piece actually on the board, because the latter
is a promoted Pawn, and has to be demoted toits base type before the
comparison.

2011-06-19 16:18:15 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix compile errors WinBoard

The patch to make non-existing options non-fatal broke WinBoard. All calls
to ExitArgError from it now supply a third argument TRUE to fix it.

2011-06-19 14:28:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -fSAN / -sSAN options

These options force the PV of the applicable engine to be converted to SAN.
They make use of the existing ParsePV routine, after shelfing a possible
PV (from user PV walking) to free the space after the last move.
Could be costly in terms of CPU usage.

2011-06-19 10:56:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Cure flicker in Move History window, fix highlighting

The highlighting of the current move in the Move List window by selecting
it did not always work, because some other windows were clearing their text
widgets by selecting the contents and killing it, thus snatching the
selection away. This has been changed to setting XtNstring to an empty
string as a method for clearing without side effects on the selection.
As a bonus the Engine Output window now also no longer has the black flicker
on clearing it.
  In addition, triggering a scroll by setting the insertion point to the
end of the text caused excessive flicker in the Move List window, apparently
clearing it and redrawing from scratch, (even if there was no scroll motion),
to the point where on my slow laptop the move history stayed entirely blank
during a rapid succession of moves. This has been combatted by using the
end-of-line action procedure (which does not seem to suffer from this) to put
the insertion point at the end, when we need to scroll to close to the end.

2011-06-18 23:48:13 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on clearing new Move List window

When a new game started and a previous game had filled the Move List
window, a crash occurred because an attempt was made to undo the
highlighting of a no-longer-existing move, and then scrolling to it.

2011-06-18 20:46:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Use sound for ICS tells also with engine telluser popups

The telluser and tellusererror commands now can be assigned a sound.

2011-06-18 20:45:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add Score in Move List option to general options dialog XB

Now that we have a WinBoard-style Move History window, this option is
no longer a no-op in XBoard.

2011-06-18 12:42:41 -0700 Arun Persaud <arun@nubati.net>:
new developer release


2011-06-18 12:38:32 -0700 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.


2011-06-18 12:51:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update window itle after last game of match

The result printed behind player names during a match would still be the one
without the game, differing from what the popup would show, which looked
sloppy enough for people to complain about it.
.

2011-06-18 10:26:31 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make WB generic popup translatable

When used for internal settings (as in the Load Engine and Tournament
Options dialogs), the option names are now subectto translation.

2011-06-17 21:05:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo Move History with generic popup in WinBoard style

The use of color and boldness to make the move list more readable
unfortunately cannot work in Xaw; reverse video by selection is used as an alternative to highlight the current move.

2011-06-17 21:19:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove stray else

Due to an erroneous else, the window parameters of Move History were
not retreived (and thus incorrectly saved) when the Engine Output was up.

2011-06-14 18:47:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make non-existing opton in settings file non-fatal

It is rather difficult to recover from a situaton where the settings
file contains an unknown option (e.g. because you downgraded to a
previous version that had fewer options), especially in WinBoard, where
the user settings file is in a hidden folder, and people might not be
able to find it, let alone edit it. By just skipping the line with the
offending option, rather than generating a fatal error, when reading
from a settings file, such options will be automatically purged from the
file as soon as you save settings.
  Small problem is that the user cannot be warned, as the initialization
has not progressed far enough at this point to generate error popups. In
XBoard we can at least print to the console, but in WinBoard there is no
warning at all. But the worst thing that can happen is that new options
in a settings file of a more advanced version will revert to their
defaults.

2011-06-14 18:20:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Change long form of -tf option to -tourneyFile

This is a more logical name, and in the WinBoard docs it was already
described as such. Also remove the -processes option, which in the
current design of the tourney manager is no longer used.

2011-06-14 18:17:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix default of -remoteUser

This has to be an empty string, rather than NULL, to prevent XBoard from
segfaulting when the -gateway option is used.

2011-06-14 13:32:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -at and -opt options as alternative for @

Windows XP and Vista shortcuts do not display command lines with @ in
them correctly, and these optionsprovide a work-around for that.

2011-06-14 12:46:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix empty-string option values in XBoard


2011-06-14 12:40:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on switching sound in Vista

When choosing a new sound the wave form of the old one was free'ed, but
because built-in sounds are not really malloc'ed, this led to a crash.

2011-06-14 12:36:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update WB docs for tourney manager


2011-06-14 12:35:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add icon to WB for tournament files


2011-06-10 16:52:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo Time Control dialog with generic popup

As poor-man's disabling of the unneeded input fields, we print the word
"Unused" in them.

2011-06-10 14:14:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Some refactoring in xoptions.c to separate out front-end


2011-06-10 12:38:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo New Shuffle Game dialog with generic popup

The buttons are slightly renamed, and in stead of having an 'off'
button to clear it, shuffleOpenings now has its own checkbox, which is
ticked when a fixed or dynamic random is chosen with the buttons.

2011-06-10 11:58:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix type of shuffleOpenings

This was a Boolean option, and thus accessed by the args.h code as such,
while it was declared as an int (and used in backend.c as such). This
could have led to problems with different endianness.

2011-06-09 23:57:43 -0700 Tim Mann <tim@tim-mann.org>:
Internationalize the file browser.

The file browser was missed in the previous round of
internationalization and had gotten broken by setting international =
True in its widgets.  I got nothing but segfaults trying to set
international to False in the file browser widget subtree when it was
True in the main window, so I gave up and did the
internationalization.  It turned out to be pretty easy.

As a tiny bonus fix, I removed some ../'s from includes, and you can
now configure and build xboard in a subdirectory again.  This was
useful for building both --enable-nls and --disable-nls from the same
sources to compare functionality and make sure both still work.

2011-06-08 20:26:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash at end of Swiss tourney


2011-06-08 17:33:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix display of logos

The logo files are now sought relative to the WinBoard install
directory. Non-existing logos cause clearing of the logo, rather than
letting the logo of the prevous engine hang. Logo change is requested
explicitly from the back-end (when an engine is initialized for a new
game), rather than using the kludge in StartChileProcess. This required
a dummy UpdateLogos routine in the XBoard front-end.

2011-06-08 18:02:31 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parameter handling in adapter command

A backslash was not considered the end of an option name, which was
fatal for UCCI2WB, which needs %fd\\%fcp in its command line.

2011-06-08 17:16:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Clear Engine-Output pane when initializing engine

This to prevent output from the previous game hanging there during the
next game, when the engine that is really playing is in book and
doesn't produce thinking output there.

2011-06-08 17:20:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix display of last move of last match game

When a game was adjudicated (e.g. because XBoard detected mate) GameEnds
would trigger an exit if it was the last game of the match, and thus
never returned, while the ShowMove was called only after return from
Adjudicate. An extra ToNrEvent is now used in GameEnd in this case to
cause ShowMove to be called before exiting. (Ugly kludge...)

2011-06-08 17:38:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix concurrency in Swiss tourneys

The pairing engine was consulted for the next round before all games of
the previous round were finished, if other XBoard instances were still
playing games. This caused the instances finishing early to stall
indefinitely. This is fixed by moving the Swiss pairing code to after
the syncInterval code. The normal pairing code (the call to Pairing)
must stay before it, because it determines the syncInterval. So ther is
a bit of tourneyType dependence cluttering up the code here. :-(

2011-06-08 17:27:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Give error popup when pairing engine fails

An invalid pairing now produces an error popup to inform the user, so he
knows why the tourney stagnates.

2011-06-08 17:24:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix clock mode in tourney starting from -ncp mode

When a tourney started from -ncp mode, which was allowed in MatchEvent,
because the tourney loads its own engines anyway, the menu enablings and
clockmode where not restored to their 'GNUMode' state.

2011-06-08 17:11:31 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix round-robin schedule

The first round was played twice, and the formulas used to derive the
pairing were not even-odd resistant anyway. Both even and odd number of
participants should work now.

2011-06-08 17:08:55 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix interrupting tournament

Stopping a tourney by using the Machine Match menu item did not wor
properly.

2011-06-08 16:57:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Improve quoting of engine name on install

Rather than always using double quotes for the engine command, the
engine filename is now double-quoted if it contains spaces (and no
double-quotes), and the comand is single-quoted if it contains
double-quotes (and double-quoted otherwise).

2011-06-08 16:49:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Print sensible window title during tourneys

Rather than the "(W-L-D)" in the title we now print game number and
total games, plus indication of the tourney type (rr, gt or sw).

2011-06-08 16:44:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let XBoard propose name of tourney file

Add an option -defaultTourneyName to configure the name that will be
proposed in the Tournament Options dialog's tournament-file field. The
option can contain %y, %M, %d, %h, %m, %s for year, month, day, hour,
mintes, seconds of the curret time in %02d format, or %Y for the year in
%04d format. Any tournament -file name is ignored when no participants
are given. Participants without a tourney file remains an error.

2011-06-08 16:30:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Improve Tournament dialog layout WB


2011-06-08 17:05:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix -matchGames option

The new MatchEvent code had broken the -mg option, and used always
-defaultMatchGames in stead.

2011-05-30 19:55:13 -0700 Tim Mann <tim@tim-mann.org>:
Fixed small bugs in several .po files, enabling these translations to be used.  They all probably need more work from the translation team. I don't speak any of these languages, but I did some spot checks either from my own knowledge or using Google Translate, and they generally look sane.

- Several files were in utf8 but needed to be marked as such (that is,
  "CHARSET" changed to "UTF-8").  Affected es.po, it.po, ru.po, vi.po,
  zh_CN.po, zh_TW.po.

- it.po was missing a \n at the end of one translation.

- ru.po had unescaped double-quote marks in one translation.

- vi.po needed to be normalized to Unicode normalization form C.  With
  this fix, more characters display correctly, though at least one is
  still missing in the X core fonts that xboard is able to use.
  See http://vietunicode.sourceforge.net/ for more about Vietnamese.

- zh_HK.po was written in big5 and then utf8-encoded on top of that,
  making it unusable.  I stripped off the spurious utf8 encoding and
  then used recode to convert the file to Unicode properly encoded as
  utf8.

Unfortunately, I wasn't able to test any of the Chinese translations,
as I haven't been able to get XCreateFontSet to work in Chinese
locales with any of the fonts I have installed, even after adding the
Ubuntu language support packages for both simplified and traditional
Chinese.  I did spot check a bunch of the translations using Google
Translate.

I've checked in a couple of tiny Perl scripts that I used to do part
of the fixups on vi.po and zh_HK.po in case we need them again.

2011-05-30 14:12:53 -0700 Tim Mann <tim@tim-mann.org>:
The empty string can't be translated and it causes the gettext utilities to complain, so change _("") to "".


2011-05-30 13:21:06 -0700 Tim Mann <tim@tim-mann.org>:
Add a final wildcard default for fonts.  This gives XCreateFontSet more freedom and lets it find fonts for some obscure charsets where fixed-bold or fixed-medium etc. may not have one.


2011-05-29 20:14:37 -0700 Tim Mann <tim@tim-mann.org>:
Added "misc-fixed" as a fallback font to handle locales where adobe-helvetica does not have all the required characters.  The fixed font is ugly but does have a rather complete set of characters, while the helvetica font is missing Cyrillic characters (at least on my distro).  I haven't found a way to get a nicer font that includes Cyrillic to work with XCreateFontSet, but I don't fully understand why.  I'll try to improve things further in the future if I figure out what's all going wrong.

In the process I had to rewrite the code to insert the pixel size into
a font name (replacing a "*" in that field).  The new code is much
more general.

2011-05-28 23:55:42 -0700 Arun Persaud <arun@nubati.net>:
translation: activated Ukrainian translation


2011-05-28 23:41:24 -0700 Arun Persaud <arun@nubati.net>:
translation: added new Ukrainian PO file from the TP


2011-05-28 21:07:08 -0700 Tim Mann <tim@tim-mann.org>:
Fix display of international characters outside the ASCII range.

1) Set Xaw resources required for internationalization --
   *international and *fontSet.

2) Untangle the new XFontSet-aware code from the old FindFont code.
   It doesn't make any sense to apply the old (and obsolete) size
   searching code from FindFont to a font set, which contains fonts
   that are all the requested size.

3) With these changes, the -font option doesn't work at all when given
   on the command line.  The -font option actually is parsed by the Xt
   library, used to set the *font resource, and removed from argv
   before xboard can see it, so the option didn't really work properly
   with the new WinBoard-style option framework anyway.  Now that
   -font is even more broken, I changed the documented name of the
   option to -messageFont and changed args.h so the option is saved in
   ~/.xboard as -messageFont.

2011-05-28 21:05:00 -0700 Tim Mann <tim@tim-mann.org>:
Move "hide thinking" option into alphabetical order.


2011-05-28 21:01:25 -0700 Tim Mann <tim@tim-mann.org>:
Fix a size mismatch in scanf.  Untested, but the code could not have worked properly without this fix -- scanf would have written 32-bit values to 16-bit fields, thus smashing adjacent memory.


2011-05-23 19:05:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix layout tournament Load Engine dialog WB


2011-05-23 19:03:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ArgTwo warnings


2011-05-23 19:00:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add Swiss tourneys through pairing engine

An external program can be designated pairing engine through the new
persistent option -pairingEngine. Defining the option will allow
tourneytype -1 to be chosen for Swiss. In this case the pairing engine
will be queried for a pairing before every new match game, by sending it
the -results string, plus the command 'pairing' + game number.

2011-05-23 17:37:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow generic dialog to ignore OK

The EndMark callback can now suppress popdown of the dialog on OK, when
it somehow does not like the values entered by the user. In XBoard this
required all the callbacks to return a value.
Caveat: A refused OK would still have set all new values given in the
dialog!

2011-05-23 17:22:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix CR in multi-line WinBoard text-edits

The generic popup did not add CR when strings containing '\n' were
printed in a multi-line text-edit, thus joining the lines. It was also
not possible to type a CR in a multi-line text-edit.

2011-05-23 14:16:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let mentioning completed tourney file add one cycle

Secifying a tourney file of a fully completed tourney will now resume
that tourney with another cycle added. When there are still uncomleted
games in the tourney, the usual error message will appear. There are
also error popups added for when the user fails to specify a tourney
file, or gives too few participants.

2011-05-16 11:02:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make engine startup failure non-fatal in WinBoard

Unlike XBoard, which forks first, the parent process WinBoard has direct
knowledge of a failure to execute the engine command, and used it to
trigger a fatal error. The code doing this has now been disabled. Only
in case of a first engine we switch back to -ncp mode in stead, but no
action is taken to 'bury' the deceased engine process. Like in XBoard,
errors in writing or reading the pipes will trigger this.

2011-05-14 17:03:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add secondry adapter command for UCCI or USI

The option -uxiAdapter can define a second adapterCommand, which will be
invoked on encountering the options -fUCCI, -sUCCI and -fUSI, sUCI.

2011-05-14 10:05:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Obey san feature when sending book moves

Book moves were always sent in long algebraic, even when the engine had
said it wanted to receive SAN.

2011-05-14 10:03:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix initialization of engine state

Some of the initialization relied on variables being zero at startup,
which meant value from the previouly loaded engine hng on after loading
a new one.

2011-05-11 23:06:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Take account of holdings in book key

The board is numbered by rank, for comptibility with Polyglot format,
starting at a1. We then continue counting in the holdings 'files', in
up-rank direction, each holding spanning the full board height (even if
it is not fully used). Firstthe left (black) holdings, then the right,
Even in Shogi this limits the square number to < 99, which is below the
absolute limit of 128 (where we would run out of hash keys).

2011-05-11 22:48:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Alow promotions and drops in book-editing


2011-05-11 20:15:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Include learn info in book edit


2011-05-09 21:55:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt default directory of lng2po

The path is prefixed with "../" to make it runable from the po directory.

2011-05-09 21:20:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Recode some po files

po files were generated with the aid of lng2po for Russian,
Vietnamese, Chinese(simp) and Chinese(trad), using encodings CP1251,
CP1258, GB2312 and BIG5, respectively.

2011-05-09 20:11:32 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Edit Book in XBoard


2011-05-09 09:52:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Improve WB Load Engine dialog texts


2011-05-09 09:48:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make 'add to list' default in Load Engine dialog


2011-05-09 09:33:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -userFileDirectory option

This volatile option is initialized from 'installDir'. It is
primarily intended for configuration of WinBoard through its master
settings file, and specifies an alternative place to create saveGameFile
or look for other user files, in stead of looking in the installDir.

2011-05-09 09:10:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add option -absoluteAnalysisScores

This persistent option flips scores in the when black is thinking in
analysis mode, just before they are printed in the engine-output window.

2011-05-08 17:47:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Automatically play moves of clicked PV in analyze mode

The Shift key now no longer needs to be pressed to play moves from the
PV in analyze mode (so it could be given back its original meaning of
starting a variation with the entered moves). In analyze mode the PV
walk begins after the first move, so a static right-click plays the
first PV move. To just peek the PV you have to walk to the start of it
before releasing the mouse button. In other modes the PV walk
stillstarts at the very end.

2011-05-08 17:07:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let ParsePV always generate SAN move


2011-05-08 13:53:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix vscrolling in XBoard Engine-Output window

After clicking the memos they scrolled to the bottom, because SetFocus
put the insertion point at the very end of the text. This behavior is
now reserved for text-edits containing less than 100 characters.

2011-05-08 13:22:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix button sizing in generic popup


2011-05-08 13:02:52 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow changing MultiPV setting from Engine-Output window

In analyze mode a header line is printed in the first engine-output
pane, which can be right-clicked to increase or decrease the number of
PVs. (Only with engines that support the MultiPV option.)

2011-05-08 11:28:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
No clearing of Engine-Output memos on stat01


2011-05-07 23:27:50 -0700 Arun Persaud <arun@nubati.net>:
updated xboard.pot with released version


2011-05-07 22:56:53 -0700 Arun Persaud <arun@nubati.net>:
new developer release


2011-05-07 22:54:29 -0700 Arun Persaud <arun@nubati.net>:
updated ChangeLog, NEWS, etc.


2011-05-07 23:07:46 -0700 Arun Persaud <arun@nubati.net>:
deactivated new languages for the moment...

po files need some cleanup, probably better to wait until the translation-project looked at them

2011-05-07 18:44:24 -0700 Arun Persaud <arun@nubati.net>:
added translations generated via lng2po from all winboard languages


2011-05-07 18:40:23 -0700 Arun Persaud <arun@nubati.net>:
lng2po.sh: added command line options, GPL header

also use a temporary file generated with mktemp instead of a hard coded one

2011-05-07 17:53:10 -0700 Arun Persaud <arun@nubati.net>:
fixed access rights to winboard language files (644 instead of 655)


2011-05-07 14:55:55 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Import WinBoard language files into git


2011-05-06 23:14:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let Shift+RightClick on PV actually play the PV moves


2011-05-06 18:06:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make book-edit function WB

The tags dialog is used to display the GUI book moves from the current
position, and will be updated when you step or move to another one.
The edited move list (with weights) can be written back to the book.

2011-05-07 16:21:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix resetting engine options

Not all options were reset, and -needsNonCompliantFEN was 'reset'
to a completely wrong value, so that bad FENs would be sent.

2011-05-06 18:51:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -first/secondPgnName option

This option replaces the tidy name of the engine in the PGN player tags
of engine-engine games. In WinBoard engines can be installed with this
option through a checkbox in the Load Engine dialog.

2011-05-06 23:31:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let XB generic popup define default file extensions


2011-05-06 18:25:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Save time-control settings in tourney file

Because parsing the options and storing them in appData is not enough,
the time-control code setting the internally used parameters from the
appData info in InitBackend was made into a subroutine, and also caled
after parsing the tourney file.

2011-05-06 20:40:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Put saveGameFile in tournament dialog


2011-05-06 19:17:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Plug memory leak, filenames relative to installDir

String options are consistently freed now, before assigning a new value
to them through strdup. The init code now even does use strdup when
setting defaults. This is important for optionslike -lgf, which are not
saved in the settings file, and thus are usually left with their
default. When a dialog to set them then uses free, this causes a crash.
When setting the defaults uses strdup, ParseArgs can already free them.
This plugs an important memory leak, as ParseArgs in now called to parse
the tourney file before every tourney game (twice!), and the lists of
participants and results in it can be quite long.  Macros are defined in
common.h to make the code look simpler.
  Filenames entered through the generic popup are now interpreted
relative to the WinBoard installation folder, just as the saveGameFile
already was. The code handling the atter was made into a subroutine for
this.

2011-05-06 22:02:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add WB new popup prototypes


2011-05-06 18:58:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add partcipants at bottom in tourney dialog (WB)


2011-05-06 18:56:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix range of tourneyType spin WB


2011-05-06 18:15:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix exit popup in tourney mode

Only the instance finishing the last tourney game will cause a popup
with final standings. As long as there are still busy games, it exits or
switches back to idle mode silently.

2011-05-06 18:11:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix stopping of match in tourney mode


2011-05-06 18:59:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add default extension in file browser


2011-05-06 22:37:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Improve sizing of comment and tags dialogs

There seems to be a bug in Xaw for the sizing of buttons; they get
unpredicatble and weird sizes when the size is not explicitly set,
possibly stretching the initial width of a dialog to rediculous values.
Sizing back to a remembered value from the settings file then makes
buttons overlapand text edits shrink to almost nothing. To prevent that
we now define exlicit sizes for the buttons in tags and comment popups.

2011-05-06 21:00:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix generic combobox bug

The patch placing gettext markers was done wrong, setting the
translated menu text outside the loop, so all entries became the same.

2011-05-07 14:23:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix PV walking in analysis mode

ParsePV assumed that the PV would always have been produced by an engin
thinking about the final position of the game (or the one before it). In
analysismode, however, the engine can be analysing positions internal to
the game, and the PV would be considered invalid. This is fixed by
cutting of the tail off the game (shelving it in variation fashion)
before starting the PV walk, and reverting afterwards.
  For this the PushTail and PopTail routines had to be split into an
'inner' part, doing the pushing and popping, and an outer part, handling
menu graying and popdowns (which is undesirable in in this application).

2011-05-03 00:24:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Lift length-limit on text-edits in WB generic popup


2011-05-04 13:53:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Lift limitation of text length in generic dialog XB

All string options should now point to allocated memory, as strdup /
free is consistently used on them. This is OK for values received from
ParseArgs, but for non-arg intermediate variables that must receive strg
values, such as in the comment and tags popups, strdup has to be used to
initialize those.

2011-05-04 14:53:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Tournament Options dialog WinBoard

The file browser now can select on extension WB generic dialogs,
with a default based on the option.max value of the option for which it
browses. A textBox can be forced to be multiline by putting the number
of extra lines in option.min.

2011-05-04 15:30:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make option to draw second engine from first list


2011-05-03 00:17:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix error message on engine load


2011-05-04 15:09:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Load Engine dialog in WinBoard

The Load Engine dialog is implemented for WinBoard, and is invoked by
the menu item Engine->Load, which formerly was Install 2nd. Install 1st
is renamed 'Edit Engine List'. Unlike in XBoard, the dialog has separate
fields for the engine executale and its parameters.
  The dialog is implemented by converting the Engine Settings popup into
a generic dialog generator.

2011-05-04 13:43:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Load new logo on engine change WinBoard

Picking the logo for the first engine is made into a subroutine. The
code for picking the logo of the first engine was made into a subrroutne
for this. We use the kludge to recognize the engine by its command line
when starting a new engine process.

2011-05-04 13:36:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow switching off match mode through menu

The Machine Match menu item is now checkmarked, and no longer grayed
during a match, and clicking it while a match is running will terminate
the match after the current game. To not be left with hanging
checkmarks, the checkmark is already removed duringthe last match game
(which is logically equivalent to ordinary Two Machines mode anyway).

2011-05-03 00:14:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Calculate and display tourney result


2011-05-04 18:42:13 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Tournament Manager

New command-line options are added to specify the tourney: -tourneyType
(-tt), -tourneyCycles (-cy), -participants, -syncAfterRound,
-syncAfterCycle, -results, to be saved on a -tourneyFile (-tf), but
otherwise volatile. When a tourneyFile is specified during a match,
a new routine NextTourneyGame is called from NextMatchGame before every
game, to decide the pairing, and unload and redefine the engines, when
needed. The XBoard Match Options dialog can be used to set the options
and create the tournament file.
  Actual loading of new engines is done by TwoMachinesEvent, which is
now modified to also wait for the feature timeout of the first engine.
Waiting for the matchPause is now also implemented there, after waiting
for the engines (so they can be started during the pause).
  Pairings and color assignment is now all done in an absolute
(non-incremental) way, based on a new global game-number variable
nextGame, which takes over the function of matchGame in a tourney. The
latter is now used to count games between the same players, so it can be
still used to derive the load-file indexes (again in absolute fashion).
  The next game to play is already picked in GameEnd, so it can be
decided if there is a game to be scheduled, or if we can terminate.

2011-05-04 15:42:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Display note in stead of empty engine-settings dialog XB


2011-04-24 18:02:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on empty Engine Settings dialog

The generic popup was not foolproof against this.

2011-04-22 12:47:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Refactor code for loading games and positions in match

The code in NextMatchGame and MatchEvent was nearly the same,
(MatchEvent did a little more error checking, but that is never
harmful), and could be combined. In stead of determining the load index
incrementally, it is now calculated in an absolute way from the game
number, so it can be used more easily in tournament mode.

2011-04-21 22:37:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add callback possibility to combobox selection


2011-04-24 17:15:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Lock game an position file during writing

The use of flock() on the file desctiptor of the opened stream should
guarantee multiple XBoard instances, saving on the same file, will not
interleave their PGN games or FEN positions.

2011-04-27 17:05:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove building rule for parser.c from WB makefiles


2011-04-29 16:58:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Engine Settings buttons in WinBoard

This was broken by a leftover statement from debugging the -file/-path
patch.

2011-05-02 13:38:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement flock in WinBoard

This system function seems unknown in a MinGW compile, so it is
implemented with the aid of file byte-range locking, using a lock on the
first 1024 bytes of the file as a semaphore.

2011-04-29 23:06:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix grayout XB Match Options in ICS mode


2011-05-03 00:22:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Delay loading of second engine until it is used


2011-05-02 15:00:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix zippy bughouse partner bug

The patchs to subject Zippy messages to coloriation was faulty, because
there were messages recognized by zippy that were not colorized, and
such messages would then not be 'read away' after zippy recognition
(except for the first character). As a result the messages were
processed over and over again.

2011-05-04 10:59:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Silence more rpm warnings


2011-05-01 20:33:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix warnings XBoard file browser

All the prototypes have been moved to selfile.h, to force uniformity.
The order of the #include files xstat.h and selfile.h had to be
swapped, to make sure 'struct stat' is a nown type atthe time of
prototype declaration. The event handler SFmotionList is considered
wrong type because of its third argument (XMotionEvent in stead of
XEvent), and had to be casted to (XtEventHandler) when passed to
XtAddEventHandler.

2011-05-04 10:56:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some warnings and header-file improvement

Ther were lot of 'extern' declarations in the x-files, so called
'imports from xboard.c', (sometimes backend.c) which logically belonged
in xboard.h (backend.h) to ensure their uniform definition. These have
now been moved there. Some prototypes have been added in xboard.h as
well, for functions that needed calling from xoptions.c.

2011-05-04 10:50:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Create conversion tools for language files

A shell script "lng2po.sh" is provided, to apply the translation given
in a WinBoard .lng file to "xboard.pot", in order to generate a
"language.po" file containing translations for all strings for which
the .lng file had a translation. It makes use of a file "metascript",
which is the ed script used to turn the .lng file in an ed script to
turn the .pot into .po. For example, the command "./lng2po.sh
espa?ol.lng" will create a file "language.po", which can be renamed to
"es.po".
****************************** WARNING ********************************
  Note that the lng2po script does a "recode" that assumes the given
.lng file is encoded in latin-1. This means it canot be used without
modification for the Vietnamese and Chinese translation; you would have
to replace latin-1 by the applicable encoding first (CP1258 / BG2312 /
BIG5).

2011-04-27 22:04:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Put gettext markers in generic dialog creator

This is done by adding extra XtNstring argumentsto the widget gcreaton,
so the displayed name can be different fromthe widget name.

2011-05-01 19:56:38 -0700 Tim Mann <tim@tim-mann.org>:
Use getaddrinfo instead of gethostbyname.  Hopefully this makes us compatible with IPv6 and with hosts that have more than one IP address.  However, I don't know of any chess servers that have either of those properties, so I couldn't test that.  I did test that xboard still works with freechess.org and chessclub.com and that it gives an error message for invalid host names.


2011-04-24 11:18:28 -0700 Arun Persaud <arun@nubati.net>:
updated German translation


2011-04-24 11:17:43 -0700 Arun Persaud <arun@nubati.net>:
replaced hardcoded email address with generic PACKAGE_BUGREPORT


2011-04-23 10:51:57 -0700 Arun Persaud <arun@nubati.net>:
updated po-files; updated german translation


2011-04-23 10:51:02 -0700 Arun Persaud <arun@nubati.net>:
updated list of files that include translation strings; updated pot-file


2011-04-22 21:50:58 -0700 Arun Persaud <arun@nubati.net>:
marked more strings for gettext that were only marked with N_()

they need to be marked again with _() when they are used to get the translated string

2011-04-22 21:39:22 -0700 Arun Persaud <arun@nubati.net>:
updated translation files


2011-04-22 21:37:22 -0700 Arun Persaud <arun@nubati.net>:
added/fixed i18n support via gettext to xboard

this was already added a long time ago, but now it's added again to
autoconf. Also fixed some compile errors that showed up.

2011-04-20 10:27:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make engine startup error non-fatal

When engine startup fails, do not generate a fatal error, but swicth
back to -ncp mode. Write on broken pipe errors had to be suppressed for
this.

2011-04-20 14:35:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make engine loadable during session

A "Load Engine ..." menu item is added to the Engine menu, which pops
up a dialog where one can replace the first or second engine by a new
one, without destroying the game state. Switching from -ncp to engine
mode needed activation of some menu items in SetGNUMode, and
re-enabling clockMode. It was also important that noChessProgram is
cleared before re-initializing the ChessProgramState.
  The Load-Engine dialog can select from the list of installed
engines, and also add a newly specified engine to this list. In this
case it saves the directory, hasBook, and isUCI info with the engine,
and optionally the current variant. When loading an engine with a
specified variant, it resets the game and switches to the new variant.

2011-04-18 15:56:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Generalize WaitForSecond to WaitForEngine


2011-04-18 15:46:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add UnloadEngine routine


2011-04-20 13:45:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Put engine initialization code in per-engine function

Initializing of the ChessProgramStates first and second from the
option settings in appData is now done by separate calls to the same
routine. Clearing of options is added to the initialization. This is
needed when reloading an engine. This is done in a separate routine,
which could also be called on -reset options.

2011-04-18 13:21:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Bring structure in appData engine options

All options in appData that came in pairs for both engines are replaced
by arrays of ENGINES (=2, for now) elements. The use of the named
appData field that are replaced in the source is replaced by use of the
corresponding array element, by #define directives in common.h, awaiting
their replacement.

2011-04-19 15:15:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix gettext macros in option dialogs

The strings in the tables were using _() in stead of N_().

2011-04-18 20:58:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on using Engine #1 Settings in ICS non-zippy mode

If XBoard is compiled with zippy the Engine #1 Settings menu was not
grayed out even when you don't run in zippy mode, and using it would
then crash XBoard.

2011-04-19 15:07:31 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix shogipixmaps

Some pixmaps forptomoted pieces had wrong background color, others had a
wrong name (so the one with the correct name was missing).

2011-04-17 19:12:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Change texture-install directory to pixmaps/textures


2011-04-17 17:36:32 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Limit install of sound files to those in menu

The sounds directory is set to .../xboard/sounds, and only ten
sounds are kept (all non-spoken).

2011-04-17 17:27:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove some bitmaps from install

Some files in the bitmaps source directory need not be installed,
because they are there only to be linked to the binary in a build
without LIBXPM, are README files or conversion programs. I left only the
stuff that is in a Debian binary package in .../xboard/bitmaps.xchess.

2011-04-17 16:34:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Configure some default sounds

The move sound is set to Wood Thunk; the sounds for tell and challenge
events to Phone and Gong, respectively.

2011-04-17 16:17:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Change default sounds in Xboard menu

All spoken sounds are removed now. Thud, Click and Ching are replaced by
Wood Thunk, Slap and Cymbal; Car Horn and Pop are added.

2011-04-17 12:46:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make user wav file available for try-out in sound dialog

The GenericReadout was adapted to be able to read a single selected
value, so that the callback to the 'play' button in the sounds dialog
could get the name of the 'user WAV file' without accepting all settings
for the other sounds (which should only happen on 'OK', and might still
be cancelled in stead).

2011-04-16 10:36:31 -0700 Arun Persaud <apersaud@lbl.gov>:
configure: enable silent rules by default


2011-04-16 10:28:16 -0700 Arun Persaud <apersaud@lbl.gov>:
configure: added install directory for bitmaps files: .../games/xboard/bitmaps/default/


2011-04-16 10:25:33 -0700 Arun Persaud <apersaud@lbl.gov>:
configure: added install of sounds in .../games/xboard/sounds/default


2011-04-16 09:54:26 -0700 Arun Persaud <apersaud@lbl.gov>:
configure: renamed bitmapdir to pixmapsdir, since it installed only pixmaps. also changed name of default dir

pixmaps will now be installed under .../games/xboard/pixmaps/default/

2011-04-16 13:40:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix gamelist highlight

Reopening the gamelist should highlight the current game.

2011-04-16 10:25:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix size limit on 'save as diagram'

In stead of a fixed-size buffer the diagram-save code now uses an
allocated buffer with size calculated from the bitmap parameters to
retreive the bitmap data, so it should work for all sizes.

2011-04-15 22:04:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix chaining of bottom-row dialog buttons

The OK & cancel buttons are chained to the bottom. This patch makes sure
that other buttons appearing in the same row (as in the tags and
comment dialogs) will be chained that way too, so that they will behave
the same on vertical sizing. The bottom of a full-width text-edit above
it will be chained to bottom too. To make this work in the tags dialog,
the (optional) cmail-message field had to be put above the tags memo.

2011-04-15 19:18:46 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix switching between pixmap and bitmap pieces

There were still several flags that had to be reset when redoing the
graphics initialization. The Debian patch to use a default bitmap
directory when none is given but monoMode is selected or forced, is
moved to a more sensible place, so that it does not disturb matters when
compiled without LIBXPM (when we do have built-in bitmaps).

2011-04-15 15:47:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove outline-pieces option from board-options dialog

This option does not exist in XBoard (yet).

2011-04-15 15:41:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix running of clock during hash allocation engine

In TwoMachinesEvent we now wait for the second engine to acknowledge the
'ping' after 'new', to make sure it is done allocating hash in reaction
to the preceding 'memory' command, before the clock for the game is
started.

2011-04-14 21:42:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Describe move type-in in texi file


2011-04-14 20:34:42 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Describe Copy Game List menu item in texi file


2011-04-14 20:30:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Describe -sweepPromotions in texi file

The new method for selection promotion piece, and the -sweepPromotions
option are described in the texi file.

2011-04-14 20:14:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Describe -pieceMenu option in texi file

The sweep method for selecting a piece in Edit-Position mode is
explained, as well as the -pieceMenu option.

2011-04-14 15:59:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file

Descriptions of the new XBoard menu dialogs are included in the docs.

2011-04-14 21:06:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reorganize texi description


2011-04-14 12:31:15 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix sweep-promotions patch

Setting of the from square was moved to before OKtoStartUserMove in the
LeftClick handler, to make sure we could test the promotion possiblity
when OnlyMove() would have altered (x,y) to be no longer the from
square. But this setting of fromX, fromY hung on also if the move was
not OK, so you could effectively select opponent pieces and empty
squares. The from-square is now set back to undefined when it is not OK
to move the piece you clicked.

2011-04-14 11:56:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Alter treatment of moves with empty squares

In Edit Position mode one can move empty squares, and use them to
'capture' pieces as a means to clear their square. But this often leads
to unintended disappearence of pieces one wants to grab for dragging, if
a previous click had inadvertantly left an empty square selected: the
click on the piece is then seen as the to-click of a click-click move.
  This patch treats to-clicks of moves with an empty-square differently
from other to-clicks: Rather than performing the move (in this case
clearing of the to-square) on the down-click, it defers that to the
up-click, and only does it if that up-click is in the same square. This
allows the user to grab the piece on the down-click, and drag it to
another square, if that is what he wanted to do, without being disturbed
by sudden implosion of the piece he tried to grab.
  If the to-square is in the holdings, grabbing the piece is the only
action, as moves of empty squares into the holdings are forbidden anyway.

2011-04-13 13:14:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Block selection of a directory when file is needed

When we are not browsing merely to obtain a name to put in a text edit,
but really must return an open file pointer, selection of a directory
(ending in '/') can no longer be OK'ed in the file browser. (XBoard
tends to segfault when offered garbage for game or position file...)

2011-04-13 12:23:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let double-click select file in file browser

A second click on the already selected entry now has the same effect as
pressing the OK button.

2011-04-12 17:06:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Couple mouse wheel to v-scrolls in file browser

A newly added mouse-wheel event handler was made to call the v-scroll
callback routines with parameters to step one entry. The button-press
handler for the lists themselves was also made to intercept the wheel
events (buttons 4 and 5), to prevent they would select an entry, and
make them scroll in stead as well.

2011-04-13 11:41:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash copying game list when there is none


2011-04-13 11:15:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix changing of float setting by generic popup

Changing a float setting (so far the only one is in the Load Options
dalog) did not always work, because the old value was clipped to (int),
so that changing it back to an integer value might erroneously conclude
there was no change.

2011-04-13 16:15:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on closing dialogs in wrong order

When a menu dialog was closed when it still had an open file-browse
daughter, which could be done through the system menu X on the title
bar, later closing of the file browser caused a crash. This is solved by
keeping track of the fact that there is such a daughter through a global
flag, and ignoring the pop-down command if there is one.

2011-04-13 16:33:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix startup focus of board window

When there were open auxiliary windows, these would have focus on
starting up XBoard. The XtSetKeyboardFocus call added in XBoard main()
was ineffective in curing that. It has now been replaced by a call to
XSetInputFocus, which does do the job. By giving input focus to the form
widget, rather than the board widget, XBoard will be immediately
sensitive to all key bindings.

2011-04-13 15:48:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix game-list highight error when filtered (WB)

When the gamelist was filtered, the game that was highlingted was the
n-th game in the list rather than the n-th game in the file, when the
latter was loaded (and n did not exceed the number of filtered games).
This is fixed now by searching for the line in the listbox that starts
with the game number n, rather than taking the n-th line.

2011-04-12 19:20:46 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Refactor move type-in code

Common code between XBoard and WinBoard was moved to the back-end
creating TypeInEvent() and TypeInDoneEvent() routines.

2011-04-12 10:13:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix saving of XBoard fonts with spaces in name

SaveFontArg now prints quotes around the saved font string, so that the
general option-argument parser doesnot stop at the first space it sees.

2011-04-11 20:48:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement move type-in for XBoard

By adding an event handler to the main window for key presses, users can
now type moves when the board has focus, like in WinBoard. The typed
character appears as first character in the type-in box that willpop up.
Enter and Escape close the box; finishing the typing of the move enters
it. Like in WinBoard it is also possible to type a move number (to go
there) or (in Edit Position mode) a FEN.

2011-04-11 20:59:44 -0700 Arun Persaud <apersaud@lbl.gov>:
new developer release

tried to keep the v4.5.x branch developed already separated in the NEWS file, as well as DIFFSTAT and SHORTLOG.
The Changelog is just the one from master.

2011-04-10 22:47:59 -0700 Arun Persaud <apersaud@lbl.gov>:
updated Changelog, NEWS, etc.


2011-04-10 20:32:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix use of game/position file in first match game

When a match was started from the menu, it was not paying attention to
game and position files. (Later games were.) The code that handled this
in the initialization when a match is started through the command line
was made into a routine MatchEvent, which can be called from the menu
proc too.

2011-04-09 20:55:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on opening ICS Text Menu

The patch for the color defaults had broken the ICS Text Menu.

2011-04-09 19:22:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Copy Game List menu item for XBoard

Some WinBoard code was cloned for this.

2011-04-09 11:42:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Third method of sweep selection

This method sweeps through the possible promotion choices for the piece
that is being dragged, as long as you drag a 7th-rank Pawn backwards. On
draggin such a Pawn forwards, it immediately shows it as the piece you
are going to promote to.

2011-04-08 23:39:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Alternative sweep promotions

The sweep takes place on the from-square here.

2011-04-07 23:21:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make sweep-select promotions work in WinBoard

The mouse-move handler had to be connected to the PromoScroll back-end
routine.

2011-04-07 23:19:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix path browsing in WinBoard

The routine BrowseForFolder was still declared as static in woptions.c,
while it was used from wsettings.c.

2011-04-07 11:14:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fixes to sweep selection


2011-04-06 23:47:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement sweep selection of promotion piece

When the option -sweepPromotions is true, a click-click promotion move
will first display the default choice (usually Queen) on the promotion
square. While you have the mouse button still down, you can change the
piece by moving the mouse vertically.

2011-04-06 21:20:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement sweep selection as alternative for the piece menu

When the option -pieceMenu is off, the piece menu will no longer appear
on right-clicks in Edit Position mode. In stead a Pawn of the chosen
color will appear immediately in the clicked square, and vertical
movement of the mouse with the right button down will cycle through
all other pieces defined in the pieceToCharTable of the current variant.
  Setting the side to move is acheived by clicking the correspondig
clock. Clear board can be effected by clicking the clock of the side
that already has the move.

2011-03-30 18:17:58 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remember Tags and Comment dialog coordinates

The save-settings code now uses the shell and shellUp arrays from the
GenericPopUp to read out the window coordinates for Tags and Comment
window. Pointers used by GenericPopUp are set topoint to the
corresponding WindowPlacement structs.

2011-03-10 19:21:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo Tags dialog

The generic popup is used for generating the Tags / EditTags popups.
The tags popup use a 'label' field to display the cmail message

2011-04-01 13:43:52 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Edit-Comment window through generic popup

The Edit Comment and Comment popups are combined into one, that can
always be edited (similar to WinBoard). It uses shell number 1.
(Number 0 is for all transient dialogs.) A save-changes button is added.
The positioning is not implemented yet.

2011-04-06 10:56:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Refinements to generic popup and color picker

*) The text part of a checkbox can now be clicked to toggle the option.
*) Typing <Enter> in single-line text edits is ignored
*) Using a spin button now sets focus to the affected text edit, with
the insert position at the end.
*) Using the sample field or an RGB button sets focus to the
corresponding text edit, with the insert position at the end.
*) The adjust buttons now work in reverse, with a D button for "darker".
*) Editing a color field causes the sample field to update to the new
color when you type <Enter>.
*) The color pickers now define a default color, which can be instated
by clicking on the sample field.
*) Fix some 64-bit pointer warnings

2011-04-05 17:05:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let file browser filter on extension

A new text field is added in the file-browse dialog, to hold (space-
separated) extensions, on which the filenames are then filtered. This
field is initialized by the caller, depending on what we need the file
for, but can be changed by the user. (Directories are always displayed!)
  Changes in the extension field  become effective after typing a return
in it. Escape typed in the extension field gives focus to the filename
field, and restores the contents. Escape in the filename field cancels
the dialog, return ther OKs it. The extension filter of the browser is
initialized to the extension (if any) of the file currently in the text
edit you are browsing for.
  When re-opening the file browser from the XBoard File menu, and there
is no suggested filename, it will now start with the last succesfully
opened name as suggestion. Calling the browser with a NULL argument
for the suggested filename requests that (unlike calling with an empty
string, which will start it in the current directory). To make this
work smoothly, the filebrowser saves the last used name on entry, so it
can be restored on cancel, so that a cancelled browse session really
erases all memory of it.

2011-04-04 19:26:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix animation masks on changing piece pixmaps

The animation masks were not remade when new pieces were loaded
interactively through the board-options dialog.

2011-04-04 19:09:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix linegap option in board dialog

The lineGC was not recalculated, so the grid lines stayed the same
thickness. In addition, setting the line-gap override to -1 now
retrieves the original line gap that belongs to the current board size.

2011-03-05 23:27:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make a kind of ICS text menu in XBoard as a dialog

The dialog with buttons can be opened from the View menu. It is
configured by the option -icsMenu; a default setting for this is
included in the master settings file.
  The commands specified by the -icsMenu can now contain $name and $input
keywords, which will be replaced by the current primary selection, or
text the user types, respectively. Commands that contain $name will not
be sent when the current selection is empty. Commands that do not
contain $input will be sent to the ICS immediately; otherwise they will
be placed in the ICS Input Box, with the cursor at the point of the
$input, and input focus given to the Input Box, so the user can start
typing. When a command is prefixed by "$add " it will be appended to the
existing ICS Input Box contents, rather than replace it.
  The items now have to be separated by ";\n", and button text from
command by ';' (with optional linefeed). This allows configuring of
multi-line commands, as a single linefeed no longer has special
sigificance.

2011-03-31 13:36:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo ICS input box with generic popup

This box is just a single text edit, but the complexity is in the added
callbacks. These callbacks remain in xboard.c, and were altered to
access the edit through the option.handle field.

2011-04-03 12:54:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Activate -path and -file options

In XBoard the generic popup was prepared for this. In WinBoard, for
-path options the BrowseFolder routine is used, and had to be made
global (prototype in winboard.h).

2011-04-02 18:40:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let generic popup generate Engine Settings dialog


2011-04-02 18:36:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Merge SettingsPopUp into GenericPopUp

Based on currentCps the values read from the dialog are sent to the
engine, or stored into the option.target in the callback, and fetched
from the option.target in the PopUp. The currentCps is cleared in the
generic popdown of a transient dialog.

2011-03-06 10:11:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make generic dialog popup reentrant

To allow persistent dialogs to be implemented through the generic popup,
it must be possible to have several dialogs open at the same time, and
thus make sure the popdowns under the cacel or close-window button know
which one to pop down. To this end an array shells[] is created that
takes over the function of settingsShell, and GenericPopUp gets an extra
parameter telling it which element to use for storing the dialog shell.
This number is then also passed to the callbacks that trigger popdown.
This was a bit nasty for the CatchDeleteWindow stuff, which passes user
data to the callback as text strings.
Keep a separate up/down indicator, so that shell widgets can be kept
for persistent dialogs. Also keep a currentOption per dialog type.
  The coordinates and size of the window is read out and stored in a
WindowPlacement structure, (if one is specified for that dialog), when
the dialog is popped down. When initialized the structure is also used
to set the window parameters when the dialog is created. (The idea being
that the structure was saved in the settings file.)
  The routine MarkMenu checkmarks a given menu item, and logs it for the
given dialog type, so that a later popdown automatically unchecks is.

2011-02-25 12:14:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Machine Match menu item and options dialog

An item to start a match from the menu is added, similar to what
WinBoard has. (The code is duplicated, so I guess it should be moved to
the back-end now, as MachineMatchEvent(), but it was tiny.) A dialog in
the Options menu was added with the aid of the generic popup, and allows
the user to set the load Game / Position File and Index.

2011-04-01 14:54:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Create General-Options dialog

The generic popup is used to implement a General-Options dialog, which
contains all Boolaen options that used to be set directly from the main
Options menu, plus a spin option for the flash count and flash rate.
The corresponing options are removed from the main Options menu, but the
whole thing is made conditional on a compiler switch OPTIONSDIALOG.
The dialog needs an OK callback for sending an altered ponder-state to
the engine. (Why isn't this option disabled in -ncp mode, btw?)
A spin control is added to adjust -animateSpeed between 5 and 100.
Add dropMenu and showTargetSquares item as well.

2011-04-01 18:16:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo new-variant dialog with generic popup

Some special code was added in GenericPopUp() to force buttons of the
type needed in the New Variant dialog (wide, colored, greyed-out on
variant type). The dialog was implemented with these, and callbacks for
the buttons directly exit the dialog, without the need for OK. New spin
controls are added to the dialog for adjusting the board format.

2011-04-01 14:48:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo common-engine dialog with generic popup

The ponder option was removed, as it is already in the main Options
menu, and would require nastiness in the OK callback. Added book options
in common-engine dialog.

2011-02-24 13:32:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo adjudications dialog through generic popup

We dropped the periodic-updates option, as it is already in the main
Option menu.

2011-04-01 21:56:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make sounds dialog for XBoard

This uses the combo boxes. A 'play' button isimplemented for a test
sound. A sound directory is introduced, and can be set through the
dialog. A default setting for -soundDirectory is added to xboard.conf.

2011-04-01 23:11:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add ICS options dialog


2011-04-01 21:52:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add board dialog XBoard

The GenericPopUp() is used to implement a dialog for board options. The
board dialog needs to trigger redraw and redefinition of the
colors, through an OK callback. Color-pickers are used for the 6 basic
color settings.
  To allow changing board settings during the session (i.e. from a menu
dialog), the routines to allocate resources have to free the resources
for the previous settings first. This patch take care of XtCreateGCs(),
preventing re-creation of resources that are unchangeable (such as the
grid color), and calling XtReleastGC() on GCs that can be changed.
To prevent resource leaks the old pixmaps are deleted before making new
ones on second or later calls of CreateXPMPieces().

2011-04-03 11:39:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add browse button to generic popup

Options of type FileName and PathName cause a browse button to be added
behind the text field. The SpinCallback is used to handle the
button presses, and invokes the file browser dialog to obtain a
filename, which is then copied to the text field.

2011-04-01 21:49:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make generic XBoard popup, and implement 2 dialogs

The Engine-Settings dialog of XBoard was cloned to work on predefined
lists of (XBoard) options, rather than engine options. An extra field
was added to the Option struct, to hold a pointer to the XBoard variable
that should hold the option setting, so on OK'ing the dialog the altered
values can be copied there. Not usable for options which should trigger
an action (like redraw, or sending something to the engine).
A Load Game, Save Game and ICS Options dialog were then defined by
tables fed to GenericPopUp(). Options set from these dialogs were removed
from the main Option menu, which removes a lot of code from xboard.c
(for checkmarking, disabling the menu items).
  A button defined in the GenericPopUp can attain the color indicated
by a previous text field, and add a callback to change the color in a
spin-like manner (but using R G B W in stead of + - butons).
The EndMark option can specify a callback, to be used on OK.
A non-zero max field in the Option descriptor will be used to set the
width of ComboBox, TextBox and Button optons.
The elements are chained such that extra space goes fully into the input
fields. A label type is added for clarifying texts that would not fit in
the option names. A break-type (pseudo-)option is added. Make OK and
cancel button suppressable in generic popup (by 2 bit of the option.min
field).

2011-04-03 11:34:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add file-browser option to just return name

By passing mode "f" the file browser dialog will not open the selected
file at all, so it can be used to retreive the name for the benefit of a
file-browser button to a -file option. A mode "p" will limit the
selection to directories only, to browse for a path.

2011-04-03 13:15:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Put insertion point at end of text on SetFocus


2011-04-05 23:47:34 -0700 Arun Persaud <apersaud@lbl.gov>:
fixed 64 bit warnings by casting integers to intptr_t before casting to int


2011-04-05 23:24:24 -0700 Arun Persaud <apersaud@lbl.gov>:
removed check and #includes for malloc.h, since it's not needed

hopefully this doesn't break things on non-linux systems. OS X seems to be ok, not sure about others ;)

2011-04-03 20:23:49 -0700 Arun Persaud <apersaud@lbl.gov>:
check if malloc.h is present before including it

OS X 10.6 doesn't have malloc.h, so it complained.

2011-04-03 20:01:36 -0700 Arun Persaud <apersaud@lbl.gov>:
Fix bug introduced in commit 89b4744: removed a "/" and forgot to add it in the config file

removed a "/" to make OS X happy, but forgot to add the "/" again in the xboard.conf.in file

2011-03-12 14:08:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix display of promotion piece in ICS superchess

In Great Shatranj and Superchess promoted Pawns were displayed as shadow
piece because these variants had holdings, while captured pieces should
go back into the holdings unchanged, rather than reverted to Pawns.

2011-03-13 14:09:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix o-o castling in new parser

The non-compliant notation of castling with lower-case 'o' should be
preferred over the non-compliant interpretation of moving a Pawn along
the o-file. Not doing so breaks ICS play, as ICS use o-o and o-o-o for
castling! So an exception is now made for the o-file in the 'fxg'
case.

2011-03-10 19:27:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement yynewstr entry point in new parser

This entry point, used for parsing an ICS move list, was forgotten, and
was still an empty routine. This made XBoard crash when observing an ICS
game.

2011-03-07 23:11:00 -0800 Arun Persaud <apersaud@lbl.gov>:
fixed wrong default for polyglotDir mentioned in docs.

Thanks to Hans Aberg for reporting it.

2011-03-05 12:39:01 -0800 Arun Persaud <apersaud@lbl.gov>:
Fix "make install" on Os X10.6.6 (removed a "/")

seems like an extra "/" made "make install" unhappy

2011-03-03 21:19:05 -0800 Arun Persaud <apersaud@lbl.gov>:
removed parser.l from build process, also removed flex dependency from configure


2011-03-02 22:14:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
New parser, written in C

A new parser was written to replace the flex-generated one. Immediate
improvements are that it understand double-digit rank numbers, and Shogi
coordinates. No changes were made in the Makefile yet to reflect the
new, flexless building procedure.

2011-03-02 22:23:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bugs in FRC castling rights

When parsing a castling move in FRC when no rights existed, the parser
returned 0 (= EndOfFile) rather than ImpossibleMove. The recognition of
the absence of rights was not adapted to the new encoding NoRights in
stead of -1.

2011-03-01 23:42:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parsing bug of FRC castling

The code that was supposed to intercept castling when no rights existed
in FRC was not adapted to the new encoding for this by NoRights, rather
than -1, and furthermore returned 0 (= EndOfFile) rather than
ImpossibleMove. Not sure if the former would manifest itself in any
way, but the latter seems bad.

2011-03-01 23:32:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix two bugs in reading position diagram

When reading a game without FEN tag, a position diagram is used to set
the initial position. This calls CharToPiece() with a '.' as argument,
because that is the position-diagram way to indicate empty squares.
altered CharToPiece() over time this would be recognized as the first
undefined piece or, more recently, the first piece without nickName,
which is a white Pawn. Now it returns EmptySquare again in that case.
A second problem was that for position diagrams in braces the brace was
not in the list of ignored characters, and would cause the reading to
get out of phase, so that the side to move was not recognized.

2011-02-26 21:12:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix flipBlack option XBoard with board texture

In XBoard -flipBlack is implemented by swapping white and black pieces,
because the Shogi bitmaps from XShogi are made that way. But the mask
used to cut out the whole in the board texture to fit the piece was not
swapped, both when drawing static pieces, as well as during animation.

2011-02-25 14:38:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Improve repairing damage of arrow highlight XBoard

With line gap the highlight arrow necessitated redrawing of the entire
board, to repair damage on the grid. This interfered with flashing of
pieces, which was only done on selective redraws. In stead of forcing a
total repaint we now just redraw the grid lines.

2011-02-23 16:41:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix unintended translation in debug file

The words "first" and "second" (cps->which) were sometimes used in
context that should definitely not be translated. (e.g. the indicator
for which engine printed/got the line in the debug file.) So translation
is now deferred to all uses in popups.

2011-02-23 16:29:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix nps bug

The nps settingwas tested for being > 0 in stead of >=0, so that the
case of CPU time was not properly handled.

2011-02-24 19:06:27 +0100 Kamil Blank <caceel@gmail.com>:
Added missing fclose()

(tiny change)
Signed-off-by: Arun Persaud <apersaud@lbl.gov>

2011-02-20 16:12:19 -0800 Arun Persaud <apersaud@lbl.gov>:
release of version 4.5.1

2011-02-20 16:10:16 -0800 Arun Persaud <apersaud@lbl.gov>:
updated Changelog, NEWS, etc.

2011-02-20 20:36:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix two typos in option names in texi file

Polyglot was capitalyzed

2011-02-20 00:03:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some resource leaks

Some files were opened not closed in XBoard, when loading XIM images
(which I doubt anyone ever does) but also when copying the clipboard
(which has the potential of being done very often). There was also some
code that would not work if conditional code which is permanently
disabled would be enabled.

2011-02-17 20:17:04 -0800 Arun Persaud <apersaud@lbl.gov>:
new developer release

2011-02-17 20:14:38 -0800 Arun Persaud <apersaud@lbl.gov>:
updated Changelog, NEWS, etc.

2011-02-17 15:40:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix MSVC snprintf problem

In MSVC snprintf has to be redefined as _snprintf, and this happens
conditionally in config.c. But the latter was not #included in help.c.

2011-02-16 19:41:27 -0800 Arun Persaud <apersaud@lbl.gov>:
updated configure.ac to check for Xaw header files

check for Xaw header files when --without-Xaw3d was given. Before the test was
only done when Xaw3d was specified, but could not be found.

If Xaw3d or Xaw can't be found, print a hopefully useful error message and exit the configure script.

2011-02-16 12:03:22 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ICS channel 0

Channel 0 messages were not displayed in the console, because the test
for channel number considered every non-numeric or non-existent handle
in a chatbox to be zero. So the messages were diverted to a non-exsting
chatbox. Now it test first for the handle to start with a digit.

2011-02-15 19:13:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make language choice from menu persistent

Set appData.language to the chosen language file, or empty if English is
chosen, so that the choice is saved with the settings. Increase the
number of possible language choices from 5 to 20. (After all, we already
have 7 now!)

2011-02-14 11:09:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix showing of user move after adjudication

The correction of the fishy patch (removing ShowMove() from Adjudicate())
had broken the adjudication of user moves (that actually did work before
the fishy patch, because there the gobal fromX/Y and toX/Y do contain
the correct values for the move to be shown). An entered move that led
to adjudication (like a checkmate) now was not displayed at all. Adding
an extra ShowMove() after (successful) return of Adudicate() solves it.

2011-02-13 23:49:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Xiangqi King facing

The Spartan patch had broken the CheckTest for Xiangqi, because cl.check
was cleared after the King-facing test, rather than before it.

2011-02-13 22:30:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix variant janus size prefix

The default board size of Janus Chess was not consistently taken to be
10x8, which resulted the name to be sent as 10x8+0_janus to the engine.

2011-02-13 12:18:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Alfil bug

The test for Alfil (suppressing single steps on the Elephant) contained
a wrong logical operator, so that it could never be active. It also
failed to include Xiangqi as variant with traditional Alfil. This led to
one-step moves of the Elephant in these variants, and false check or
unreliable mate detections.

Fix move of Xiangqi Elephant

2011-02-09 23:19:09 -0800 Arun Persaud <apersaud@lbl.gov>:
fixed configure script to correctly detect Xaw3d library


2011-02-06 22:07:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix unmarked translation

The file-browser wndowtitle in WB was not marked for translation.

2011-02-04 10:27:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put warning in HTML help

A warning is added that the help file is not yet updated for the new
menu organzation.

2011-02-04 10:22:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix 64-bit Windows compilability

The API interface for Set/GetWindowLong has been changed for 64-bit
Windows, both in the name of the call as in the arguments.

2011-02-04 10:21:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix MSVC compilability

Both the makefile and the project file had to be adapted for the new
source file history.c, and the new location of parser.c.

2011-02-05 10:11:58 -0800 Arun Persaud <apersaud@lbl.gov>:
added missing #includes and missing prototypes to filebrowser

thanks to Max Funk for reporting. Now using HAVE_DIRENT_H.

Also cleaned up missing prototypes and some casts.

2011-02-05 09:21:48 -0800 Arun Persaud <apersaud@lbl.gov>:
added missing header file for sprintf


2011-02-03 08:50:50 -0800 Arun Persaud <apersaud@lbl.gov>:
added history.c to the tar-ball. Needed for Winboard


2011-01-31 23:03:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix deselection of greyed-out variant button (WB)

In Windows a disabled radiobutton refuses to deselect when you select
another (enabled) button from the group. There are then 2 buttons
checked, and the code to readout the buttons took the first one. Now it
is changed to take the first enabled one.

2011-02-03 08:28:15 -0800 Arun Persaud <apersaud@lbl.gov>:
Revert "Implement -reset option feature in WinBoard"

This reverts commit efecf86cd9b54072c6a2f38d62f1d775e69c545b.

picked the wrong commit from HGM's git tree.

2011-02-01 22:01:12 -0800 Arun Persaud <apersaud@lbl.gov>:
add DIFFSTAT and SHORTLOG to tar-ball

was only in the v4.4.x branch and not in master

2011-01-30 09:52:15 -0800 Arun Persaud <arun@nubati.net>:
release of version 4.5.0

2011-02-01 07:41:04 -0800 Arun Persaud <apersaud@lbl.gov>:
changed size of borders around squares from 0 to 1 as a default

this way highlights show up again.

2011-01-29 20:11:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement -reset option feature in WinBoard

2011-01-30 10:12:08 -0800 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.

2011-01-30 09:56:39 -0800 Arun Persaud <arun@nubati.net>:
updated parser.c form parser.l

2011-01-29 19:59:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Clean up fishy patch

None of the ShowMove() calls in Adjudicate() was working, because when
this code was taken out of HandleMachineMove() it was taken outside the
scope of the local fromX, fromY etc. there, so that it started using the
global variables from the mouse driver. As these usually contain -1,
this suppressed move animation and highlighting. All these calls have
now been removed, and ShowMove() is called after a positive return (from
HandleMachineMove(), so within the correct scope).
This improves the previous fix, which led to some flicker, because the
erroneous ShowMove() calls did draw the new board (instantly), wich in
the fishy patch was then immediately overwritten by the old position, to
start animation. This drawing of the old position is now no longer
needed either.

2011-01-29 13:36:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update RTF file

The RTF file is adapted to the new menu organization.

2011-01-29 13:31:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file

The highlight-with-arrow and one-click-move menu items are described.
The highlightMoveWithArrow and variations option are described.
Load Next /Previous Position descriptions are moved to File menu.
The description for entering variations is updated (using Shift key).
The remark that editing holdings is impossible is removed.
Spartan Chess is added to the list of supported variants.

2011-01-28 18:35:48 -0800 Arun Persaud <arun@nubati.net>:
Updated copyright notice to 2011


2011-01-24 15:01:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Greyout unavailable variants in New Variant dialog

The WB radio-button code is refactored to be driven from a list (which
must be kept in phase with the variant definitions in common.h!). It now
also checks if the first engine supports the variant, and greys out the
item if it isn't. XB now also makes this check. Slight re-ordering of
10x8 variants there, to have the more common on top.
If no radio button is selected, keep old variant even on OK.

2011-01-19 11:10:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Move clock-click code to back-end

Some duplicated (or should-be-duplicated) code for handling clicks on
the clocks from the XBoard and WinBoard front-ends was merged and
relocated to the back-end, so it can be shared. Noticeable was that
XBoard allowed turn change in ICS examine mode by clock clicking,
while WinBoard did not. WB, on the other hand, allowed clock adjustment.

2011-01-16 23:15:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix legality testing of drop moves

Drops of noexistent pieces (i.e. with a piece indicator letter that is
not corresponding to any defined piece) are now parsed as
ImpossibleMove, rather than IllegalMove, so they are also rejected with
legality testing off.

2011-01-17 00:28:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WB Sound Options greyout and remove some grossness

The sound and ICS Options menu items in WB were accessed 'by position',
with fixed defined positions (always messing up any reorganization of
the menus when you forgot to redefine the position constants in
winboard.h). And not only that, but for completely mysterious reasons,
the greying of the sound item greyed out the game-list options (above
it) in stead when it was defined as 9, and the ICS options (below it)
when it was 10 !!!. Now they are addressed 'by command' (and the
position definitions are removed), which fixes things.

2011-01-25 21:35:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Re-instate load next/prev position menu items

As positions do not use something similar to the game list, these are
still useful. For some reason I could not get Alt+Shift+PgUp/Dn to work,
so I settled for Shift+PgUp/Dn.

2011-01-16 21:56:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove superfluous copying of machine move

There was explicit code in HandleMachineMove() and FinishMove() to put
the move in the moveList, while MakeMove() already does this later in a
more reliable way by calling CoordsToComputerAlgebraic(). This
superfluous code is removed now.

2011-01-16 21:44:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix spurious mate test in Edit Game mode

When entering a game, it was terminated by the mate test even when
legality checking was switched off (so that mates might not be reliably
recognized). The mate test is now made dependent on legality testing.

2011-01-16 21:37:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix type-in of drop moves

Drop moves entered through the move type-in already come in the (piece,
DROP_RANK, x, y) format, rather than having a holdings from square. This
caused UserMoveEvent to consider them illegal when testing if the
piecewas of the side to move, and when this was fixed, to recognize
Knight drops as coming from between board and holdings (and thus
illegal).

2011-01-16 21:31:42 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix move type-in truncating game

Starting a new variation by keeping Shift pressed did not work when
OK'ing the move type-in, because there was some code ther that truncated
the game. While this could be safely left to UserMoveEvent, which it
calls, as the situation is not different from entering moves through the
mouse.

2011-01-11 16:12:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix legality testing for promotions

Turns out WB has never tested for the legality of the chosen promotion
piece, and would allow promotion to King innorml chess even with
legality testing on (when entered through the keyboard)! Now strict
testing is done, outlawing Pawns and Kings (or Unicorns in
Knightmate). Only in suicide / giveaway Kings are stillallowed, and in
spartan a black King if you do not have two yet.(And promotion
toLnce,representing Hoplite Pawn,is forbidden there.)

2011-01-11 11:34:07 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reset 50-move counter on all pawn-like Lance moves

Now the Lance represents a Pawn-like piece not only in variant fairy,
but anywhere outside Shogi / Superchess, its moves should also reset the
50-move counter in those cases. Especially important for Spartan Chess,
where the Lance actually participates.

2011-01-11 11:18:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix logo repainting

The logos were not repainted when the main window was moved out of the
display area, and then back into view. The reason for this is
unknown, as the PaintProc calls HDCDrawPosition, which was calling
DrawLogoOnDC. But the logos were not drawn, (or on an expose event
sometimes half drawn!) despite the fact that the rest of the board was.
The drawing of logos now has been decoupled from drawing the board,
and has been moved to a separate routine DisplayLogos() (in analogy to
DisplayBothClocks()). This is cleaner anyway, as the logos usually do
not change when the board does. So apart from in PaintProc, it has only
to be called when the mode changes (ModeHighlight()) or on swap clocks.
This seems to fix the problem.

2011-01-10 20:36:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix time in PGN info

Saving of the thinking time in the PGN was broken by the patch that
removed the race condition in the clock switching, because that moved
the incrementing of forwardMostMove to behind the code that used fmm to
index pvInfoList. As a result the time was stored in the slot for the
opponent's previous move. The value is corrected now.

2011-01-09 00:24:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fishy fix

The move that delivers checkmate in two-machines mode is not animated
when adjudication is on. There then also is no highlighting of this move
Redrawing the board and calling ShowMove fixes it. Which is rather
strange, because ShowMove was already called in Adjudicate (when it
adjudicates), before GameEnds. For reasons that are not understood this
call to ShowMove() (which calls AnimateMove()) is not effective.

2011-01-09 00:21:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reset machine colors after match

The colors each engine playse are set to the originals after the last
match game, so that a new match or two-machines game will not have
swapped colors.

2011-01-09 00:15:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reset win/loss counters before match

The win/loss counters were not reset, because the code counted on them
being initialized to zero. But with matches startable from the menu,
this is no longer true after the first match.

2011-01-09 00:08:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Show move that causes false illegal-move claim

Without claim testing XBoard takes back moves that an engine objects to.
But when the engine is forfeited for a false claim, the move should of
course stay. So the claim test is moved to before the take-back.

2011-01-09 00:05:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Spartan promotion to King

Promotions toKing were refused when in check, because XBoard thought
they would not resolve the check. Now the promotion is actually
performed before doing the check test.

2011-01-05 17:31:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WB font-based piece rendering on variant switch

The piece bitmaps were only created from the font characters when the
number of ranks or files changed, because it was done in
InitDrawingSizes(). This caused missing pieces when changing to a
variant on the same board that used other pieces. Now InitDrawingSizes()
is called for any variant switch.

2011-01-05 17:25:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix right-alignment pproblem in WB ICS window

Use of Ctrl-R to summon the context menu still trickled through to the
default text-edit window routine, and caused right-alignment. This was
because the text-edit reacts on keyDown rather than the character event.
KeyDown of R with Ctrl pressed is now also intercepted and ignored.

2011-01-03 13:04:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix chat window title

The title was using the engine name, rather than the ICS handle, which
did not work outside zippy mode. Now it only uses the engine name when
no ICS handle is known. The titleis now also subjected to translation.

2011-01-03 12:50:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix spurious reading of old game title by JAWS

Because focus was switched to the board window before loading the
selected game from the game list, the titlebar still contained the
name of the previously loaded game, which would spontaneously be read by
JAWS. Now the focus switch is done after loading the new game (which
updates the window title.)

2011-01-03 12:37:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add variant Spartan Chess

In the WB menu it takes the place of the defunct Twilight Chess item.
The setup routine needed patching for setting up Lances in stead of
Pawns for black, the check test had to be adapted to handle duple check,
Alfil and Dragon moves were fine tuned in this variant to make the exact
moves, and the promotion popup was adapted to show King and interpret
Rook and Bishop as Dragon and Alfil for black. The Alfil now always
moves as Modern Elephant except in Shatranj and Courier.

2011-01-03 12:23:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix mate test

Due to a bug in logical operators drops were tried for mate evasions
even in non-drop games, which broke it in Superchess and Great Shatranj,
and wasted CPU time in other variants.

2011-01-05 17:19:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix promotion suffixon disambiguated piece moves

The promotion suffixon piecemoves that needed disambiguation was not
passedon to the back-end in most variants. Now it is passed on in any
variant.

2011-01-03 12:08:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix promotion of Pawn-like Lance

In variants where the Lance is used to represent an unorthodox Pawn, it
must promote when it reaches last rank. With legality testing on,
however, the promoChar was ignored in ApplyMove in this case. The
promotion suffix also was not appended in SAN moves.

2011-01-03 11:57:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WB promotion popup

The promotion popup did not work properly in variants where black did
not use the pieces that white wanted to promote to. Now the character
for the selected piece is taken from the piece encodings of the side to
move. In addition, selection of undefined pieces is ignored.

2011-01-02 14:17:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in parsing variations

The moves parsed from a variation were stored in the moveList without
appended linefeed. This caused errors if the variation extended to
beyond the end of the main line,into a hitherto unused part of the move
list, as the linefeed was then not there from the overwritten move. As a
result moves sent to the engine were concatenated, triggering
illegal-move messages and bringing the engine out of phase.

2011-01-02 14:11:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Define Ctrl-R as right-click in WB Comment dialog

To allow JAWS users to load a variation through the keyboard, Ctrl-R is
equated to a right click at the position of the caret or selection.

2011-01-02 14:10:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow starting a variation from keyboard entry in WB-JAWS

The status of the shift key is remembered when space is pressed to
select a board square.

2011-01-02 14:06:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Disable some accelerators in JAWS version

Single-key accelerators that could result in irreversible data loss are
undesirable, because the risk of accidentally pushing them is too large.
So the non-Alt duplicates of next/previous game/position are disabled,
as are Home and End for Revert and Truncate Game. JAWS users will have
to rely on the menus for those functions.

2011-01-02 13:59:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Group engine-output memos with engine names

The engine names are now defined just before the text edits, so that
JAWS 11 will read the engine name when the memo for the output of that
engine is selected. (JAWS 10 will still read the NPS, as it reads in
geometrical order.)

2011-01-02 13:55:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put nr CPU earlier in tab cycle of WB Common Engine dialog

By defining the max CPU control after hash size, the tabbing steps
through the controls in geometrical (and logical) order, rather than
having the max CPU in between the book controls.

2010-12-29 23:47:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update WB language template file


2010-12-29 23:41:27 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Subject JAWS menu and spoken strings to translation


2010-12-29 23:37:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let JAWS SayString buffer full sentence

The meaning of the flag parameter of SayString was changed to indicate
buffering of flushing. On flushing a message of a single space is used
as a kludge to indicate interruptability. Calls to force flushing where
added everywhere.

2010-12-29 23:32:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt JAWS menu to new menu organization

The menus did not correspondto the texts after translation of the main
menu bar.

2010-12-29 23:18:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Translate menus after creation of JAWS menu


2010-12-29 23:07:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ICS context menu for JAWS

The Ctrl+R key did select text at the mouse pointer in stead of at the
curser, now that up and down-click were combined.

2010-12-29 23:04:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reorganize order of WB New Variant dialog controls

The definitions are re-ordered so that at least JAWS 11 will speak the
board-size elements properly.

2010-12-29 22:57:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix order of elements in WB time-control dialog

Someleading texts were defined after the text edit they referred to,so
that JAWS 11 associated them to the wrong one. A tab stop was added to
the time-odds label, to make JAWS speak it.

2010-12-29 22:51:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change tabbing order in WB sounds dialog

The 'Play' button now gets focus immediately after the controls for
selecting the sound, rather than at the end of the dialog (after OK).

2010-12-29 22:47:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove tab stops on first radio button of WB dialogs

The New Variant and Board dialogs had a tab stop on the first radio
button,so that tabbing toit would automatically select variant
normal or size tiny. Now it tabs straight to the current size, without
changing anything. (Important for JAWS users.)

2010-12-29 22:45:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put OK/Cancel last in tab cycle of some WB dialogs


2010-12-29 22:29:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix duplicate menu character for Edit Comment

Edit Comment did have the same shortcut character as Copy Game. Changed
to m now.

2010-12-11 11:18:56 -0800 Arun Persaud <arun@nubati.net>:
fixed automake process: xboard.conf couldn't be generated if $srcdir was not the current directory


2010-12-11 09:50:48 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-12-05 18:01:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Subject WB context menus to translation

The innerloopof the menu translation has been made into a separate
routine. This now uses GetMenuItemInfo() in stead of ModifyMenu() to
better preserve menu breaks. Menu #10 is used for context menus (from
the routine that pops them up), and for this number the orignal texts
are not saved in menuText. (This is not needed, because the menu is
created everytime anew from the resource data.)

2010-12-05 15:00:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update translation template

Add the new menu items; add some notes.

2010-12-05 14:04:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Resize buttons in WB engine-settings dialog

The OK and cancel buttons were to narrow for most translations, and were
a non-standard order as well.

2010-12-05 13:56:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add one-click move control to WB general-options dialog

This is a duplicate of the one in the ICS options dialog, but the latter
is inaccessible in non-ICS modes, and one-click move is now
alsoavailable in engine mode.

2010-12-05 13:51:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Create space in dialogs for translation

The translated texts often did not fit, because controls were defined
needlessly small (when there was empty space between them). In these
cases they have been enlarged to consume all available space. Some
dialogs are made wider.

2010-12-05 13:47:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add handle for translator acknowledgement

An empty string is printed in the about box, which can be 'translated'
to a message acknowledging the translator.

2010-12-05 13:43:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use default logo for user

When no logo with the name of the current user is found, use dummy.bmp.

2010-12-05 15:46:34 -0800 Arun Persaud <arun@nubati.net>:
added rlwrap tip to FAQ


2010-12-03 23:24:06 -0800 Arun Persaud <arun@nubati.net>:
replace hard coded paths with path from configure script

use $datadir and subdirectories to store some data files. Also make files in xboard.conf use correct path.

2010-12-03 23:02:09 -0800 Arun Persaud <arun@nubati.net>:
fixed a typo in the configure script output


2010-12-03 21:46:00 -0800 Arun Persaud <arun@nubati.net>:
added a desktop file

taken from the openSUSE project

2010-12-03 22:44:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Edit Game/Position checkmarking in WinBoard

Because the entries in Edit and Mode menu were pure duplicats, the
entries in the wrong menu (Edit) were checkmarked while active. By
defining different IDs for those in the Edit menu, those in the Mode
menu are checkmarked again.

2010-12-03 10:07:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add XBoard menu items for arrow highlight and one-click move

These items are put in the options menu; the 'Old Save Style' item is
removed.

2010-12-03 09:27:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Provide menus for editing WinBoard engine and server lists

The Edit Tags dialog in the WB front-end is adapted to act as a general
edit for string variables, by giving it an extra parameter to indicate
where to store the edited result. Menu items are added to invoke this
dialog for editing the /first, /secondChessProgramNames and /icsNames
options. This solves the problem that people would have to edit an ini
file that they can no longer locate (because the %APPDATA% folder has
different names and locations in the various Windows versions, and is
often a hidden folder on top of that).
There is a slight memory leak here, as the memory for the previous
value of the altered string option is not freed.

2010-12-02 16:18:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure arrow highlighting as default in XBoard

Set -highlightMoveWithArrow true in the xboard.conf file, and specify a
lineGap of 0 to make that efficient (and the wood theme even nicer).

2010-12-02 15:56:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Port highlighting with arrow to XBoard

Unfortuntely this duplicates a fair amount of code in the front end.
Removing the arrow is done by a total repaint if there is a non-zero
lineGap, because the clever algorithm for selective redrawing (based
on damage) that XBoard uses does not repair damage to the grid lines.
For lineGap=0, however, (for which the arrow is mainly intended) the
damage mechanism is used, and the damaged squares are determined by
tracing out the arrow in 64 steps, and marking all squares in the
neighborhood as damaged.

2010-12-02 15:55:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Strip CR from xboard.c


2010-12-02 14:21:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let user decide if he wants highlights in blindfold mode

Remove the automaticsuppression ofhighlighting.

2010-12-02 00:24:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix fag-fell marker with logos on

The flag-fell marker "(!)" that is displayed in the clock in WinBoard in
two-machines mode was printed twice when the clock was split over two
lines (as with logos on).

2010-12-01 18:57:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Also exempt variant seirawan from eval-scale doubling

It is not really a drop game, so a scale from -7 to 7 in the eval graph
is good enough (like variants great and super).

2010-12-01 10:33:13 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure EGTB cache size in adapterCommand

The hash size, nr of CPUs and EGTB path are transferred through the WB
protocol interface commands memory, cores and egtpath. But there is no
WB command for detailing the EGTB cache size. So the value of the
command-line option -defaultCacheSizeEGTB has to be sent to Polyglot
through its startup command to make it known to UCI engines.

2010-11-30 22:46:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Move Hint and Book items to Engine menu in XBoard


2010-11-30 22:17:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Correct the key bindings fo view menu in texi file

The mentioned bindings for Game List and Eval Graph were wrong.

2010-11-30 21:25:07 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix sub-variation display with negative score

The test if the displayed score was the pvInfo score failed for negative
scores, because floats are truncated towards zero. So the previous fix
of spurious score/depth info was not working when the score was
negative.

2010-11-30 18:27:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Peel PV out of comment

Arena stores engine PVs not in variation format, but within both braces
and parentheses, before the score/depth info. This caused XBoard to
overlook the score/depth info, (frustrating, e.g., the eval graph),
while the PV would not be accessible for walking it as a variation.
The routine that extracts the score/depth from a comment now has
been made more clever, to recognize a leadin PV in the comment, and then
place it in front of the comment as variation (by moving the opening
brace to behind it). For some reason it does not work if the PV and
score/depth were separated by a newline, but this happens quite rarely.

2010-11-30 18:23:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow line-straddling result comments

Some GUIs (in particular Arena) do not have the decency to keep the
result comment on a single line. In this case the parser rules would not
recognize it, and treat it as a normal comment, plus an undetailed PGN
result. The rules are now fixed to allow linefeeds in the comment, and
between comment and PGN result. To correctly process the comment further
(e.g. in game-list lines) the linefeeds are replaced by spaces in the
back-end routines that do use the result comment.

2010-11-30 12:22:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Write key bindings in XBoard menus

Unfortunately tabs are not understood in menu texts, so fine-tuning
through spaces is necessary to get some sort of ragged alignment.

2010-11-29 18:01:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure XBoard to use wood board texture by default

The texture pixmaps are sought in /usr/share/games/xboard, with names
wood_l.pm and wood_d.xpm. I guess the " make install" should be adapted
to put them there. XBoard is resitent to non-existence of the files,
btw. It simply ignores the arguments in that case.

2010-11-29 17:48:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure -inc as volatile option in XBoard

XBoard users are not used to options being persistent, and thus have
many scripts assuming the timeIncrement is -1 when they don't specify it
on the command line, and want to specify -mps. But a persistent -inc of
0 fom a preious session would then force their -mps to zero, causing
big-time confusion.

2010-11-29 17:36:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make WinBoard clocks translation-proof

With logos on, the splitting of the clock over two lines assumed the
lengths of the words "white" and "black" would always be 5. Used strlen.

2010-11-29 14:57:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Improve drawing of highlight arrow

A diagonal arrow sometimes had a notch in the shaft because of
independent rounding of the starting and ending point coordinates.
Furthermore the width of the shaft was unnecessary variable(as a
function of direction) because half the width was rounded and then used
twice. Now rounding of end-points is always done towards a fixed grid
of square centers, which keeps diagonals purely diagonal, and one side
of the shaft is drawn relative to the other side, after the
position of the latter has been rounded, so any rounding error affects
the shaft width only once.

2010-11-29 10:25:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Alter descriptionof Analyze File menu item

This menu item has been given a new function, so a new description was
needed.

2010-11-29 10:15:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add description of Game List Options in texi file


2010-11-29 09:58:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file for new menu organization

The descriptions are shuffled around and organized into sections
corresponding to the new main menus. Where necessary the name of the
items was changed to their new names. The items removed from the File
menu (the next/previous/same stuff) are nowmoved to the section "other
shortcut keys", as the key bindings for some of them are still active.

2010-11-29 09:06:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update info on key bindings in texi file

The texi file was still listing the old XBoard key bindings. Where
necessary this is now changed to the new (WinBoard) bindings, and all
the new bindings were added.

2010-11-29 09:04:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add XBoard key bindings for Revert and Truncate

Use Home key as accelerator for Revert, End for Truncate, as in WinBoard.

2010-11-28 23:12:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Divorce the Edit and Show Tags/Comment menu items

In WinBoard the items in the Edit and View menu for Tags and Comment now
have different IDs, so they can be independently controlled. Only the
items in the View menu are check-marked. The items still do the same.

2010-11-28 23:08:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Alter WinBoard menu text

The texts are slightly adapted, mostly by choosing more convenient
tabbing characters for the new menu organization. The translation
template is updated accordingly.

2010-11-28 20:24:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let move-history window scroll to bottom after adding move

By activating the scrollbar of the viewport through XtCallActionProc
the move-history window is scrolled to the bottom.

2010-11-27 14:38:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Shogi promotion popup

The texts were adapted to shogi by printing new text items over the
Queen and Knight buttons, but these did not alwys cover it. Now the text
on the buttons is changed as it should be. Also the window title is
adapted.

2010-11-26 11:22:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Apply gettext macros to menu texts

Now texts and references are separated, the texts in the tables can be
decorated with the N_() macro, so that the _() macro no longer has to be
applied when they are used. (This makes the texts appear in the .po
files.)

2010-11-26 11:12:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt some XBoard menu texts

The "Show" prefix is removed from the "View" menu items, as this seems
implied. An ellipsis is added to the Engine #N Settings items, which
could not be there before, because periods in a menu name would break
any reference to it. For some other names the ellipsis was deleted.
(These were not refered to, but who knows what we will do in the future.)

2010-11-26 11:03:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Separate menu text from menu name in XBoard

The text string in the menu-definition tables was used both for the menu
text, as well as for referencing the items from the code (for enabing or
checkmarking). Now these can be defined separately, so that altering the
menu texts is possible without breaing any references to the item.
(Moving them to another menu would still break XBoard, though!)
Currently the texts and names are still the same.

2010-11-26 10:48:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix XBoard menu translation

The gettext macro N_() was applied to the menu definition tables, but
this would break any translation, as these items are both used as menu
texts as well as reference for enabling and checkmarking. The routines
that create the menus already apply _() dynamically to these items when
they are used as menu texts.

2010-11-26 10:10:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Restrict drops in variant seirawan to back rank

Drops aren't really llowed at all in Seirawan Ches, but there exists an
engine that supports a variant where drops on the back-rank are allowed.

2010-11-25 19:44:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let Analyze File annotate the loaded game

By not suppressing the auto-play loop in AnalyzeFle mode, we step
through the game while the engine is analyzing, and store the PV info
that the engine produces, as well as the full PV (as variation comment)
with each move.

2010-11-25 19:41:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Revive Analyze File menu item in WB

We will keep this menu after all, becase it can be given a new meaning.

2010-11-25 19:31:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix spurious scores in comments

The comment popup is also used to display engine PV info, but when the
contents of the window is written back when we select a variation,
it was treated as a real comment. This is fixed now by checing in
ReplaceComment() if the comment starts with the PV info, and if so,
ignore the latter. This solves the problem, but I guess the real bug is
that selecting a variation tries to write the comment even if it did not
change.

2010-11-25 19:26:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Display error for wrong use of Machine Match


2010-11-24 13:30:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reorganize XBoard menus


2010-11-24 11:02:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reorganize WinBoard menus

New main menus Edit, View and Engine are added; the step menu
disappears. The menu items are redistributed over the new menus.
Sometimes duplicates are created. No adaptation of short-cut characters
as made yet (as this affects translation).

2010-11-20 20:20:27 -0800 Arun Persaud <arun@nubati.net>:
removed trailing whitespaces from NEWS


2010-11-20 20:19:30 -0800 Arun Persaud <arun@nubati.net>:
merged readme_HGM.txt into the NEWS file

seems like a better place for the release notes, although those releases where not officially part of GNU, but the NEWS file already covers similar releases, so it might as well cover all of them.

2010-11-20 18:24:19 -0800 Arun Persaud <arun@nubati.net>:
typo in date of developer release

but will leave the tagged version as it is, since it's still a unique version number

2010-11-20 18:11:01 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-11-20 18:12:41 -0800 Arun Persaud <arun@nubati.net>:
added latest version of parser.c


2010-11-20 18:05:56 -0800 Arun Persaud <arun@nubati.net>:
updated Changelog, etc for developer release


2010-11-20 16:22:00 -0800 Arun Persaud <arun@nubati.net>:
Revert "adding gnu-readline support"

This reverts commit c95ef32a700132a134f335f857ca6f1b6f3c169f.

Conflicts:
	backend.c

better to use the (relatively) new ICS input box then add readline support.

2010-11-20 16:19:32 -0800 Arun Persaud <arun@nubati.net>:
Revert "bugfix: fixed readline support with icslogon option"

This reverts commit b9cdd7422ad1037d7376bce4f8f2db2669396e83.

Conflicts:
	backend.c

better to use the (relatively) new ICS input box then add readline support.

2010-11-19 23:10:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make Hoplite moves irreversible in Spartan Chess

Consider Lance moves in variant Fairy (where the Lance represents the
Spartan Hoplite Pawn) as Pawn moves, so they reset the 50-move counter.

2010-11-19 21:09:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Give Lance moves of Amazon in variant super

Now that Lance is no longer a wild-card piece the moves of Amazon must
be programmed explicitly, to keep the possibbilty to play Superchess
with legality testing on.

2010-11-19 18:32:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change representation of Bede in variant fairy initial position

This used to be Lance, but the promoted Bishop (Dragon Horse)
is more applicable. Especially now that Lance is supposed to move like a
Berolina Pawn.

2010-11-19 18:28:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make yyskipmoves also suppress examining of drop moves

Not sure if this does any good, but it seemed illogical that this would
happen in all other moves, but not drops.

2010-11-19 18:23:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Define moves for Dragon Horse outside Shogi

Let it move like Bishop + Wazir + Dababba.

2010-11-17 13:40:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix safety crash when appending comments

The length limit imposed on safeStrCpy was one too short when copying
an existing comment to the space allocated for the longer (concatenated)
one. It allowed no space for the terminating '\0'.

2010-11-17 13:38:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix safeStrCpy

The test for when to terminate a non-fiting string was one off, and the
debug message was written stdoutin stead of debugFP.

2010-11-16 12:40:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix default holdings size for variant seirawan

The holdings for 7 pieces werealways considered an overrule, so that the
variant name was prefixed with "8x8+7_".

2010-11-15 11:36:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix home-dir crash

When confronted with a path name starting with ~ and not containing a /
XBoard would segfault.

2010-11-14 21:45:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix one-click moving on up-click

(First) up-clicks were not always ignored: in Edit-Game mode with
one-click moving enabled this could lead to a capture being made on
the down-click, and the recapture on the correspoding up-click.
This has now been corrected, and only the down-click of a first click
can lead to selecting a piece or a one-click move.

2010-11-15 18:15:40 -0800 Arun Persaud <arun@nubati.net>:
fixed buffer size for snprintf


2010-11-13 23:04:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Accept Seirawan-style gating suffixes

The parser rules were extended to accept / as an equivalent of = in
promotion-suffix notation (e.g. Nf3/H in stead of Nf3=H).

2010-11-13 22:55:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use Falcon and Alfil as built-ins for Seirawan chess

Where available (size 49 and 72) we use Falcon for Archbishop and Alfil
for Chancelor, to better conform to the Seirawan names Hawk and Elephant.

2010-11-13 20:02:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement entering gating moves with mouse

A move with a back-rank piece that starts when a piece in the holdings
is selected will be interpreted as a gating move in variant seirawan.
The front-end uses a 'gatingPiece' selected this way todisplay it on the
from square during animate dragging.

2010-11-13 18:56:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement variant seirawan

Set upthe position, including Hawk and Elephant in holdings, in
InitPostion(). Suppress putting captured pieces in holding. Let
promoChar indicate gating in ApplyMove(). Remove gated pieces from
the holdings there. Let GenLegal() generate RxK-type castlings to act as
base for gating on Rook square. Gatings are tested for legality
based on the holdings content and whether they occur on the back
rank. Disambiguate() also tests this. Make sure the gated pieces are
printed as move suffixes in CoordsToAlgebraic().

2010-11-13 18:42:27 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add -variant seirawan to menu


2010-11-13 22:52:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix acceptance of null-move with legality testing off

A second click on the same piece was interpreted as a to-square rather
than deselection of the piece.

2010-11-13 22:49:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix one-click bug

Disambiguate was imagining captures, so an only capture by double
clicking your own piece did not always work.

2010-11-13 20:08:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix mouse-driver buglet

The highlights were not cleared on moves that went vertically off board.

2010-11-12 17:17:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
List some undocumented commands as compliant

The engine->GUI commands setboard and setup are now always printed in
the debug file as well.

2010-11-12 17:05:22 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
List Hint with compliant commands

This command was omitted, so that in some -engineDebugOutput modes it
would not appear in the debug file.

2010-11-12 17:02:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Restrict use of escape expansion

Only expand escape sequences like \n and \t in telluser(error) comamnds
that ask for it by preficing the messages by double backslash. Otherwise
backward copatiblity is too severely broken for messages that display
DOS-style filenames.

2010-11-12 13:56:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make safeStrCpy safe

SafeStrCpy was causing a lot of out-of-bound write accesses, as it was
always writing the character at the length limit of the destination.
Now no memory is accessed that is is not needed to hold the copy.

2010-11-07 21:37:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow clicked name internal to the icsMenu command string

A command in the /icsMenu that was specified to contain the selected
text or clicked word always appended this word at the end. Now the user
can also configure it to appear in the middle, by putting a %s in the
command string where he wants it to appear.

2010-11-07 21:33:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let Engine #2 Settings start second engine

If the second engine is not yet running, it would be impossible to use
the settings dialog for it, as the features have not been received and
the dialog will be empty. So the user could not adjust the engine
parameters before starting a match. Using this menu now automatically
starts the engine, and delays the appearence of the popup untill the
features are received, using a similar mechanism as in
TwoMachinesEventIfReady().

2010-11-01 19:40:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Newly lexed parser.c


2010-11-06 19:55:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in parsing illegal Pawn captures

When a pawn move of type exf5 was illegal, the parser made an attempt to
interpret it as e.p. capture of f5. This, however, messed up the move,
so that it was now permanently mistaken for e5xf6. Even in cases with
legality testing off, where you would want the original move to be
accepted despite the fact that it was illegal.

2010-11-06 19:49:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Keep last PV while clearing engine-output display

When ponder is on, the display is cleared immediately when the last line
of thinking output appears by the appearing ponder output. So you would
never get the chance to see it. This line is now re-written after
clearing, so it appears at the bottom of the output for the next search.

2010-11-06 19:45:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Give Lance moves of Berolina Pawn

In stead of using it as a wildcard piece, the Lance gets the moves of
the Berolina Pawn (straight capture, diagonal move). The initial double
osh can be a ump, though. (So it is really a Hoplite Pawn from Spartan
Chess.)

2010-11-06 19:42:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use SAN even on illegal moves

If there is only one piece of type T, moves like Ta1 or Txa1 are never
ambiguous, so adding the from square is just cumbersome.

2010-11-06 19:34:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use normal SAN for wildcard pieces

SAN often can also be used with pieces we don't know the moves of, e.g.
if there is only one of that type. We just always get rank or file
disambiguators if there are more (even when they might be unnecessary).

2010-11-06 14:52:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some warnings

Unused variables were removed from parser.l

2010-11-06 14:43:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow arbitrary nesting of sub-variations in PGN input

The parsing of subvariations is moved out of the state-machine parsing,
to allow arbitrary nesting. In stead of the entire sub-variation being
parsed by lex as Comment, it now returns Open and Close for the
corresponding parentheses, which are then handled in a wrapper routine
for yylex(): Myylex(). Problem was that yy_text is supposed to return
the entire parsed text of the returned symbol, which thus has to be
collected. To make this possible, yylex has to return everything that it
parses, (even white space!), and a symbol "Nothing" was added to return
in parsing rules that before just ate away irrelevant text without
returning anything.

2010-11-06 21:48:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement setup (engine-GUI) command

This allows the frst engine (when legality testing is off) to overrule
the default opening position, in reply to the variant command. Syntax is
"setup (PIECE_TO_CHAR_TABLE) FEN_STRING"
where the FEN string is interpreted in the context of the given
pieceToCharTable (which is optional, and only delimeted by parethesis if
it is present).
Sendng the position to the second engine is delayed until the first
engine has responded to the ping after the new-game sequence, to make
sure it gets the chance to alter the position before it is sent to the
second engine. This feature is useful for playing variants that WinBoard
does not even know the opening positon for, and can be used even if they
are shuffle variants.

2010-11-06 14:19:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Restrict use of a2a3 kludge

The kudge to send "a2a3" in stead of "black" to get black to move is
fatally flawed in varants that have no Pawn on a2. So in that case we
revert to use of the deprecated "black" command.

2010-11-02 13:06:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remember values set by -firstOptions, -secondOptions

When an engine announces its option features, and the option name
matches that of a setting given in -first/secondOptions, the engine is
sent hte specified value, but this value was not remembered as current
value (but the latter  was left at the engine-announced default),
leading to inconsistent behavior in the Engine #N Settings dialog.

2010-11-01 19:26:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make test for valid promotion piece color-dependent

This is needed to make it work in variants where white and black have
different armies; quite likely white will promote to pieces that do not
exist in the black army, so we really have to make sure we test if the
white (upper-case) piece exists in this case.

2010-11-01 19:23:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove validity test on promochar from parser

The backend routines Disambiguate() and LegalityTest() will catch
invalid promotions, so no need to do it here.

2010-10-31 23:37:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add the actual size-33 Shogi bitmaps

These were forgotten in the original commit that fixed the .rc file.

2010-10-31 13:20:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Delete some stale promotion code

The correction of the promotion piece to Ferz in Shatran-like variants
in ApplyMove() was no longer needed, as the new promotion code already
does this in the move parser.

2010-10-31 13:08:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Augment moves of some fairy pieces

To get better disambiguation in variants that have to be played with
legality testing off, the Elephant is given also one-step moves (making
it a so-called Modern Elephant) in -variant fairy and great. The Dragon
King (Crowned Rook), which had no moves defined for it outside Shogi at
all, has been given Rook moves plus an orthogonal 2-jump, so that it
can get SAN moves when used as Dababba or Short Rook. (Illegal moves
currently aways force long algebraic notation...)

2010-11-08 22:57:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix safeStrCpy patch, WinBoard

The use of sizeof on pointers was detected through the same method as
the previous patches, this time while compiling WinBoard. A typo in
jaws.c was fixed as well.

2010-11-08 23:03:13 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix for safeStrCpy patch for XBoard

By a trick (temporarily redefining safeStrCpy in common.h as
((char*) (a=1/(4-3rdArgument))) ) a compile-time warning (division by 0)
could be generated for every occurrence where the size argument was equal
to 4, i.e. where the 1st argument was likely a pointer rather than an
array. These cases are now fixed. The file xoptions.c, which is the
only ne that does not #include common.h had to be fixed by making
the #define in the file itself.

2010-10-31 13:16:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix spurious promotions with legality testing off

The recent promotion patch had broken playing without legality testing
completely: without legality testing one always gets the piece that was
asked for, but a NULLCHAR should not be taken as a request for a piece!
But it was, and this resulted in any moved piece turning into a white
Pawn! For true promotions the piece was always black, which was also not
very useful.

Also revert to the use of '+' as internal Shogi promoChar, because
pre-processing turns out not to be possible when reading a game file.
In stead parse any trailing '+' on moves as promoChar. Downside: '++'
can no longer be recognized as checkmate symbol.

2010-10-29 22:54:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make deferral default in Shogi promotions

Because '+' is intercepted by the parser as check indicator, Shogi moves
are pre-processed to change a trailing '+' into an internally used
alternative '^'. The testing if a promotion character is OK is now done
in LegalityTest() and Disambiguate(), which return ImpossibleMove when
the character does not correspond to any piece, and IllegalMove when in
Shogi anything other than '^' or '=' is used. (Except for the ICS
notations.) On output, in CoordsToComputerAlgebraic() and
CoordsToAlgebraic(), the '^' is translated back to '+'.

2010-10-28 17:51:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Animate piece explosions in drag-drop moves and in XB

This required some code restructuring: the decision if an explosion is
needed is now taken in a new routine Explode() in the backend. This then
calls the front-end driver, and it returns the info if there was an
explosion or not, so the caller (AnimateMove() or the mouse driver) can
take action to repair the damage to the board caused by the blast wave.
A front-end driver for XBoard is provided as well, so that both
click-click (and replay, which is the same) and drag-drop atomic
captures are animated in XB as well as WB.
Explosions on rejected moves are suppressed.

2010-10-28 13:53:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress promotion popup if piece will explode

In atomic, a Pawn capture to last rank is not really a promotion.
Fix choice to Queen.

2010-10-28 18:42:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make Knight hop first straight, then diagonal

It used to be the other way around, which looked pretty illogical in
Xiangqi: to see Horses, which are blockable pieces there, move over an
occupied square.

2010-10-27 20:04:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let -oneClickMove also work in EditGame mode

There is really no reason why people that lke one-clcik moves enough to
switch them on would not want to use them too when editing a game.
This solves a nast inconsistency, as before it used to work in -ncp mode
on the _first_ move, as the mode is then BeginningOfGame, and not yet
EditGame, and we do want it to work for BeginningOfGame, as this is
also the game mode when you start playing as white.

2010-10-27 19:40:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make -flipBlack and -allWhite option volatile

As these options are very Shogi specific, and the variant is volatile,
it seems logical to make them also volatile. Not completely sure about
-allWhite, though. It cold be useful if you want, for example, to play
wth dark-brown pieces for black, as any color but black looks much
better with outline pieces than with solid pieces.

2010-10-27 19:33:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Provide some sample board-texture pixmaps

Wood and marble themes are provided as textures for light and dark
squares, plus two complete Xiangqi boards (wood and evenly colored).
These should probably not goint the distro tar ball.

2010-10-27 19:25:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
The -overrideLineGap option is made to work in XBoard

Although XBoard already allowed this in the -boardSize specification,
it is still seful to globally disable grid lines, e.g. for an
oriental Xiangqi board. And it converges XB and WB.

2010-10-27 19:18:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement board textures in XBoard

The -darkBackTextureFile and -liteBackTextureFile options now wrk in
XBoard too, for loading a pixmap that will be used to cut out the dark
and light square backgrounds. The cutting algorithm is such that the
pixmap image is completely restored if the size was that of the total
board (e.g. a drawing of a Xiangqi board).

2010-10-27 12:11:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Complete WB (western) bitmaps for Shogi at size 33

The Lance was not replacing Queen in some sizes where the bitmaps were
already available, and new bitmaps for the promotion Golds were added.

2010-10-22 20:30:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make starting new variation dependent on shift key

The shift key is read during mouse events, and posted in a global
variable, which can then be used by the back-end. The decision to start
a new variation (pushing the game tail rather than clipping it off) when
entring a move in Edit Game or Analyze mode is made dependent on this.
The move-typein also records the shift-key state.

2010-10-22 20:25:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix merging bug

A %g format was used to print an int in sending the level command,
because decimal points were dropped when merging patches. Also an unused
variable was removed to suppress a warning.

2010-10-18 19:50:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add set of shogi pixmaps for XBoard

The -size 64 pieces from gShogi (and originally XShogi) are made
suitable for loading by XBoard, through redefining the transparent
background color as either light or dark square color. These bitmaps are
not included in the XBoard build, and perhaps should not even be
included in the source distribution, but made available in a separate
distribution?

2010-10-18 19:46:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement -flipBlack in XBoard

When -flipBlack is true, the white and back piece pixmaps are swapped in
flipView. The idea is that the black pieces are upside-down versions of
the white (Shogi) pieces, so that swapping white and black in effect
turns all pieces upside down, which is what should happen in flipView.

2010-10-11 21:06:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Disable some very verbose debug printing

The internationalization seems debugged enough to do without them.

2010-10-11 20:52:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add option -variations to control variation-tree walking

Just so that users can switch it off if the find it annoying.

2010-10-11 21:01:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow full promotion suffixes on SAN piece moves

This facilitates the parsing of (non-standard) Shogi moves in ICS
protocol. It can also be useful for Seirawan Chess, where a future
implementation of it can use promotion suffixes to indicate gating.

2010-10-11 14:07:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow lower-case piece indicator in drop-move notation

As it seems that XBoard also sends such moves in zippy play, it seems
more fair to recognize them from the engine as well.

2010-10-10 21:26:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in ICS variant switch for Shogi

Because a test for 8x8 variants was done by <= VariantShogi,
rather than <, spurious move-list fetching occurred in Shogi.

2010-10-10 21:23:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WinBoard Lance bug

The choice between Lance and Queen was made on appData.variant, in stead
of gameInfo.variant. Because of this it was not always up-to-date in ICS
games.

2010-10-10 21:15:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt WinBoard to Shogi implementation on Variant ICS

The Variant ICS does not use the '+P' notation for promoted pieces,
neither in the board, nor in SAN, but simply indicates any Gold by 'G',
and uses 'H' and 'D' for +B  and +R. The Shogi promotion code in
LegalityTest() and Disambiguate(), which are used in move Parsing, are
adapted to handle this. Deferred promotions sent to the ICS now use an
== suffix.

2010-10-10 21:07:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Inherit promoted-info that ICS does not give from previous board

The ICS does not tell us in Crazyhouse (or Shogi) if a piece is
primordial or a promoted pawn (or a promoted other piece). We now derive
this info from the previous board. The option -disguisePromotedPieces
controls this feature.

2010-10-10 21:03:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Limit multi-session clock handling to non-ICS games

In ICS games a time forfeit crashed XBoard, apparently because the
fullTimeControl string is not properly set when we try to use it to see
if a sudden-death session is indeed the last session.

2010-10-08 11:47:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Change evalgraph scale in drop games

Score swings tend to be much larger in Crazyhouse and Shogi, so the
vertical rangee in those games is doubled to (-14, 14).

2010-10-13 23:05:05 -0700 Arun Persaud <arun@nubati.net>:
bugfix: fixed readline support with icslogon option

The icslogon option sends the login and password, so we don't need to handle
special cases for the readline buffer.

2010-10-07 20:35:26 -0700 Arun Persaud <arun@nubati.net>:
fixed some typos that were introduced during the sprintf->snprintf changes


2010-10-07 11:59:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix uninitialized variable in book code

The variable ' power' was used uninitialized in case -bookVariation was
set to 0, which can be an error even if it was only multiplied by zero.

2010-10-06 14:20:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix menu translation bug

The menuText array was declared too small, so that the last entry of the
File menu got out of bounds and was overwritten by the first of the Mode
menu.

2010-10-05 21:14:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow -timeIncrement to be a float

The increment can now be fractional seconds. The printing in
ParseTimeControl() and SendTimeControl() is done with %g format, so that
for integer increment there is backward compatibility with the old level
command.

2010-03-30 20:24:49 -0700 Arun Persaud <arun@nubati.net>:
adding gnu-readline support

should make the user interface for xboard a bit nicer. In the end we want to have a separate input window, but this probably will have to wait until the GTK version.

2010-09-24 21:17:50 -0700 Arun Persaud <arun@nubati.net>:
added warning if icsLogon file couldn't be opened


2010-09-24 21:10:28 -0700 Arun Persaud <arun@nubati.net>:
security fix: replaced some strcat with strncat

there is still more to do

2010-09-19 20:55:01 -0700 Arun Persaud <arun@nubati.net>:
add option for silent builds

this can be enabled for automake versions >1.11 by calling ./configure --enable-silent-rules.
It should still work for older automake versions too

2010-09-19 13:16:40 -0700 Arun Persaud <arun@nubati.net>:
bugfix: missing array index


2010-09-19 12:19:44 -0700 Arun Persaud <arun@nubati.net>:
added new case for (Chessmove) 0 in common.h

this cleans up a few more -Wall messages

2010-09-17 21:47:22 -0700 Arun Persaud <arun@nubati.net>:
cleaned up -Wall warnings (apart from settings some parentheses)

removed unsused variables, etc mostly everything from -Wall -Wno-parenthesis

2010-09-17 20:36:54 -0700 Arun Persaud <arun@nubati.net>:
sizedefaults has 9 members, the last line of the array (NULL) only set 7.


2010-09-12 20:04:03 -0700 Arun Persaud <arun@nubati.net>:
security fix: replaced sprintf with snprintf

replaced most sprintf with snprintf. There are still some left where for example a pointer is used and is allocated in the line before, which should be fine... and some others.

2010-09-10 23:36:23 -0700 Arun Persaud <arun@nubati.net>:
security fix: replaced strcpy with safeStrCpy from backend.c

see comment in backend.c on how to use safeStrCpy. This was already added by AS, but only used in 3 places.

2010-10-04 11:50:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Enhance multi-session TC clock handling

Some new TC types are introduced: Bronstein and free sessions. The
former is implemented by letting an exclamation point '!' in front of an
increment (in the -tc string) indicate that the increment is limited to
the time actually used on the previous move. The latter is an interval
of given duraton in which you can do any number of moves (even zero),
before the next session starts. This is needed for implementing Shogi
byoyomi-type TC, as a first session, followed by a session of fixed-time
per move. The latter can now be specified with the -tc argument as a
degenerate case of Bronstein, where the time on the clock is <= the
increment (so that it is never possible to think longer than the
increment). A TC of 5 min + 10 sec byoyomi can then be indicated as
300:10+!10.

The sessions are now separated by ':' in stead of '+', and all times in
the TC string are converted to seconds first (in ParseTimeControl), so
the fullTCstring can now be directly used in a PGN tag.

Note that this patch only addresses clock handling; the engine will not
be informed yet if the TC type or parameters change at the start of new
session!

2010-10-04 09:32:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove promotion-piece encoding from ChessMove type

The shizophrenic way to indcate promotion pieces in the XBoard code
(sometimes using a promoChar, at other times relying on moveType) was
cured by combining all promotion move types (such as WhitePromotionRook)
into a single one (WhitePromotion), and relying on promoChar to specify
the piece. This solves the problem of promoting to new piece types in
variants, which formerly also required addition of new move types.

In Shogi the '+' character is now consistently used to indicate
promotions (and recognized in ApplyMove), rather than 'q' or
PieeToChar(BlackQueen), as the latter did not work in minivariants where
the Queen (representng the Lance) did not partcipate.

2010-10-03 20:50:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Pass promoChar to SendMoveToICS

SendMoveToICS was the only place where the promotion piece was derived
from moveType, rather than an explicity passed promoChar.

2010-10-04 09:41:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress spurious use of SAN castling in mini variants

King moves from a central file to the king-side-castled position (1
square away from the right corner) were intercepted and printed as O-O
in CoordsToAlgebraic. But on a 5x5 board (mini-Shogi!) this caught the
normal King move Kc1-d1 as well. The castling notation is now reserved
for King moves larger than one step.

2010-10-04 08:21:19 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make Shogi promotion zone board-size dependent

In stead of using a fixed size of 3 ranks, we use BOARD_HEIGHT/3, which
would translate to 1 rank for mini-Shogi (5x5) and 2 ranks for Judgkin's
Shogi (6x6), which are indeed what these variants need.

2010-10-03 19:58:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make board-size overrule options volatile

The options -boardWidth, -boardHeight and -holdingSize were legacies
from the day choosing a variant would not automatically set a board
size. As a result they are seldomly used anymore. The first real
application is mini-Shogi (on 5x5 board), and it turned out very
annoying if the 5x5 settings persisted to the next session, where you
almost certainly want to play another variant.

2010-10-04 09:16:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Strip DOS line endings from parser.l


2010-09-16 18:58:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Extend mate test to drop games

MateTest() in case of no legal moves now also looks if there are legal
drops that can resolve the check. This provides reliable mate testing in
Crazyhouse and Shogi, so these are now made subject to adjudications too.

2010-09-16 18:48:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Extend legality testing to drop moves

LegalityTest() can nowbe called with (internal-format) drop moves, and
delegates their testing to a new routine LegalDrop(). This routine
performs the 'no-pawn-on-back-rank' test that used to be in
UserMoveTest (which now calls LegalityTest also for drop moves).
The more complex Shogi case is also handled (except for Pawn mate
drops) in LegalDrop().

2010-09-16 18:25:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Revert splitting of UserMoveEvent

This splitting into UserMoveTest and FinishMove was no longer needed,
now that the new mouse driver no longer calls UserMoveTest to figure out
if a move is a promotion, and XBoard and WinBoard are unified in this
respect. It was counter-productive, because UserMoveTest was not able to
change the fromX, fromY (call-by-value) parameters for passing them to
FinishMove, so it had to defer the conversion of drop moves to internal
format to the latter, while it did not belong there. (Because
DropMenuEvent already delivers the moves in internal format.) This
whole kludgy construction was therefore abandoned, by going back
to the original 4.2.7 calling scheme, where UserMoveEvent completely
pre-processes the move, and when it is valid, calls FinishMove directly.

2010-09-16 18:02:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix silent bug in drop moves

In ApplyMove() the piece on the from square was accessed and used before
we tested for drop moves. As drop moves have off-board from-squares this
led to out-of-bound array access, which apparently was usually harmless.

2010-09-16 17:43:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow parsing of upper-case machine moves

Dubious patch, as it caters to non-compliancy. Some variant engines are
very non-compliant, though.

2010-09-16 17:38:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Prevent transmission of spurious promo char to other engine

The parser now strps off spurious promotion characters.
New move types "White/BlackNonPromotion" had to be introduced for this,
to indicate NormalMoves that could have been a promotion, to make sure
the '=' suffix of Shogi deferred promotions survives.

2010-09-16 20:44:37 -0700 Arun Persaud <arun@nubati.net>:
fixed internationalization for winboard

in the original commit some files were forgotten. This should fix it.

2010-08-29 21:07:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix JAWS bug saying side to move in ICS play

This was done the wrong way around.

2010-08-27 14:08:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make WB run-time language switch possible from menu

This is a rather involved patch that might not be worth it. It is
difficult, because translation of things that live forever is not easy
to invert (menus, the auxiliary windows). We hae to remember all
original, English texts there to be able to put them back,or
re-translate. Still does not fully work, although the menus and
temporary dialogs now are all OK.

2010-08-27 14:35:46 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update WB translation template

The language.txt file now also contains all translatable strings from
the C source files, rather than jsut the resource.

2010-08-27 14:14:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update docs

Add descriptions for machine-match menu support and enhanced book
control, nick-name options and language.

2010-08-27 13:59:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add some forgotten translation hooks

The general-options, file-browse dialogs and the about box did not call
Translate() yet. Also translate contents of combo boxes. Some small bug
fixes.

2010-08-27 13:28:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Do not translate game-end messages in PGN

The messages themselves are not subjected to _(), but in stead their
displaying in DisplayMove is subjected to T_().

2010-08-23 13:23:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Internationalization for WinBoard

A function Translate() was added, which uses a list of item dialogs,
reads their value, and replaces it by a translation (if available). It
also reads the window title and sets a translation. Calls to this
routine are added in the initialization code of every dialog callback.
In addition all translatable strings in the WnBoard front end are marked
by the gettext macro _(). Because WB is not gettexted yet, a hard
re-definition of this macro is added in each file using it, to the
string-translation routine T_() supplied in winboard.c.
Code to read the translation file, and translate the menu texts is added
in winboard.c. In backend.c the meaning of the gettet macros is
redefined for the WIN32 case.

2010-08-23 13:07:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make the ID of all WB dialog items unique

Mnany static dialog texts did share the ID -1 (IDC_STATIC). But to
replace tet at run-time for translation purposes, they need to be
addressed individually. So they were given new IDs, with symbols defined
for those.

2010-08-23 12:48:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Mark XBoard result messages for internationalization

The GNU gettext macro _() is used with the game-end messages. This might
be controversial, as they will appear in the PGN as well. But only as a
comment. We can always decide not to supply a translation.

2010-08-23 12:43:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Do not exit after match when match started from menu

The codelooks weird, but matchMode == 2 in this case. We then use
DisplayNote() to report the match result.

2010-08-23 12:39:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Trivial-draws recognition improved in Xiangqi

Now based on a routine "SufficientDefence". If both have it, it is draw.

2010-08-20 17:46:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update .dev files

The relocation of parser.c and the addition of history.c was not yet
incorporated in the devcpp proect files.

2010-08-19 13:45:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some MSVC compile errors

Some statements has moved up stream of declaratons, which is an error
that gcc is forgiving about, but where MSVC is strict.

2010-08-14 14:01:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Improved patch for expansion of WB settings-file name

The expansion of environment variables now allows multiple environment
variables in the path name. Tested on %HOMEDRIVE%%HOMEPATH%\winboard.ini
and %APPDATA%\winboard.ini.

2010-08-07 16:53:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -colorNickNames option

This option allows non-standard designation of side to move in FENs.
(Useful for Xiangqi, where white is indicated often as r(ed), and Shogi,
where white is s(ente) or b(lack), and black is g(ote) or w(hite).)
Can also be used for FENs in a local language. A match of theinput
character with the nick name translates it to the standard; this means
the standard will continue to be recognized, unless it was defined as a
nick name.

2010-08-07 16:39:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Tricked by the grossnes

Some WB menu items were referenced by a hard number. As items had been
added over the years, the wrong menu items were grayed. In particular
the Options -> Adjudication menu was grayed out, in -ncp mode, where
this was intended for the Sounds dialog. This accidentally proved
useful, until we started to apply adjudictions also to the Human moves.
Then it was suddenly undesirable, and a small mystery why it happened at
all, when I tried to change it. The numbers are now corrected to the new
locatons of the items in the menus.

2010-08-07 16:35:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow match to be started from WB menu

A menu item Machine Match was added in the Mode menu to switch to
matchMode. A persistent option /defaultMatchGames determines the number
of games. A control was added to the Options -> Common Engine dialog to
set this option.

2010-08-07 16:26:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add some book-control options

Options /bookDepth and /bookVariation have been added to control the use
of the GUI book. In WinBoard the Optons -> Common Engine dialog now
contains fields to set them.

2010-08-07 00:15:57 -0700 Arun Persaud <arun@nubati.net>:
new developer release


2010-08-06 11:18:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Repair exit-popup deadlock patch

Relocating the exit popup call had made it lose access to the message it
should print, because it was declared only in an inner code block, by
the same name: buf[]. Deleting the inner declaration fixes it.

2010-08-04 11:00:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix erors when compiling with --disable-zippy

The file args.h contained a codeblock in #ifdef ZIPPY, in stead of
fields.

2010-08-01 13:27:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix zippy handling of draw offers from ICS

The patch by DM to fix the problem introduced by the coloration of
zippy-matched commands (namely that the coloration code beat the zippy
draw recognition to it, and ate the draw offer away) was only targeting
ICC. The new fix should work on any ICS (by using the same pattern in
zippy as in the colorization code).

2010-08-01 13:15:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix regression in colorization of zippy-matched commands

The patch by Daniel Mehrman from 4.2.pre8 was not properly merged, so
that in XBoard no coloration would take place of ICS commands that were
matched by zippy. (It was using &i as input pointer, rather than &backup.
The XBoard-specific code now has been deleted completely, to remove a
seemingly needless dependence on _WIN32_ of the back-end. Both WB and XB
now use the XBoard method, to only match zippy commands when logged in.

2010-07-31 22:48:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suggest default file name in browser dialog

The argument 'def' to FileNamePopUp() was not passed through to the new
file-browser routine, which got NULL in stead, and thus started with an
empty input field.

2010-07-30 23:28:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Define /firstUCI and /secondUCI as synonyms for /fUCI, /sUCI

Because the %s expansion of WB options in the /fcp and /scp lines only
works for options that contain 'first' or 'second', and /fUCI thus did
not work, PSWBTM had to rely on the cumbersome /firstIsUCI=true to
install UCI engines. (The latter option should be deprecated really;
the UCI-ness of the engines is a volatile option, so it makes no sense
to supply a way to set them both to false or true. One only needs to be
able to set it to the non-default state.)

2010-07-30 23:21:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add string option /pieceNickNames

This (volatile) option allows definition of alternate letters for the
pieces, which will be recognized next to the standard symbols as given
in the /pieceToCharTable on input. (Output always uses the standard.)
This can be useful for reading PGN from another language, or
non-compliant FENs (e.g. using B and N for E and H in Xiangqi).
  The format of the argument is the same as for /pieceToCharTable.
Because the nickNames are consulted before the standard table, it is
possible to redefine a standard name as a nick for another piece.

2010-07-30 23:10:42 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix deadlock in match-result display

At the end of a match, GameEnds() was recursively calling itself,
through DisplayFatalError() and ExitEvent(), and the latter was then
delaying until the calling GameEnds() terminated. (Which it would of
course never do before ExitEvent returned; fortunately there was a tim
limit to this delay, but in XBoard it was 10 sec in stead of 10 msec.)
 Now the calling of DisplayFatalError() (to show the result popup) is
delayed until after GameEnds completes (and resets the anti-recursion
flag 'endingGame'), so that it is simply executed a second time, unaware
of the earlier call. But this second time it does not do anything,
because the gameMode ws set to EndOfGame the first time, and the writing
of the PGN is blocked by the checksum being still the same.

2010-07-12 11:10:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WinBoard game-list title

Number of displayed games and WDL stats were always appended to the
existing title, leading to an ever-growing title in the game-list
window. Now the old actual title is ignored, and the starts is appended
to the original title "Game List". (In the future we could use the
filename here?)

In addition, the title was not updated when re-opening the game-list
window, while the stats could change if filtering was active when the
window was closed. (In that case the filter is cleared on re-opening, so
the number of displayed games changes.) Now a title-update (after
recalculating the stats) is done every time the game-list window is
opened.

2010-07-11 11:06:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Refactoring of material-draws adjudication code

Insufficient mating material is now determined per side individually, by
testing for MatingPotential of each side. If both lack mating potential
the game is adjudicated as draw (if the -materialDraws option is set).

This way MatingPotential() can later also be used to correct losses by
forfeit to draws (which currently is only done when the opponent has a
bare King).

The accuracy of this type of adjudication in Xiangqi has been highly
improved.

2010-07-11 10:54:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in sending cores command to engine

The cores command was alwas sent to the engine(s) when the user changed
it through the menu, even when the engine had sent feature smp=0 (which
is default anyway). NewSettingEvent() was patched to send the new
setting conditionally, based on the engine properties as recorded in
ChessProgramStates first, second; In this particular case it now
consults cps->maxCores. (Note the code for testing the second engine
contains some dirty pointer arithmetic.)

2010-07-11 10:42:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix oneClickMove bug

When checking for unique captures, no attention was payed to the option
setting, so the capture was also made when the option was off.

2010-07-11 10:39:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove duplicate testing for cores feature

The testing for this BooleanFeature occurred twice.

2010-07-11 10:35:13 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove misspelled prototype

NewSettingEvent occurred, next to the correct one, in misspelled form.

2010-07-05 10:00:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parsing of SAN shogi promotions

A missing promotion character defaults to promotion in the move type,
but the promotion character was not set when this happened in variant
shogi. And it is especially important there, as the promotion character
'+' will always be missing, as the parser will take it to be a 'check'
symbol, and strip it from the move.

2010-07-05 09:55:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix variant switch on PGN loading

When the PGN specified an essentially different variant, the
piece bitmaps were not properly adapted, because the switch was done by
calling InitPosition(), rather than Reset(). (The latter would destroy
the PGN tags info.) We now added an explicit call to ResetFrontEnd(),
(which is normally done from Reset()).

2010-07-05 09:51:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Adjudicate Xiangqi material draws with Advisor-less Cannons

Used the Queen counter for counting Cannons. Note that material draws
with stale Pawns (i.e. on the back rank) are not yet adjudicated.

2010-07-05 09:34:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove font settings from master settings file

xboard.conf should not contain general font settings (not specific to
one board size) with specified point size. In fact it should not even
specify sizable fonts, as the new system would make specification of a
general font overrule the size-specific settings in the .xboardrc file,
so the persistence of fonts would be completely broken.

2010-06-30 10:52:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Cut board squares out of texture bitmap more cleverly

When the bitmap is larger than the entire board, the squares are now cut
out of the center of the virtual squares from subdividing the bitmap, so
that they stay centered on the grid of a Xiangqi board bitmap. If the
board size exceeds that of the bitmap, the old algorithm is still used,
as the centering would make the edge squares exceed the bitmap, and
cause a black rim around the board.

2010-06-30 10:49:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow -flipBlack to work with font-based piece rendering

In addition the font-based pieces will also be flipped vertically in
flipView for variant shogi when -flipBlack is off.

2010-06-30 10:46:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow font-based piece rendering in board sizes below petite

At least for variants that use unorthodox pieces, so that switching back
to using bitmaps is not really an option anyway.

2010-06-30 10:41:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Ignore checks in 50-move count for Xiangqi

Both checks and evasions are discounted; this is only done after the
naive counting exceeds the maximum, so during most of the game it causes
no CPU load.

2010-06-05 14:38:47 -0700 Arun Persaud <arun@nubati.net>:
removed some garbage from configure.ac that got added a while ago


2010-05-25 21:20:27 -0400 Clint Adams <schizo@debian.org>:
Remove unnecessary double equals from configure.ac.


2010-05-28 11:07:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix e.p. bug in xiangqi with -serverMoves option

Sideway Pawn moves were written as e.p. captures in the file with moves,
which led to disappearence of pieces in the viewer.

2010-05-28 11:05:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Repair score printing with -serverMoves option

A previous patch had moved MakeMove to before the update of pvInfoList,
so that the score/depth info would not appear in the file with moves.

2010-05-28 11:02:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Repair animate dragging

The previous patch had left a stray semicolon in the mouse handler.

2010-05-10 10:32:19 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix game end during dragging

The stale-first-click fix interfered with proper handling of a piece
being dragged when a game suddenly ended (because of opponent resign,
or caling the flag), because up-clicks when the from-square was reset
were completely ignored. Now such an 'unmatched' upclick calls
DragPieceEnd() and redraws the board.

2010-05-10 10:09:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Pop down old tags on loadng new game in WinBoard

ResetFrontEnd(), called from Reset(), did not do this in WinBoard
(unlike XBoard), so that the tags from the previous game were left on
display when -autoDisplayTags was off.

2010-05-09 22:15:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reverse mousewheel action

Apparently WinBoard was stepping in the opposite direction through the
game in reaction to the mousewheel as every other GUI in existence.

2010-05-09 22:07:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in sending "usermove" when forcing book moves

The keyword "usermove" was copied to the buffer, but not sent before it
was overwritten by the actual book move.

2010-05-06 17:23:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix engine stall on perpetual-check evasion

The adjudication code had already put the engine in force mode after
postponing the actual adjudication to the next move. Now first determine
if we want to adjudicate now, and with which result, before stopping the
engine and ending the game.

2010-05-06 16:37:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let move parser return ImpossibleMove for off-board moves

It used to return 0, which interfered with buiding a game list. This
broke reading of multi-game PGN files containing games in a variant with
a board size larger than that of the currenty active variant.

2010-04-06 15:05:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Alter XBoard key bindings to mimic WinBoard

A lot of new bindings were added, and four menuProcs had to be registered
to be able to add bindings to them. The use of the control key as
temporary take-back for the last move conflicted with the use of Ctrl
keystrokes, and this function was migrated to '.'. The iconify function
had no shortcut in WinBoard, but to get rid of letter bindings it was
migrated to '-'.

2010-04-05 20:45:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update README file


2010-04-03 14:00:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix typos in html help file


2010-04-01 15:22:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix JAWS piece drop cursor, and streamline some sentences

The cursor square was reset to a1 after every use of the piece menu,
which was very inconvenient. Some of the spoken sentences have been
improved; the square is read before the piece now, when using the arrow
keys on the board.

2010-03-31 22:31:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow escape sequences in telluser(error) messages

The routine EscapeExpand was moved to backend.c, and applied to the
message received from the engine.

2010-03-31 21:29:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow lower-case promochar in moves of type h8=Q

Updated the parser rules. Other move formats already allowed this.

2010-03-31 21:36:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Alt+M JAWS command in Two-Machines mode

The command refused to read the ast move because it contained thinking
output of the other engine. Let it pay attention to evenIfDuplicate.

2010-03-29 09:57:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix rep-draw recognition

The refactoring had broken the rep-draw recognition, by adding and extra
condition in a conditional with side effects. The testing of this extra
condition is now moved to after the side effect.

2010-03-28 12:32:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow any %ENVIRONMENTVAR% in WB settings file name rather than ~

Only a single variable at the beginning of the file name is recognized,
and the matching is not fool proof (it matches across backslashes).

2010-03-28 11:24:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix info lines being used as normal thinking output

The new standard of using thinking output with time = nodes = score = 0
as info messages for printing in the Engine-Output window was not
understood everywhere, and led to such info lines being used for
autoKibitzing and PGN annotation. The programStats are now only updated
from thinking output received from an engine when it is not an info line.

2010-03-27 11:54:41 -0700 Arun Persaud <arun@nubati.net>:
new developer release


2010-03-26 21:16:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress background observe for boards with own game number

This is really a work-around for an ICS bug. The Variant-ICS sent the
initial board of a game in a move list with relation = 0, which means
'observed'. So XBoard was thinking it was observing its own game, and
switched to dual board. It seems harmless to suppress such a switch for
all boards of your own game, however, which is now done.

2010-03-26 21:12:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on switching to ICS xiangqi game

The oldBoard was a local variable, and only squares of the old board
were initialized. This led to a crash if the copied board was enlarged,
and then displayed. The variable is now declared static, so the
uninitialized squares contain harmless zeros.

2010-03-26 18:32:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let Chat Boxes pop up above console, rather than on top of it

Use EnsureOnScreen() to have them overlap if there was no room.

2010-03-26 18:26:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix disabling of Chat Box navigation buttons

The buttons for non-open boxes were enabed, rather than disabled.

2010-03-26 18:17:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Prevent <Esc> closing chat box

Let it in stead switch focus back to the console window.

2010-03-26 15:28:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let WinBoard recognize ~ in settings file name as HOMEPATH

Fetch the appropriate environment variable to build the mathname in
MySearchPath() whenever the file name starts with "~\".

2010-03-26 13:59:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change name of Global Settings menu item to Common Engine Settings

The old name confused ICS users, as this is an engine-only dialog.

2010-03-26 13:58:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update WinBoard RTF docs


2010-03-26 13:57:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update WinBoard html help


2010-03-24 18:00:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow adjustment of clocks in any mode with shift+click

In practice changing to edit-game mode during a game was very
cumbersome. In WinBoard shift+click is now offered as an alternative.
Make sure a right-click in the clock area is not also counted for other
purposes.

2010-03-24 17:21:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow loading of PGN variations in XBoard

Right-clicking variation comments in the comment-window was implemented
through a translation. The right button is now bound to routines that
set both the end and start of the selection, as setting a new start does
not seem to work if the previous select-start was not completed by a
select-end or extend-end. Finally the main handler uses the selection
cursors to know what was clicked.

2010-03-24 17:16:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update XBoard docs

Added a descripton of the new ICS options (seek graph, back-ground
observe) and menus (Upload) to the texi file. Also added a description
of the variation (Annotate menu item and PGN variation comments) and PV
walking (clicking engine-output). Describe the -shuffleOpenings option.

2010-03-24 13:30:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Paint highlights on dual board (WB)

The highlight info is hidden in the partner board to pass it to the
front-end.

2010-03-24 13:14:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix handling username change during game

The title bar and gameInfo (going into the PGN) were not adapted when
the username was changed through the menu, so that the change became
only effective on the next game. Requires SetGameInfo to be called from
the front-end, and thus a prototype for it in backend.c.

2010-03-24 11:04:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix window-position upset on failing engine start in WinBoard

The main window was only positoned according to the settings-file data
after the engine was started up from InitBackend2(), so that if the
latter gave a fatal error, and Save Settings on Exit was on, a wrong
position for the main window would be saved. The call to InitBackend2()
is now moved until after setting the main-window position.

2010-03-23 23:22:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Display PV from Engine-Output window (XBoard)

Translations are added to bind button 3 to the PV walk for the memo
widgets, and the corresponding handlers are ported from wengineoutput.c.

2010-03-10 18:54:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Set keyboard focus at startup to board window

This makes XBoard sensitive to the keybindings also when the cursor is
outside the board window. This focus seems to persist indefinitely: each
time the board window gets selected, the key bindings become activem
wherever the mouse pointer is. Downside: the mouse pointer is no longer
an arrow outside the board window, but becomes a text-insert tool there.

2010-02-27 20:49:21 -0800 Arun Persaud <arun@nubati.net>:
added logo files for xboard

logos are installed in the hicolor theme [1] using $datadir as the basedir.
Added both png and svg logo.

[1] http://standards.freedesktop.org/icon-theme-spec/icon-theme-spec-latest.html

2010-02-27 17:36:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remake programVersion string after receiving engine features

The engine could have sent a more accurate version of its own name
than the one derived from the exe filename in a myname feature, and we
better use that in the programVersion string, which will be sent as
interface name to the ICS.

2010-02-25 19:22:00 -0800 Arun Persaud <arun@nubati.net>:
Revert "Repair settings-file name"

This reverts commit a02042ef83ce1f3632f0cf3e0a2a4ce9a3ac5d85.

2010-02-25 20:32:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add -autokibitz checkbox to UCI-options menu dialog


2010-02-25 20:29:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Also capture (numeric) whispers of players for -autoKibitz


2010-02-25 20:25:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add kibitzes and c-shouts Chat Box

A box dedicated to c-shouts will snatch any c-shout before it is
diverted to a normal shouts box. The kibitzes box can capture the
left-overs of -autoKibitz, if the latter is active.

2010-02-25 15:45:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Mark non-compliant lines of engine in debug file

The option -engineDebugOutput is extended to accept value 3 for printing
a cear indication of non-compliancy in the debug file.

2010-02-25 12:02:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redraw second board on expose events

The -dualBoard option now does refresh the second board after another
window uncovers it. To acheive this, some data structures remembering
what is displayed had to be duplicated. (lastBoard and damage for XB,
lastReq, lastDrawn, lastReqValid and lastDrawnValid for WB.)
WinBoard now uses clipping also for second board. This required the
clips for the destination to be translated horizontally!

2010-02-25 15:13:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Print seconds with 2 digits in backgroundObserve status line


2010-02-24 17:01:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Do not recognize non-ICS variants from PGN event tag

These variants were introduced after supporting the variant tag, so if
the variant tag is missing, their recognition from the event tag will be
a false match. (Mainly to prevent events with 'super' in the name being
recognized as Superchess.)

2010-02-23 13:52:51 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix display of uninitialized boards in background observe

A variable partnerBoardValid is cleared on starting our own game, and
set when a board from the background game comes in during it. At the end
of our own game, a valid partner board now is put in the display.

2010-02-23 13:46:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add option Display Logo in WB general-options menu

Changing the option requires InitDrawingSizes to be called for
re-formatting the board window. Switching it off requires clearing of
the cps->programLogo fields to take effect immediately. Switching it on
only takes effect the next session, as we will need some refactoring to
redo the figuring out what logos to display.

2010-02-22 12:02:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Group Chat Boxes with console in stead of board window

They now open and close with the console, which seems more natural, and
prevents the console from covering them.

2010-02-22 11:50:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put new options in WB ICS-options dialog

The Seek-Graph, background-observe and Chat-Box options are added to the
ICS options dialog. They only control the appData settings, there are no
special actions yet on switching the settings.

2010-02-22 11:46:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Create space in WinBoard ICS-options dialog


2010-02-20 12:42:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use side-by-side boards to display background game

A game observed in the background (i.e. if -backgroundObserve true) will
be displayed right of the normal board in the same window if the new
(persistent) Boolean option -dualBoard is also set.
Very flakey hack, especially in XBoard, where clocks and messsage
field all get the wrong width (and resist adjustment in the strangest
ways). The clocks of the partner game are not yet displayed, and
disaster happens when the background and foreground games do not have
the same board format.

2010-02-23 14:57:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Repair background-observe patch

Apparently a commit was lost that I collapsed with 3018a6 while the
latter was already pushed to savannah. Here I recreated this commit from
a diff between the respective commits in the savannah & nubati gits.

2010-01-31 11:07:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Repair settings-file name

The default name is put back to /etc/xboard/xboard.conf, so that XBoard
can again find its settings file. "make install" will still install it
in the wrong place.

2010-02-21 18:43:59 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-02-21 19:45:58 -0800 Arun Persaud <arun@nubati.net>:
fixed compiler warning for file-browser code

missing "void"s in the function declaration and missing returns showed up when trying to build on the opensuse build server. fixed now.

2010-02-21 23:09:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put newly opened Chat Box on top

Dialogs always pop up in front, so set the onTop variable that prevents
highighting the button to navigate to it from other Chat Boxes
to reflect that a newly opened Chat Box is in view.

2010-02-21 18:55:03 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix copying of kibitzed info in Engine-Output window

Make sure all lines end with "\r\n" to not lose line breaks on
copy-paste from the memo. (XBoard would strip those again.)

2010-02-21 18:25:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow walking a kibitzed PV

If no tabs are found in te 'thinking output' we assume it is a captured
kibitz message, and look for "PV=" to locate the start of a PV in it.
Also try to include any continuation lines below the selected line.

2010-02-21 17:45:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Insert autoKibitz continuation lines at end of line

In the engine-output window lines that start with the ICS continuation
sequence "\   " are inserted behind the line they belong to, in stead of
at the top. This required keeping thrack of the length of the currently
active line in OutputKibitz().

2010-02-20 15:39:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Don't disturb background observe when receiving new piece

When new holdings are sent when the background game is displayed, we now
ignore this, as presumably we are peeking at our partners game, and thus
should be well aware of what is captured there.

2010-02-19 21:52:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Newly lexed parser in XBoard directory


2010-02-19 11:18:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let yy_text determine progress of PV parsing

The parsed unit yy_text was not available after ParseOneMove(), because
the buffer switch in yylexstr() apparently destroys it. To solve that,
yylexstr() now is equiped with an extra buffer argument, where it copies
yy_text before the switch, so the caller, ParsePV(), can see what was
parsed in yy_textstr. This is used to update the PV pointer, but also to
save any parsed comments (when ParsePV is used for parsing a PGN variation).

2010-02-18 17:42:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Support playing through PGN variation comments

Right-clicking a variation line in the comment dialog will shelve the
current variation, and parse the comment to replace it. This uses
ParsePV() in an alternative way, for which the latter had to be
enhanced: it was made resistent to move numbers and comments inside
the PV. It now has an argument to indicate if such comments should be
stored with the moves. The Comment Popup is closed on revert, to
make sure no comments to moves that are destroyed, containing
variations on a non-valid line, can keep hanging around.

2010-02-18 16:05:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add Annotate item in Step menu

This does the same as Revert, except that it adds the destroyed
variation as comment to the original movem in PGN variation format.
RevertEvent now has an argument to indicate if it should add the
comment, or not. Comments in the abandoned variation are included in the
varriation command to the main line. (The exact layout of the variation
comment that results leaves still to be desired.)

2010-02-15 19:07:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add option -shuffleOpenings

This volatile option is added just to make the existing variable
available from the command line, not only from the menus.

2010-02-19 11:48:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let the sounds sound on receiving a message in a Chat Box

Use Colorize() to the applicable color to trigger the sound, and then
restore the original color as 'continuation', to do it silently.

2010-02-10 10:55:51 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow WB Chat Box to be dedicated to shouts and 'it'

By putting 'shouts' in the handle field, a chat window will capture all
shouts and c-shouts, and send messages typed into it as shouts.
The bracketing of the shouter name now indicates the type of shout.
The handle for WHISPER Chat Boxes has been changed to 'whispers', to
make it easier to pop them up by clicking the console.

2010-02-16 22:34:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add -chatBoxes option to open Chat Boxes at startup

This string option contains a semicolon-separated list of handles for
which Chat Boxes should be opened at startup. The value saved in the ini
file is the value that was read, not the actual chat boxes that were
open at the time of saving.

2010-02-16 19:44:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make Chat Windows pseudo-tabbed

By adding buttons in every Chat Box to navigate directly to every other
Chat Box, a stacked set of Chat Windows behaves like a single tabbed
window, but can still be unstacked. The buttons turn grey to warn that
new text appeared in hidden boxes (i.e. not the one last brought to top).

2010-02-19 21:46:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow arrow keys in WB Chat Box to access command history

The history is shared between al boxes and the ICS console.

2010-02-12 22:35:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make WB Chat Boxes wrap and handle URLs

Cloned the code for the console text field to hande URL. (Initialization
to recogize the link, and notifiction to open it when clicked.)
Removed the ES_AUTOHSCROLL style from the RichEdit in the resource.

2010-02-10 10:58:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix copying of WB Chat Window contents

All line breks were lost on copy-pasting the contents of a chat window.
Adding CR to each outputted line in the front-end (wchat.c) solves this.
(Tell messages sent to a handle (which are not echoed by the ICS, and
thus have to copied to the chat box directly) also need CR!)

2010-02-19 22:34:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add upload of game to ICS for examining

New item "Upload to Examin" in Action menu, calls UploadGameEvent().
Use SAN moves to upload game to ICS, rather than long algebraic
(The ICS did not understand long-algebraic promotion moves)
Use bsetup within examine to set position onFICS, and also variant.
Castling rights do not work yet for FRC. Totally different set of
commands are needed on FICS and ICC.
 FICS does not understand w23 or wild/23, but needs 'crazyhouse' in the
besetup command that specifies the variant. XBoard variant names are
used, except for fischerandom, which is 'fr'. Things like nocastle will
probably still not work.

2010-02-18 17:41:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Handle display of PV that starts with other move than played

Insert the retraction of the played move, without premove highlighting.

2010-02-16 19:36:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix smart capture

Disambiguate was changed to make sure that for ambiguous moves, a
capture would always prevail in the closure, rather than the last move
that happened to be generated. Before, double-clicking a piece would
sometimes plsy a non-capture.

2010-02-13 15:34:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix XB crash on giving keyboard focus to non-text widget

In the Engine-Settings dialog SetFocus() could be called for non-text
widgets, and this made XawTextSetInsertionPoint() croak. Setting the
insertion point to the end in SetFocus() was a bad ide anyway, as it
interfered with copying from the engine-output window, which would
uncontrollably scroll on getting focus. It is solved now by setting the
insertion point already on creation of the text widgets.

2010-02-19 22:32:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Seek-Graph bugfix: disappearing output in ICS console

Suppression of output to the cosole was handled fundamentally wrong: it
was not enough to set next_out to after the unit that should be
suppressed, as there can be a backlog in printing of previous units that
came in the same packet. So this has to be flushed first, or it will be
lost. -autoKibitz probably got away with that, because it comes in a
separate packet. But seek ads are often suffixed to other output, and
then that output disappeared! Now we flush everywhere before suppressing.
We now totally rely on the prompt to restart the printing, so that
acknowledgements following the echo of the sent message are also
suppressed. Also suppress LF before diverted chat messages.
  Also fixed is the 'mamer bug' in Chat Boxes, due to false parsing of
a "* (*): " pattern in tell messages, because of a missing continue.

2010-02-12 18:08:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Pop up ICS text menu with default item under mouse pointer

The menu popup is migrated to the down-click (was up-click), so the
up-click can select the item. Some trickery is needed to fool the menu
into thinking that the mouse moved, so that a moveless up-down click in
the ICS text field selects the default item (the upper-right one).
Also allow dummy item in ICS text menu: The command "none" in the ICS
text menu will now be treated as a grayed-out (disabled) entry, so it
can be defined in the position underthe mouse pointer to prevent the
up-click from doing anything, while keeping the menu open. Recommended
for use with an entry of spaces.

2010-02-10 14:42:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow ICS context menu to pop up a Chat Box on clicking handle

A command "chat" defined in the WinBoard icsMenu string will cause
ChatPopUp() to be called when it is clicked, with the clicked handle
(name) in the ChatPartner field, and focus on the input field.
ChatPopUp() had to get a parameter (the handle) to make this possible.
If that parameter is NULL (as when it is called from the Mode menu),
focus will still start on the (empty) ChatPartner field of the box.

2010-02-10 10:50:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix right-edge spillover of Seek-Graph dots in WinBoard

Rescale the X-axis to allow margin for dot size and color offset.

2010-01-30 11:05:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Interface XBoard to GhostView file-browser dialog

Note: The Ghostview dialog was using some deprecated variables for error
printing, and conditionally used getwd() on some systems that presumably
do not have getcwd(), but it did not assess the latter properly.

2010-02-09 14:38:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow recalling history in ICS input box with arrow keys

By adding translations for the Up and Down keys, and stealing some code
from winboard.c. Still needs some refactoring to move the duplicate code
to the back-end.

2010-02-09 14:34:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Start insertion point at end of text edits in XB dialogs

The function SetFocus now uses XawTextSetInsertionPoint to position the
end of the string it aready contains, rather than at the beginning.

2010-02-08 17:55:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Capture holdings of background observed game


2010-02-08 11:57:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Match handles with multiple titles for channel Chat Boxes

Only handles with at most one suffixed 'title', such as (U), (C), (IM)
or (TD), followed by the parenthesized channel number, were recognized,
so tells by people with more titles always went to the ICS console window.
Patterns are added to recognize handles with upto three such qualifiers.

2010-02-08 11:54:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Do not pop down Seek Graph on on-dot click

Leave the graph up, and let the incoming board of a started game cause
the pop-down. This in case the clicked ad is no longer vailable, or
manuay refused, and fails to start a game.

2010-02-07 21:26:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Observe a game in the background while playing

A new (persistent) option -backgroundObserve true|false is added. When
set, observed boards received while playing a game will not trigger a
game switch, but will be ignored except for storing in a dedicated board
buffer. Pressing the right mouse button will cause the board to be
displayed, until we release it. Time, strength and stm are always
displayed in the message window.

2010-02-07 16:43:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove race condition in clock switching

The move number is now incremented inside SwitchClock, when no timer
interrupt is scheduled, so the interrupt cannot occur at the wrong side
of the increment, and decrement the wrong clock.

2010-02-07 11:53:03 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let second click on piece make only capture, with -oneClickMove

Normally this would clear the highlighting of that piece.
Required new field in DisambiguateClosure to count nr of captures.

2010-02-07 11:18:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix stale first-click

When the opponent resigned after the user had cicked a from-square,
clicking the from-square for the first move in the next game would
produce an "illegal move" message, because it was considered a to-click!
We now set fromX and fromY to invalid in GameEnds().
Should we also reset them on mode changes?

2010-02-07 11:08:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add promotions and e.p. to oneClickMove

For e.p. the to-Square of the Pawn has to be clicked. Promotions are
always to Queen when you click the to-square, but use the promotion
pop-up when you click the from-square.

2010-02-07 10:38:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix error that compiler does not notice

Boolean GLT_GetFromList did not return a value. But no error on Ubuntu!

2010-02-06 18:55:38 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-02-06 18:30:42 -0800 Arun Persaud <arun@nubati.net>:
updated year in copyright info


2010-02-05 22:27:51 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
One-click moves

Playing on ICS or against engine, clicking a square from or to which
only a single move can be made causes the move to be done, when the new
option -oneClickMove is set to true.

2010-02-04 16:09:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use squares for computer seek ads

Shape indication passed in sign bit of color (char) variable.

2010-02-04 22:46:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use right mouse button to view seek ads

Right down-click does the same as left down-click, right up-click
simulates a left up-click off board (so it misses all dots).

Use right-click miss to refresh Seek Graph

The 'moving' parameter had to be made into an int for this, to indicate
right clicks with code 2. Right press now already pushes the clicked ad
to the back, so that the up-click will display an underlying one.

Bugfix pushing back seek ads on right-click

On a right button press the previous in stead of currently hit ad was
receiving the penalty.

Indicate seek-ad multiplicity

If more than one seek ad is inside the capture range of the mouse
pointer, an exclamation point is printed before the seek-ad text.

Some fixes to make seek-ad suppression work in WinBoard

In WinBoard the z-depth was immediately erased by redrawing the graph;
the clearing of zlist had to be moved from PlotSeekAd() to AddAd()
(where it really belongs). Also aging of z-depth is now suppressed on
mere pointer motion.

2010-02-04 22:45:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Dynamic Seek Graph

The new option -autoRefresh sets FICS and ICC to report removal of seek
ads, and then removes those from the Seek Graph. New seek ads are added
to the graph, as soon as the ICS reports them.

2010-02-04 22:42:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement SeekGraph in XBoard

For now only controlled by left mouse clicks on board. New options
-seekGraph true|false and -sg to switch this feature on.

Facilitate selection of coinciding seek ads

Seek-ads that are viewed but not answered get a distance penalty on the
up-click that makes their selection more difficult next time, so that
the ad they covered gets a (better) change. The penalty ages away in the
course of 5 clicks.

Slightly offset Seek-Graph dots of different color

Dots of different color are now displaced horizontally be 3 pixels, to
prevent them from completely covering each other. (Required the axis
labels to be moved a little too, to not be covered by the 1-min ads.)

Auto-show seek-ad texts in WinBoard

Hovering the mouse above a Seek-Graph dot will make the text belonging
to it appear in the message field without the need to press a button.
Required SeekGraphClick() to be called from the WB mouse event handler,
with an extra argument 'moving' to make the distinction with a real
click.

Show seek-ad text on mouse hovering (XBoard)

The Eventproc is also set to trigger on PointerMotion, and this event
then calls SeekGraphClick with motion=true to handle it.

Put poetic name of wilds in seek-ad text

Use XBoard variant names, except for 'loadable' and 'fischerandom'
(becomes 'setup' and 'chess960'), but leave number (to distinguish wilds
that transate to same XBoard variant).

2010-02-05 20:36:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix highlighting bug in XBoard

The from-square was drawn before the to-square was erased, which led to
a missing highlight line if they shared an edge or corner.

2010-02-05 15:49:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Shorten autoKibitz confirmation on FICS

Strip off the "players)", but leave the separatng space.

2010-02-05 14:39:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Repair damage to -autoKibitz done by FICS atomic zippy claim

The sending of -autoKibitz info was also moved back in that patch, but
unfortunately to after clearing of the programStats info. Now the
clearing has been moved also, to remain after it.

2010-02-04 23:33:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Send continuation lines to chat box they belong to

The variable savingComment is used as a kludge to remember where the
comment should go (i.e. which chatbox, or elsewhere), so that when a
continuation line is matched, chatPartner (which was reset at EOL) can
be restored to its original value. Also put space after handle of talker
in channel Chat Windows

2010-02-02 19:08:42 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix u64 format for cygwin

With a -mno-cygwin compile %llu and %lld are definitely not understood
by scanf and printf, although they are by the compiler. In stead, %I64u
seems to work. Put it in under control of a switch USE_I64, which is
defined only in the gcc makefile when MINGW is used.

2010-02-02 19:02:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove stray dot from WinBoard makefiles

There was a period suffixed to config.h in the wgamelist.o dependency.

2010-02-01 14:50:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in display of logos

The logo continued to be drawn after a boardSize change to a tinyLayout
size, although there was no space reserved for it. Fixed by explicitly
resetting logoHeight when no logo space is reserved in InitDrawingSizes().

2010-01-19 20:15:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Right-click refactoring: step III

Let WinBoard call RightClick in back-end, and delete the duplicate code
it had for this, after rescuing the front-end bits, and let the letter
act depending on the result returned by RightClick.

2010-01-19 19:07:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Right-click refactoring: step II

Migrate the Right-click routine to the back-end. Let it communicate back
square coordinates through pointer arguments, to accomodate their
different naming in XBoard and WinBoard. Template added in frontend.h.

2010-01-19 17:55:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Right-click refactoring, step I

Divorce front-end part from back-end part of PieceMenuPopup in XBoard
front-end, and forge the back-end part into a new routine RightClick.
The right up-click in XBoard, which called unLoadPV() directly, now
calls RightClick through PieceMenuPopUp().

2010-02-04 23:09:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Merge gamelistopt sources into gamelist source files

The files xgamelistopt.c and gamelistopt.c are merged with xgamelist.c
and gamelist.c, respectively. The WB front-end for the dialog already
resided in winboard.c, so there was little need to move it to wgameist.c
file. Makefiles adapted accordingly. Unsuitable key bindings were
removed. The low-level front-end prototypes are now defined in in
frontend.h.

2010-01-29 21:47:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Game-List options dialog for XBoard

A dialog similar to that of WinBoard was cloned from the game-list
window. The XBoard front-end is in a separate file xgamelistopt.c,
which in fact implements most of the low-level front-end as back-end.

2010-01-29 12:48:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Refactoring of game-list-options dialog

The back-end part is separated off, and moved to a file gamelistopt.c.
Front-end for now stays in winboard.c. No prototypes in frontend.h yet.

2010-01-26 19:28:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix of ancient WB bug: test integer option values for validity

Only a string of digits preceded by an optional sign is accepted now.
Before, any string was accepted, and leaving out a value could lead to
the next option being ignored (if it did not need a value) because it
was considered the value for the previous one!

2010-01-26 19:00:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in edit-position of holdings

The holdings were effectivelly taken one too large, so that a promoted
shogi Pawn moved to, or created in the holdings was not demoted to Pawn,
but put in the dark (which you could see by the holding count if you did
it twice). The overflow tests in these two cases now have been corrected.

2010-01-25 13:54:40 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Save fonts in XBoard settings file per boardSize

Each -boardSize now can have its own font specified in the settings file
(and thus by a command-line option, although it would in general not be
very useful to specify a font for a size other than the selected). E.g.
a prefix "size33:" to the font name will apply it only to -size 33.
An unspecified-size font option (not normally in the settings file) will
always prevail over a font option specific for the current size.
A font of some size must have been used or specified in order to be
saved.

2010-01-25 08:56:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix width of filter field in XBoard GameList

An empirical dependence of the width of this text edit on the square
size now makes for an acceptable layout at any board size.

2010-01-24 19:09:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use FICS atomic draw claim for sending move in zippy mode

For this the relaying of the move had to be moved until after the
adjudication, which again has to be done after MakeMove(), which is a
bit dubious, as MakeMove might take significant time when animating.

2010-01-24 18:51:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Send FICS atomic claim to ICS if move creates draw after offer

The FICS format "draw MOVE" is used to send the move to the ICS  when
the user enters a move that adjudicates as a claimable draw, and he
offered a draw before the move. For the benefit of ICS that do not
understand this format, the plain move is sent afterwards.

2010-01-24 18:16:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Also allow user to claim by offering draw before his move

Use the existing userOfferedDraw variable to test for such offers in
Adjudicate().

2010-01-24 17:29:42 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Also adjudicate after user move

Call Adjudicate() in FinishMove().

2010-01-24 15:56:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Refactoring of adjudication code

Put all the rule-based (as opposed to score-based) adjudications in a
separate routine, so they can also be called on user moves. This
requires sending the drawing move to the opponent engine to be made
conditional on existence of the latter. Execution of the code is no
longer dependent on the condition TwoMachinesPlay, but actual game
terminations are now all restricted by an alternative condition (no ICS
mode).

2010-01-24 11:46:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use -keepAlive option to determine connection health

When there has been no ICS response since the previous 'ping', assume we
are disconnected and do a fatal-error exit. Also auto-start the ping
process in InitBackend3().

2010-01-23 23:00:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use arrow keys in XBoard GameList for entry selection

Add translations for arrows and home/end, to call LoadSelectedProc with
argument to indicate the step, and let the latter perform the action.

2010-01-23 22:24:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow <Enter> to apply filter in XB GameList filter edit

Apply a translation to intercept the <Enter> key. Set focus back to the
list display afterwards.

2010-01-23 21:44:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Accept <Enter> for changing chat partner

A kludge stolen from Alessandro's GameList filter allowed to let the
typing of <Enter> while updating the chat-partner field of the WinBoard
chat windows to act as pressing the Change button. Gives focus to the
input field of the window afterwards.

2010-01-23 21:42:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Move duplicat gamelist code to backend

The filtering routines are moved from xgamelist.c and wgamelist.c to
gamelist.c, and a prototype for them is placed in backend.h.

2010-01-23 19:29:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Port game-list filtering to XBoard

Added a text edit and apply button to the XBoard game-list dialog, and
only have it print those lines that match the filter. Translate index in
list to index of game in file when a game is selected, and index in file
to index in list when a line is highlighted. Duplicates some code
between xgamelist.c and wgamelist.c, which should be moved to back-end.

2010-01-21 19:24:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Convert to DOS line endings

For easier understanding of upcoming diffs of winboard.c

2010-01-21 14:32:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Refactoring of move-history code

The WinBoard code in whistory.c was split in a front-end part (remaining
in whistory.c) and a back-end part (now in history.c in the xboard
directory). This to allow easy porting to other platforms.

2010-01-20 12:48:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add fixed-time/move button in XBoard time-control dialog

Put the TC-type buttons in a radio-group, and highlight the selected mode.

2010-01-19 18:27:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in XBoard PV display

The PV was unloaded on anything but a button release, in stead of the
other way around.

2010-01-23 11:04:11 -0800 Arun Persaud <arun@nubati.net>:
fixed hardcoded location of config file for xboard

the location should now follow sysconfdir during the configuration process.
Also added some more output to the configure script.

2010-01-18 12:18:32 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-01-18 12:15:06 -0800 Arun Persaud <arun@nubati.net>:
fixed Makefile.am to handle config file correctly


2010-01-15 21:55:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change opening array -variant fairy

We now use the position of "Chess with Different Armies", FIDE army vs.
a fantasy army (inspired on the Color-bound Clobberers) as opening
position.

2010-01-13 19:08:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add variant Makruk

Thai Chess, played by 2 million world-wide. Required pawn promotion to
happen in a zone, and the Alfil to move as Shogi Silver, a new opening
array, and unusual Pawn placement. Because of the latter, I consider it
a setup position, so a FEN will always be sent to the engine.

2010-01-17 14:17:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parsing of O-O and O-O-O after FEN pasting in FRC

Because the initial rights were not set in the FEN reader, the
initial rights of the previous game remained in force, so that the
parser did not understand OO-castling (although it would allow KxR
castling).

2010-01-15 14:40:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix reading FEN castling rights for knightmate and twokings

Scanning the back-rank for a King did not work in these variants,
because either the Unicorn castles, or there might be two Kings.

2010-01-13 11:42:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix omission in castling refactoring for ICS received boards

A default of -1 was still used, in stead of NoRights, when no Rook was
found. In theory this could have had effect in a setup board 0 in FRC,
when there were no Rooks on the back rank.

2010-01-13 11:35:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix TwoKings ICS castling-rights bug

Scanning the rank (as is done because of FRC) assigned castling rights
to the rightmost King. Even scanning the opposite direction would not
work, as it is not always the eftmost King that can castle. So we now
explicitly test for a King on e1/e8 in TwoKings and assign it rights,
relying on the Rook rights received from the ICS to control castling.

2009-11-18 19:12:25 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix double start of zippy engine after switch to gothic

In ICS mode we now switch to the proper variant as soon as we receive
the generic game-start message, to prevent a mismatch when the first
board is received (which would trigger fetching of a move list).

2010-01-11 16:44:40 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Extensive bugfix of -autoKibitz

Suppression of printing of diverted kibitz messages failed when they
extended over more than one read. This could even lead to such
messages being erroneously saved as comments, which then lead to
crashes. The suppression mechanism now waits for a prompt, in stead of
the end of buffer. This required the printing of any leftover in the
buffer to be deferred until the next read completes it.
The number of people kibitzed to is now printed.

2010-01-11 16:30:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix piece-to-char table -variant fairy

The letters for Lance and Snake where swapped.

2010-01-09 11:54:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make WinBoard makefiles use parser.c in XBoard directory


2010-01-08 18:23:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Docs update for new features


2010-01-08 15:18:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix new args parsing of -lowTimeWarningColor

This did not occur in the XBoard color translation table yet.

2010-01-08 14:16:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow editing of holdings in EditPosition mode

Dragging pieces to and from the holdings now consistently keep track of
the home square of pieces and the piece counts, as does creation of
pieces in the holdings through the piece menu.

2010-01-08 13:59:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Indicate squares a lifted piece can legally move to

Under control of the new option -showTargetSquares when
-highlightDragging and -testLegality are on, the squares a piece can
move to are marked by fat dots in the highlightColor (non-captures) and
premoveHighlightColor (captures), as soon as you grab it for dragging.
In variants with mandatory capture, the capture target of other pieces
is marked with the highlightColor (as non-captures are then not allowed).

2010-01-08 12:35:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug for incommensurate time odds

After normalization (-timeOddsMode 1) the time odds factors can be
non-integer, and thus must be stored as float.

2010-01-08 11:41:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Display PV right-clicked from EngineOutput window

The clicked PV is selected and the memo gets focus, so that it is
highlighted. This selection is restored in the proper place after
insetrtion of a new line in the memo.

2010-01-08 10:19:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Display PV on right-clicking board


2010-01-08 09:21:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix legality null move in parsing with -testLegality off

The pointers were compared, in stead of the values.
Furthermore, instead of null moves, it rejected moves on the main diagonal when legality checking was off.

Also exclude moves with empty squares and enemy pieces.

2010-01-07 19:10:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Newly lexed winboard/parser.c


2010-01-07 19:05:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Harmonize declarations of XBoard and WinBoard

The engine-exit and settings patches make some stuff common to WinBoard
and XBoard, which needed to be harmonized, and is moved to frontend.h.

2010-01-07 13:07:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow Ctrl-C copying from EngineOutput window text to clipboard


2010-01-07 12:52:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow popup-less (fatal) exit of engine after tellusererror


2010-01-07 12:40:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Improve layout of Engine #N Settings dialog

An attempt is made to align the input fields of spins and text-edits

2010-01-07 00:31:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let XBoard print version with argument --version or -v


2010-01-07 00:25:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix castling rule assignment in shuffle games

The conversion to in-board storage for rights copied directly to boards[0] in steadof
initialPosition, and was then overwritten when the latter was copied with uninitialized
rights to boards[0]. This affected FRC and CRC, where rights are non-standard.

2010-01-07 00:17:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement castling in -variant caparandom

CRC should be treated as FRC, but until now it never was. We now test for FRC_TYPE_CASTLING.

2010-01-07 00:09:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix default castling rights on reading incomplete FEN

This was overlooked in the conversion to the in-board storage of rights.

2010-01-07 00:03:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix NoncompliantFEN defaults.

This must be NULL to get compliant FENs, not "", which would suppress castling and e.p. fields.

2010-01-06 23:54:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change format of -adapterCommand.

first or f at the start of an option name are now automatically changed into second or s,
rather than needing %% to be recognized. The values of -ec and -ed in the default
-adapterCommand are now quoted (now XBoard understands quoting in the engine command line).

2010-01-06 23:51:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make WinBoard defaults for -fd and -sd equal to "." rather than empty strings.


2010-01-06 23:28:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Delete old indirection settings-file code


2010-01-06 21:45:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Correct XBoard default debug file name


2010-01-06 21:34:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress saving font settings.

The fonts are size dependent, and might thus not be reusable in the next
session. For now we therefore suppress the saving of them in the
settings file, until we diversify the fonts per boardSize.

2009-12-12 23:38:20 -0800 Arun Persaud <arun@nubati.net>:
added missing sounds files to be able to compile on windows


2009-12-09 17:29:37 -0700 Eric Mullins <emwine@earthlink.net>:
Changes needed to compile master branch.


2009-12-06 12:11:46 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
implements the eval-graph window for XBoard


2009-12-06 11:58:34 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
improves the XBoard handling of the engine command line

it now understands limited forms of quoting, so engine binaries with spaces in their file name can be handled.

2009-12-06 11:56:40 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
A better and more flexible way of invoking Polyglot

rewrote uci.c. No more use of temporary files, all data passed through the engine command line. Adds a new command-line option -adapterCommand for this.

2009-12-06 11:34:50 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
remove trailing \r in xboard output

there is an annoying carriage return (displayed as ^M) at the end of the PV in the engine-output window, not
only with Fairy-Max, but also with UCI engine running under Polyglot. This patch replaces the trailing CR that Linux programs send after the PV line y a space.

2009-11-29 11:56:32 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
double buffer size to prevent overflow

This patch doubles the size of the ICS input buffer to 16KB, to prevent
the suspected overflow with -keepLineBreaksICS false when using
"inchannel 1" on FICS and over 500 people are tuned in.

2009-11-28 13:33:52 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix problem with empty string in -firstNeedsNoncompliantFEN

This fixes a bug in the use of the -firstNeedsNoncompliantFEN option with
an empty string as argument. (Which led to truncation of the FEN.)

2009-11-28 13:32:12 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
updates makefiles to include dependency on config.h

adds the dependency of wbres.o on config.c introduced by having the VersionInfo in the resource

2009-11-28 13:28:00 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
correctly apply some check boxes from the option menu

Usng the check-boxes in the Option->Adjudications menu to indicate the
engine reports absolute scores is now copied directly to the ChessProgramState,
from where it is used, in stead of only to appData. This makes the change take
effect immediately, in stead of after restarting.

2009-11-28 13:27:43 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
score sign in analysis mode

this does not alter any of the current behavior with compliant engines,
but does extend the correction for non-compliant score reporting under
control of the -first(second)ScoreIsAbs option to cases where the engine
is analyzing or playing on an ICS.

2009-11-24 21:09:30 -0800 Arun Persaud <arun@nubati.net>:
fix for bug #28077: xboard needs to link against x11

hopefully fixed automake to take care of this

2009-11-23 20:37:20 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
Fix castling rights when copying FEN to clipboard (again)

missed a spot last time

2009-11-23 20:22:58 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
restoring windows (EngineOutput and MoveHistory) on startup

restoring the open / closed status of the
auxiliary windows (EngineOutput and MoveHistory) on startup
in XBoard like they do in WinBoard, which makes sense now that
we aso remember their coordinates between sessions.

2009-11-23 20:21:14 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some outstanding pixmaps

fixed transparency issues

2009-11-23 20:17:25 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
use linux style options for config file and add a system config file for XBoard

This patch makes XBoard write the options to its conf file in
Linux style, "-option value" rather than Windows style "/option=value".

The WinBoard option parsing code has always understood both formats
(including any hybrids), but the format it preferred for writing might
look quite strange to Linux users. I also attached a file to be installed
as /etc/xboard/xboard.conf on "make install".

2009-11-23 19:58:55 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix window positioning

This patch adds stuff in the header files that allow the various front-end files
to share information on which windows exist, are up, and how they are positioned.
The EngineOutput, MoveHistory and GameList windows now all remember their
position and size, even when they are closed when XBoard exits.

2009-11-23 19:51:19 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
same argDescriptor parsing for Xboard and Winbaord

This patch makes XBoard and WinBoard use the same argDescriptor
list of options, and (largely) use the same code for parsing and saving them.
This is acheived by moving this code to a new file args.h, and #including this
in both winboard.c and xboard.c (so that tiny differences, e.g. in default
values in the table, are decided by the context). XBoard has new menu items
"Save Settings Now" and "Save Settings on Exit" in the "Option" menu.
XBoard uses /etc/xboard/xboard.conf as default settings file.
A new option, -saveSettingsFile, can specify where settings should be saved,
without parsing the file. (So that it also works if the file does not yet exist.)

2009-11-22 13:00:31 -0800 Arun Persaud <arun@nubati.net>:
new developer release

changed release name to <branch>-<date>

2009-11-22 12:34:13 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix the irritating wandering off of the MoveHistory window in XBoard on opening/closing.


2009-11-22 12:29:47 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
use xtell for talking to handles, but tell for talking into a channel.

by changing the chatboxes to use xtell in stead of tell, we broke
the possibility to use the chat-box for chatting into a channel (which is
apparently not possible with xtell).

2009-11-22 12:15:15 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix bug in bughouse drop menu

This patch fixes the bughouse drop menu, which was broken by the
new mouse driver, and could no longer drop white Pawns.

2009-11-18 19:29:57 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
2nd step for moving option parsing from winboard to the backend

This is the next step in option-setting refactoring: All options that are
defined in XBoard are now included in the WinBoard ArgDescriptor list.
The handling of sound option has been harmonized: the sound names
now all initially go to the appData array, (as in XB) in stead of directly to the
WB-specific variables, and LoadAllSounds now takes care of the copying.
A new routine ExportSounds copies them back before saving settings
(which, in XBoard, could be a no-op).

The definition of defaults for the XB-only options has been moved to common.h.

2009-11-18 19:24:35 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
1st step for moving option parsing from winboard to the backend

This is a preparatory step in moving option parsing of WinBoard to the back-end.
The table of command-line options now contains a fifth field, holding the compiled-in default.
This obviates most of the front-end routine InitAppData, which now is replaced by a table-driven
initialization routine SetDefaultsFromList(), which could be back-end.

2009-11-18 12:33:39 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
refactoring evalgraph code

This is the refactored EvalGraph code: the back-end part is separated off,
and put in a file evalgraph.c, which in the future can also be used with XBoard.
Only the WinBoard front-end code is left in the file wevalgraph.c. A new
header file defines the variables and routines they share.

2009-11-18 12:29:06 -0800 Arun Persaud <arun@nubati.net>:
clean-up

some file permissions where set up wrong
(e.g. execute permissions for text files)

2009-11-18 11:34:22 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
refactoring of engineoutput

This refactoring patch separates the back-end part out of
xengineoutput.c, and puts it in a separate file engineoutput.c.
A new header engineoutput.h included by both defines the routines
for cross calling. Similarly wengineo.c will be stripped from its
back-end code, (and renamed to wengineoutput.c), so WinBoard and
XBoard now both use engineoutput.c rather than maintaining duplicate
code in their front-end part.

I also let the back-end now call EngineOutputUpdate directly, rather then
through a relay in the front-end, by renaming it to SetProgramStats
(the former name of the relay in winboard.c / xboard.c).

Moved some templates of functions in engineoutput.c from winboard.h
to frontend.h

2009-11-14 22:13:10 -0800 Arun Persaud <arun@nubati.net>:
fixed build on openbsd

added missing header file

2009-11-14 22:06:58 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
improve thinking-output for mulit-variant

Improve multi-variant support by sorting the Thinking-Output lines of the most recent depth by score in the Engine-Output window.

2009-11-14 22:05:12 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix castling rights when copying FEN to clipboard

This patch forces leaving of Edit-Position mode before copying a FEN to the clipboard, to make sure castling rights are faked in a consistent way. Before you could get FENs that had castling rights for non-existent Rooks.

2009-11-14 22:03:47 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
This patch gives a better handling of comments in PGN files, and adds the variation as comment to the main line on using Revert in local mode.


2009-11-06 18:53:19 -0800 Arun Persaud <arun@nubati.net>:
fixed prototype for AppendComment


2009-11-06 09:06:44 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
cleaned up some debug messages and typos


2009-11-06 09:05:09 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
variation-support patch

It allows you to Revert to the main line (or previous variation) when
playing variations on an existing game in EditGame or Analyze mode.

2009-11-06 08:48:09 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix for new way of saving castling and e.p. information

I forgot to make some conversions to the new-style encoding of castling there
(using the enum constant NoRights instead of -1 to indicate
the absence of rights, which was the price of storing the
rights in the board, which is an unsigned enum type.)

I also was a bit worried about portability, because I casted the enum type ChessSquare
to (int) before comparing it with (possibly negative) constants EP_NONE etc.
Now on my system enum types are (unsigned int), and this works, but I could
imagine there are systems where this would be an unsigned char. (Not sure
if there are rules for this). So to be safe I cast ChessSquare to (signed char),
which should always work to make small negative ints assigned to it read
back as themselves.

2009-11-06 08:44:59 -0800 Arun Persaud <arun@nubati.net>:
removed files that should only be in the windboard directory


2009-11-05 19:32:35 -0800 Arun Persaud <arun@nubati.net>:
add Winboard source files into tar-ball

forgot to add them when rewriting the Makefile.am

2009-11-05 19:23:44 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
Integrate castling and e.p. rights into board array; bugfix for EditPosition

A large-scale operation that I have been postponing since the very first 4.4.0:
The castling and e.p. rights are now integrated into the board array, as
boards[moveNr][CASTLING][i] replacing castlingRights[moveNr][i] and
boards[moveNr][EP_STATUS] replacing epStatus[moveNr]
These quantities are now automatically copied with the position by CopyBoards
(allowing the removal of lots of dedicated copying code), and passed as
function arguments with the position (so that the moves.c functions like
TestLegality, MateTest, CoordsToAlgebraic, Disambiguate, GenLegal
no longer need explicit e.p. and castling parameters.

Also fixed a bug introduced by a recent previous fix: by adding fake castling
rights to a position set up through the EditPosition menu, I destroyed the
castling rights of a pasted FEN. Faking castling rights is now made conditional
in EditPositionDone(), depending on the caller. (I had not realized it was also
called after FEN pasting, to send the position to the engine.)

2009-11-05 19:03:17 -0800 Arun Persaud <arun@nubati.net>:
added missing library for build on OS X

Xmu seems to be missing

2009-11-04 22:57:30 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
Some code refactoring and cleanup; one small bug fix

Some code refactoring, mainly to bring definitions of routines and variables
shared between winboard.c and one of the auxiliary-windows files
whistory.c, wevalgraph.c, wgamelist.c, wengineo.c somewere in a header file
(winboard.h). Unfortunately this made winboard.h dependent on data types
defined in frontend.h, so that the #include order had to be changed in many
other .c files.

The operation revealed one potentially bad bug: engineOutputDialogUp was
written as int in engineo.c, but declared as char in winboard.c.

I also changed the storage mechanism of the the comment and tags window
positions to use WindowPlacement structs rather than simple variables,
so that in the future they can be docked, like the others.

I also removed some remnants of the Analysis window.

The wgamelist.h and wedittags.h header files contained only 3 lines, and
I absorbed them in winboard.h, rather than creating other such nearly empty
headers engineo.h, whistory.h and wevalgraph.h. This affects the make files.

2009-11-03 18:26:06 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
let the clocks run in -searchTime mode


2009-11-02 17:41:12 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
add fixed time per move to the WinBoard time-control menu dialog


2009-10-31 10:42:50 -0700 Arun Persaud <arun@nubati.net>:
updated version number to unstable


2009-10-31 10:25:37 -0700 Arun Persaud <arun@nubati.net>:
release of version 4.4.1


2009-10-30 19:59:23 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
cleaned up ChangeLog and NEWS

2009-10-30 20:02:40 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
use xtell instead of tell in wchat

2009-10-28 20:35:06 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
prevent buffer overflow

This is a buffer-size adjustments to prevent the JAWS version from
crashing when it has to read out loud very long comments.

2009-10-28 02:17:16 -0700 Tim Mann <tim@tim-mann.org>:
Further copy/paste fixes

We needed to implement the XA_TARGETS target in order for more
sophisticated apps to really believe we put anything on the clipboard
they can use.

2009-10-27 23:57:25 -0700 Tim Mann <tim@tim-mann.org>:
Make copy/paste position and game use clipboard, bug #27810

Copy actually sets both the clipboard and the selection for
convenience and compatibility with the old way of doing things.
Paste pastes from the clipboard by default, but the new -pasteSelection
option lets you get back the old behavior of pasting from the
selection.

2009-10-27 15:44:28 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
switch focus to the board after loading a game

2009-10-27 15:32:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27826: fixed autoDisplayComment

apparently the -autoDisplayComment option was not working,
not even in WinBoard. This patch should fix it,both for WB and XB.
(Unfortunately xboard.c and winboard.c were using a different name
for the same front-end variable I needed, so I had to change one of them.)

2009-10-27 12:24:56 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27826: ported two options to xboard

also updated the documentation

2009-10-27 12:22:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed jaws version

turns out the new mouse handler broke the JAWS patch, as I discarded
the function IsPromotion. I adapted it to call HasPromotionChoice instead.
Also fixed two arnings by removing a no-longer needed debug print.

2009-10-27 12:03:02 -0700 Arun Persaud <arun@nubati.net>:
reformated html to be correctly validated

2009-10-27 10:33:42 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
quick fix for "White Mates" in parser.l

2009-10-27 10:32:24 -0700 Arun Persaud <arun@nubati.net>:
fixed a regression

2009-10-26 20:45:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed stderr to debug output, since stderr is closed in winboard

2009-10-26 20:42:24 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removing empty lines from ICS play

this patch causes removal of spurious prompts during ICS play
also if the prompt is preceeded by a number of empty lines
(as the board for the opponent move is on FICS).

2009-10-26 20:40:00 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
another bug in VariantSwitch: an unitialized board was printed.

Must have been there a long time, but this time it crashed WinBoard.

2009-10-26 20:38:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
more work on variant switch

the previous solution to the cosmetic problem of displaying a wrong shuffle
in an ICS game that was observed from the very start unfortunately turned
out to cause a real error in diplaying a stored game through the smoves
command, for variants not using the FIDE setup as standard.

This patch displays the position from before setting up the start position
of the new variant, but does setup boards[0] to the initial position of that
variant. (If this is a wrong shuffle, it is thus ot displayed, and a new board
will immediately be sent from the ICS to correct the shuffle.)

2009-10-26 20:34:04 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
force full redraw in winboard

Full redraw is now always forced when highlightMovesWithArrow is on,
rather than only when highlight info is available. (As in drop moves the
latter is invalid, but we must still erase the arrow from the previous move.)

2009-10-26 20:25:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27790 and #277772. Suppressing the display of a wrong shuffle
when observing shuffle games from the first move (#27790 bis),
and the sounding of the FICS bell on crazyhouse captures (#27772 bis).

2009-10-26 20:22:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug related to unsigned char in convert.c

I also fixed the unsigned-char bug in the convert.c for bitmaps that caused the
129x129 XBoard bitmaps to be defective, and a bug that required fixup with sed
afterwards (so I could use it to create a new m33s.bm)

2009-10-25 23:37:48 -0700 Arun Persaud <arun@nubati.net>:
unguarded debug printf. added the appropiate if statement

2009-10-25 23:31:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for two compiler warnings

2009-10-25 23:29:43 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27799: fix for nested-nested-nested variations

2009-10-25 23:21:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
The book-probe code forgot to close the book file after opening it.

fixed by adding an fclose at two points.

2009-10-25 23:18:18 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed unused v54?.bm bitmaps from resource file

it seems the v54?.bmp bitmaps were actually included in the WinBoard build
(in the resource file), although they were never actually used. So I have
removed their inclusion in the resource file now.

2009-10-25 23:05:30 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
replaced defective bitmaps with copies from 4.2.7

2009-10-25 23:02:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed bitmaps files that are not needed any more

2009-10-25 22:58:34 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some bitmaps

2009-10-24 09:41:39 -0700 Tim Mann <tim@tim-mann.org>:
Drop an obsolete script that was only used to update my personal web site

2009-10-24 01:23:29 -0700 Tim Mann <tim@tim-mann.org>:
Silence warnings when compiling 64-bit xboard

Some harmless warnings were caused by 64-bit mode having 32-bit
int but 64-bit long and pointer.  Add casts (etc.) to silence them.
This might require adding a definition of intptr_t (a signed int
type that is the same width as a pointer) on old systems that don't
have it.

2009-10-24 00:56:37 -0700 Tim Mann <tim@tim-mann.org>:
Fix up man page some more

Sigh, the project history was still partly in reverse chronological
order and partly in forward order.  Swapped the order of some
sentences to help straighten it out.  I don't really care about this,
so other project members should feel free to do what they like here,
but the messed-up order was bugging me.

2009-10-24 00:46:20 -0700 Tim Mann <tim@tim-mann.org>:
Fix some issues in the XBoard man page

Correct places where the XBoard man page was calling XBoard
"WinBoard".  Change references to "WinBoard engines" and "WinBoard
protocol" to "XBoard/WinBoard ...".  Update bug reporting guidelines.
Reorganize project history to something more like chronological order
-- it had gotten pretty randomly ordered.

2009-10-22 21:45:32 -0700 Arun Persaud <arun@nubati.net>:
new pre-release version; updated version numbers

2009-10-22 21:33:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
This patch adds <Enter> to the characters that cause an automatic
switch to the ICS console when typed to the board window.

2009-10-22 21:31:16 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix to the minor graphics issue contained some typos,
as was remarked in the bugs reports

2009-10-22 21:30:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
improved mouse handler

The improved mouse handler still needed an extra call to DrawPosition to
work in XBoard.

2009-10-22 21:28:38 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
NPS plays and pondering

Clock updating did not work correctly in node-based time controls when the
engine was pondering. (It was not really meant for use with pondering. Oh well...)
This patch checks if the engine reporting the node count is indeed thinking
(as opposed to pondering).

2009-10-22 21:25:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
holdings update and regression fix

The holdings-update patch was not yet satisfactory, because FICS seems to send
holdings both before and after the board! And those received before did overwrite
the holdings received after the previous board. I know tried to fix that in a kludgey
way, by hiding a flag in the board that tells if the holdings have already been written
by the ICS or not, and ignore new holdings when they are. (Except in bughouse,
where holdings updates cannot be tied to a particular board and multiple updates
between boards are normal. (I hope?).)

I also undid a regression in my previous fix for the minor graphics problem,
and solved it in a slightly different way to prevent flicker.

2009-10-22 21:23:39 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
improved mouse handler

I improved the mouse handler in a way which will preclude disappearence of pieces
on off-board or ambiguous (in-between squares) drag & drop moves. (As was reported
in the "premove bug?" thread. Also the command-line premove problem reported there
is now fixed, by removing the prefixing.

2009-10-22 21:18:05 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #8847: moving backward while examining on FICS not reported to engine

I moved Daniel's code that backs up the engine when a bord with a
lower number is received to a place where it is always done in zippy mode,
rather than only when the engine is analyzing.

Apart from taking back moves, there was also the case where the
user moves forward by more than one move (usually immediately to
end-of-game). In this case a new movelist is fetched from the ICS
to recover the moves that were skipped. But this assumes that the
engine is at the start of the game and feeds all these moves to the
engine. So the engine had to be reset in this case to stay in sync.

2009-10-22 21:16:56 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
better init for random number generator

2009-10-21 23:01:09 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27772: holdings not updated

holdings lines from the ICS nor update the holdings
of boards[forwardMostMove] in stead of boards[currentMove].

2009-10-21 21:32:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
allowe parsing / disambiguation of SAN moves like Xe4 in certain situations

This patch allows parsing / disambiguation of SAN moves like Xe4, if there
is only one wild-card piece X on the board. Moves with wild-card pieces
are now considered illegal if they leave the King in check by a piece of
known gait.

2009-10-20 19:09:46 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug when switching to variantsuper

2009-10-20 19:06:43 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27715: 2 (minor) graphic issues

I forced a total redraw when Reset is called from the ICS code in case a
new game is encountered, in the hope it will make the reported
(irreproducible) problem go away. As game switches are not frequent, I
guess there is hardly any downside to this.

2009-10-20 18:57:17 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27667: PV line missing in analysis window, part 3

"3. Wish for Engine state string (right to the icon):
Can you add the actual search depth in analyzing mode? A change like "

I also added the requested display of depth of the analysis move in the
EngineOutput window. I guess a similar change could be made to wengineo.c
(as this is in the code they share in common), but no one ever requested
that in the 5 years since Alessandro wrote it. So for now I leave it alone.

2009-10-20 18:52:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27760: debug printf in backend.c and additional check for variant

2009-10-19 23:17:46 -0700 Arun Persaud <arun@nubati.net>:
fix for bug #10990: cmail does not seem to support .cmailgames or .cmailaliases

this is correct, deleted the text out of the documentation that claims we support it

2009-10-19 18:40:40 -0700 Arun Persaud <arun@nubati.net>:
new alpha version; first one with new naming scheme

2009-10-19 18:07:21 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
smarter analysis of the boards that XBoard receives from an ICS

I added smarter analysis of the boards that XBoard receves from an ICS,
based on board size and piece types in the position, to recognize cases
where the board does not match the current variant, and switch to an
appropriate variant.

2009-10-19 18:04:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27667: window should be reference to toplevel

The remaining objections of #27667 should be fixed by bringing the
EngineOutput window under control of the TOPLEVEL compile-time switch.

2009-10-19 18:02:42 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
partly fix for bug #27715: scaling of menu bar

the menu bar to the left edge of the window.

2009-10-19 17:59:43 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug reported in WB forum: second game of a match would
not start when using the GUI book

2009-10-19 17:57:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27751: negative holding counts displayed

I put code in the back-end to prevent holdings counts from
becoming negative when a drop move is made from empty holdings.
(This can happen when re-loading ICS bughouse games,
as the smoves command fails to fill the holdings.)

2009-10-18 20:54:53 -0600 Eric Mullins <emwine@earthlink.net>:
Updated compiling instructions.

2009-10-18 11:32:55 -0600 Eric Mullins <emwine@earthlink.net>:
Changes to allow fonts with any charset (such as terminal)

Affects winboard only.

2009-10-16 23:02:41 -0600 Eric Mullins <emwine@earthlink.net>:
Moved SIGWINCH signal so it can be used...

I goofed putting this in StartChildProcess() originally.

2009-10-16 22:54:12 -0600 Eric Mullins <emwine@earthlink.net>:
Added internal wrapping ability.

New options:
  -wrapContinuationSequence "foo"  (default: "\\   "
  -useInternalWrap (Winboard default: false, XBoard default: true)

Note: -keepLineBreaksICS if set, prevents wrapping, usurping the
   useInternalWrap setting.  The idea is if you want to keep ICS line
   breaks, then you don't want internal wrapping.  Because of this,
   the new default for keepLineBreaksICS is now false for XBoard.

2009-10-16 19:14:34 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed segfaul in convert.c used to convert pixmaps

2009-10-15 19:46:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new mousehandler to correct for premove and promotion popup

this is the new mouse handler for XBoard, which should fully implement
premove, including promotion popup, and yet suppress the promotion popup
on illegal moves that are not premoves. It is almost completely moved to
the back-end now, so that WinBoard will be able to use it as well. I just
must hook it up to winboard.c, in particular harmonize the call-backs of
the mouse driver into the front-end for grabbing and releasing pieces for
dragging, to make sure they have the same names and arguments.

2009-10-15 19:32:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated black fairy pieces

here is a set of black fairy pieces with opaque white details,
so they have the same style as the orthodox XBoard pieces.

2009-10-15 16:54:51 -0600 Eric Mullins <emwine@earthlink.net>:
Adjustment to joining to work around server not always including space.

This patch implements commit 98aa02bda540f17f1f50be00e494efafe439b004
into the updated joining routine.  This issue seems not to be server
variance, but instead the server electing to omit the space between
words when it occurs at exactly your width setting (-1 actually).

This patch makes the joiner add back the space just like the referenced
commit.  Note: this is just a workaround to a server issue-- the joiner
actually joins correctly before this patch.

2009-10-15 07:18:42 -0600 Eric Mullins <emwine@earthlink.net>:
Fixed joiner detection, allowing it to work with timeseal

When timeseal's buffer fills in the middle of the continuation
sequence, detection fails, and the lines aren't joined.

As a result of this fix, measures intended to bypass joining are
no longer needed, so I removed them.  These utilize server vars
when available to prevent splitting.

2009-10-14 14:42:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed engingeoutput routine

removed outdated code regarding analysis window

2009-10-14 14:39:06 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
moved bitmap to correct location

was misplaced in a previous commit

2009-10-14 14:26:09 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed wrong number of arguments for EngineOutputPopUp

2009-10-13 21:00:27 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new bitmap converter (including fill option) and new pixmaps

2009-10-13 20:52:40 -0700 Arun Persaud <arun@nubati.net>:
forgot to add these two lines to the last commit

2009-10-13 20:51:17 -0700 Arun Persaud <arun@nubati.net>:
removed AnalysisPopUp. Use EngineOutputPopUp instead

this was already in Winboard, copied it to xboard and removed unused code.

2009-10-13 20:32:32 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Proper board and holdings size when switching to variants
gothic, capablanca, great and super within an ICS game.

2009-10-13 20:25:13 -0700 Arun Persaud <arun@nubati.net>:
cleaned up an old #ifdef in zippy

2009-10-12 19:25:17 -0600 Eric Mullins <emwine@earthlink.net>:
neglected this for the auto-width updating in xboard

2009-10-12 19:19:59 -0600 Eric Mullins <emwine@earthlink.net>:
Added server width adjustment based on client width changes

2009-10-12 19:14:53 -0600 Eric Mullins <emwine@earthlink.net>:
silence some compiler warnings

2009-10-11 18:39:24 -0600 Eric Mullins <emwine@earthlink.net>:
Maintainence to support all compilers.

2009-10-11 17:07:27 -0600 Eric Mullins <emwine@earthlink.net>:
Adjusted alternative joining method to obey keepLineBreaksICS

2009-10-11 14:48:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27668: e.p. field still not passed to engine

PositionToFEN now takes the e.p. rights from epStatus[moveNr],
rather than calculating it on the spot from moveList[moveNr-1]
(which failed on the first move).

2009-10-11 14:46:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27666: naming of variants

Variant names "misc/xxx" are recognized as "normal", rather than "xxx"
to not get confused by the board "misc shogi" run by FICS.

2009-10-11 10:14:09 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed enable menus

Put the "Open Chat Window", "Machine Both", and "Engine #N Settings" menu items
in the appropriate enable lists for graying them out wen not applicable.

2009-10-11 10:13:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Added a command-line option -keepLineBreaksICS true/false to control line joining.

2009-10-10 19:30:23 -0600 Eric Mullins <emwine@earthlink.net>:
Added code to prevent unnecessary width updates.

2009-10-10 18:34:37 -0600 Eric Mullins <emwine@earthlink.net>:
Turned off wrap when possible on ICS servers.

Turning off line wrap prevents splitting lines up using the
continuation sequence "\\   ".  This is desirable when using
timeseal because timeseal's buffer is sometimes too small,
causing it to break lines itself.  These lines can't be joined.

2009-10-10 16:30:56 -0600 Eric Mullins <emwine@earthlink.net>:
vsnprintf() must be _vsnprintf() for MSVC

2009-10-10 16:16:45 -0600 Eric Mullins <emwine@earthlink.net>:
added code to handle initial width update

2009-10-10 14:21:12 -0600 Eric Mullins <emwine@earthlink.net>:
Added width updates to ICS client on font and window size changes

What still needs to be done is placing an update call after login
to initialize with the correct width.  I didn't see where to put
that.

2009-10-10 14:19:30 -0600 Eric Mullins <emwine@earthlink.net>:
added ics_printf() and ics_update_width() and utility functions

2009-10-10 11:15:50 -0600 Eric Mullins <emwine@earthlink.net>:
Cleaned up ConsoleWndProc  (not complete, see below)

Using static variables this way is not appropriate.  I only addressed
hInput and hText in this commit though.  But imagine the WndProc being
used by multiple windows instead of just one, and you can see why
using static variables in this way is wrong.

2009-10-10 11:12:10 -0600 Eric Mullins <emwine@earthlink.net>:
Restructured URL code so it fits better with how winboard is set up.

2009-10-10 08:57:39 -0700 Arun Persaud <arun@nubati.net>:
cleanup: removed "#if 1" statements

2009-10-10 08:55:21 -0700 Arun Persaud <arun@nubati.net>:
cleanup: removed "#if 0" from source

a bit of cleanup of the source code

2009-10-10 08:34:10 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix joining of lines split by ICS

This patch fixes the joining of lines that were split by an ICS, so that adding
a space at the break point is done only when there was not a space already.
(Some ICS leave a space at the end of the broken line, others do not.)
An extra space would interefere with board12 in Gothic Chess, which is so
long that the ICS breaks it, and the WB parser could not handle a double
space within the board.

2009-10-10 08:27:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27642: Clock jumps strangely in engine mode

This moves SwitchClocks() back to after incrementing forwardMostMove,
so that it knows again who has the move (which was broken by the "bare" patch),
and will take the appropriate tick length.

2009-10-10 08:26:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed test for premove

this was added while looking for the premove bug, but is not needed

2009-10-10 02:03:45 -0600 Eric Mullins <emwine@earthlink.net>:
added URL detection and provided hotlinks in the ICS client

2009-10-10 02:00:52 -0600 Eric Mullins <emwine@earthlink.net>:
reverted winboard.c beofre URL commit to correct whitespace conversion

2009-10-09 02:14:22 -0600 Eric Mullins <emwine@earthlink.net>:
Added URL detection into the console text window for ICS.

2009-10-08 23:51:06 -0700 Arun Persaud <arun@nubati.net>:
added some comments and formated code

2009-10-08 23:46:52 -0700 Chris Rorvick <>:
fix printing out help message (list of command line options) (tiny change)

The postfix increment always resulted in an attempt to print out an
option on the right side regardless of one actually existing. Use
prefix increment to prevent a crash when printing an odd number of
options.

2009-10-09 00:04:51 -0600 Eric Mullins <emwine@earthlink.net>:
Updated navigation accelerators, fixing ICS problems.

Recent changes to the navigation accelerators were in the wrong
accelerator table.  Since the goal was to correct non-JAWS versions
back to 4.2.7 behavior, I updated it to how 4.2.7 did it, but still
retained the #ifdef JAWS conditional compilation.

On an ICS, the navigation keys took control away from the ics
client to navigate the game.  The update requires the ALT key to
be pressed, but it works identical to 4.2.7, not causing an
unexpected focus back to the board window when you're just editing
text.

2009-10-08 20:33:39 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed premove recapture problem;promotion popup appearing on
obviously illegal moves; promotions in Superchess and Great Shatranj

1) the premove recapture problem
2) the promotion popup appearing on obviously illegal moves (the 1. e2a8
problem)
3) promotions in Superchess and Great Shatranj, where the piece can now be
selected from the holdings

2009-10-08 20:28:50 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added forceIllegalMove to xboard

2009-10-05 21:01:32 -0700 Arun Persaud <arun@nubati.net>:
bugfix: segfault when invalid option argument was given (bug #27427)

when given a wrong argument to an option (e.g. -tc 0) xboard aborts
before setting up the window, but tried to write a message to the
messageWidget which doesn't exist at that point.

2009-10-05 20:05:00 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
small improvement for JAWS version

This is a patch to make JAWS read out any comments when /autoDiplaycomment=true.
As focus does not stay on the Comment window, the comment was not spoken otherwise.

2009-10-05 20:02:50 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated to winboard internationalization scripts

Also a slight improvement of the internationalization scripting,
to prevent it from crashing on messages containing a slash.

2009-10-05 20:01:53 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new forceIllegalMoves option

The -forceIllegalMoves option uses setboard or edit to force a position
when an engine refuses the move leading to it by an "Illegal Move" message.
Especially for engines using the edit command this was a bit tricky,
because of the a2a3 kludge to avoid using the white and black commands.

2009-10-05 01:01:54 -0600 Eric Mullins <emwine@earthlink.net>:
removed _winmajor if not defined so that VC 2008 can compile the project

The oldDialog variable should just be set to 0 in all cases now, and
as such, legacy code supporting the old dialog ought to be removed.
The test for _winmajor is against < 4, which is always false at present,
causing oldDialog to be 0 in every conceviable circumstance.

2009-10-04 09:58:29 -0700 Arun Persaud <arun@nubati.net>:
getting ready for 4.4.1 release

2009-10-02 20:47:01 -0600 Eric Mullins <emwine@earthlink.net>:
Simplified future version changes.

Added a numeric version to config.h that is now used in winboard.rc
instead of being hard-coded there.  Just be sure to preserve the
proper format (4 comma-separated 16 bit integers) or else it won't
compile.

2009-10-02 16:56:01 -0700 Arun Persaud <arun@nubati.net>:
updated version number to 4.4.1.pre

should have done this straight after the last release, but forgot...

2009-10-02 16:48:03 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
worked on premove bug

I made an attempt to make premove unsensitive to a race condition,
just in case the premove problem was caused by that (which seems unlikely,
but in any case  I added some debug printout to test this).

2009-10-02 16:41:12 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed loading of saved games via command line

the variables forwardMostMove and backwardMostMove where set to zero
at the wrong place.

2009-10-02 16:39:20 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
small fixes for the JAWS version

* I moved saying 'check' by the JAWS version to where castling also benefits from it.
* I made sure the check symbols are also recognized on promotion moves
* In the non-JAWS version, define the plain arrows as shortcut keys for the button bar

2009-10-01 16:50:28 -0600 Eric Mullins <emwine@earthlink.net>:
Fixed bug dereferencing garbage, causing crash.

Commit fa8be4a3fc5d81e9ec1f6c218fcf55c95d34fd10 included code to free the
resultDetails of the gameInfo structure.  That exact code exists a few lines
above where it was added.  None of these free() calls finish by setting the
member to NULL afterword, therefore repeated attempts to test/free() the
members result in an attempt to free() memory winboard no longer owns, and
an eventual crash.

link to problematic commit: http://git.savannah.gnu.org/cgit/xboard.git/commit/?id=fa8be4a3fc5d81e9ec1f6c218fcf55c95d34fd10

2009-10-01 16:49:57 -0600 Eric Mullins <emwine@earthlink.net>:
Added wchat.c to the project files we maintain.

2009-10-01 15:52:50 -0600 Eric Mullins <emwine@earthlink.net>:
Previous fix for VC++/strcasecmp() was wrong-- use StrCaseCmp().

2009-10-01 14:49:58 -0600 Eric Mullins <emwine@earthlink.net>:
Add resource ID for new Mute menu item.

I know this was probably done by HG, and simply left out of
his commit.  Anyway, the project can be built now after this change.

2009-10-01 14:49:09 -0600 Eric Mullins <emwine@earthlink.net>:
Use of strcasecmp() broke Visual C++.

2009-09-30 20:47:00 -0700 Arun Persaud <arun@nubati.net>:
wrong default value for engineDebugOutput

the new default is now 1

2009-09-29 22:55:41 -0700 Arun Persaud <arun@nubati.net>:
updated cmail.in to adapt the CVS->git change

don't reference $Revision:$ anymore.
Instead use reference xboard-version via autoconf.

2009-09-29 22:04:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
bugfix for protocol extensions: egtbpath -> egtpath

A new and very bad bug was discovered in the implementation of
the protocol extensions: XBoard sends a command "egtbpath" to the
engine in stead of "egtpath" from the protocol specs.
After discussion on WB forum it was decided that egtpath was better
than the egtbpath I originally had proposed, and I changed it accordingly,
but I had not realized that this string occurred TWICE in backend.c,
depending on if matched the -defaultPathEGTB of -egtFormats option.
I only changed the first occurence.

2009-09-27 12:27:44 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for edit-position "moves" being sent by XBoard to the engine

2009-09-27 12:25:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Engine did not start playing when out of GUI book on second move with white

2009-09-27 12:24:30 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Opening Engine #1 Settings crashed XBoard when there were no
text-edit options in the dialog (to which to set keyboard focus)


2009-09-27 12:18:35 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added a "Mute All Sounds" item in the WinBoard Options menu, on Eric's request

2009-09-27 12:15:20 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Updated the RTF docs for the chat windows, engine-settings dialog,
/keepAlive option and new game-list tag

2009-09-27 12:14:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Made the beep sounds for JAWS board navigation configurable through
command-line options

2009-09-27 12:11:49 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Prepared a system to internationalize the WinBoard menus

2009-09-27 12:10:38 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added the result comment to the game-list tags when the game list is
exported to the clipboard

2009-09-27 12:05:32 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
rewrote wevalgraph for better frontend/backend separation

I have finished re-writing the eval-graph code to have some
front-end / backe-end separation, something I had already started on my
holiday in Norway (when I had no internet :-)  ).
The new code now appears to work exactly like the old code,
and I guess it could be ported to gtk comparatively easily.

2009-09-27 12:00:51 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for keepalive and chat window

I made a fix to the keepAlive option so it does not send the date command
to the ICS after every move. This required changing ScheduleDelayedEvent()
so that it does not execute the event if a new identical one gets scheduled.
I also added the option to XBoard. Affects xboard.c (DOS!) and winboard.c

(This also cures the regression of the winboard.c copyright patch)

I extended the chatbox patch to also listen to channel tells, and divert
them to a chatbox for that channel number. Affects
backend.c and wchat.c

That should make those patches fully operational. No docs for either of them
yet, though.

2009-09-27 10:36:23 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed parse bug for pgn files

fixed the existing bug that the time-control tag was displayed as "?"
in the game list; turns out it was never parsed on reading PGN files

2009-09-27 10:35:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
allow the result comment as a display item in the game list

2009-09-27 10:35:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed the HAVE_LIBXPM-dependent compile errors

2009-09-27 10:24:47 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added a chat window to keep track of multiple conversations

The chat-window patch affects:
winboard.c, backend.c, winboard.rc, resource.h, backend.h, and adds
the file winboard/wchat.c, which also affects makefile.gcc and makefile.ms.

In addition I added a new option -keepAlive, which affects
common.h (in addition to winboard.c and backend.c).

As I had to modify backend.h, I also defined the -reset option type there,
which we are going to add later. This required some changes
to suppress warnings in wsettings.c.

2009-09-27 10:22:16 -0700 Arun Persaud <arun@nubati.net>:
more files for git to ignore

most of these are generated by make distcheck

2009-09-08 09:33:53 -0700 Arun Persaud <arun@nubati.net>:
another bug fix found by Stanislav Brabec

returned -1  in some case although the variable was a char...
changed to signed char

2009-09-20 23:13:13 -0600 Eric Mullins <emwine@earthlink.net>:
Swapped 'tell' and 'message' parsing order for colorization.
Sometimes messages are relayed as tells and should be colorized as tells.

2009-09-08 09:10:34 -0700 Arun Persaud <arun@nubati.net>:
added some more files to be distributed via make dist

as suggested by Stanislav Brabec

2009-09-08 09:01:07 -0700 Arun Persaud <arun@nubati.net>:
fixed some implicit declarations reported by Stanislav Brabec

2009-09-07 22:04:39 -0700 Arun Persaud <arun@nubati.net>:
fixed a few more small bugs reported by Stanislav Brabec

- A function uses a 'return;' statement, but has actually a value to
return, like an integer ('return 42;') or similar: xboard voidreturn
xengineoutput.c:766, 782

- Program returns random data in a function at xengineoutput.c:602

- With a new toolchain, AM_LDFLAGS cannot contain libraries. Linker
ignores them. Fix is attached.

- ToDo: Convenient name in most projects is TODO (autotools package it
automatically).

2009-09-06 19:11:22 -0700 Arun Persaud <arun@nubati.net>:
reverted .texi file and fixed Makefile.am

the problem was actually not in the texi-file, but the Makefile.am.
Reverted changes in the .texi and fixed it (hopefully) correctly now.

2009-09-06 18:23:01 -0700 Arun Persaud <arun@nubati.net>:
get "make distcheck" to work

needed to add all *.h files to Makefile.am and also the bitmaps that
are needed and some other files. Also had modified copyright.texi.

2009-09-05 09:54:37 -0700 Arun Persaud <arun@nubati.net>:
changed to version 4.4.0

2009-09-05 09:44:21 -0700 Arun Persaud <arun@nubati.net>:
updated AUTHORS, README and ChangeLog files for release

2009-09-05 08:52:09 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some typos

2009-09-04 22:39:45 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
set castling rights after setting up a position

I was going through old WB forum posts, and I encountered a
bug report for a bug that I never fixed: The castling rights should
be properly set (actually: cleared) after setting up a position
in Edit Position mode (as opposed to pasting a FEN).

2009-09-03 23:11:18 -0700 Arun Persaud <arun@nubati.net>:
removed install files from master

they now live in their own branch

2009-09-03 22:30:18 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated polyglot protocol

I added a new option type "-reset" to the protocol for the new option feature.
4.4.0 does not implement it yet, but Michel wants it for future Polyglots,
and I think it is best to update the protocol in one big swoop.
So I want to already include it in the specs now. (engine-intf.html)
I made xboard's response to an unknown option type compliant
with the new protocol specs.

2009-09-03 22:28:50 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some typos

2009-09-03 20:47:13 -0600 Eric Mullins <emwine@earthlink.net>:
Updated project files for DevCpp and Visual Studio to add wsettings.c

2009-09-03 20:46:33 -0600 Eric Mullins <emwine@earthlink.net>:
Added newline at end of file to silence warning.

2009-08-31 20:29:49 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
workaround for error message for missing pieces used in variants
and initstring bugfix: error messages showed for non-existing pieces
showed up for old user supplied pixmaps.
Loading a pixmap of the king for the missing pieces now.

Another bad bug surfaced: the -initString argument does not work in any
XBoard version! (Including 4.2.7b) The escape sequences for linefeed in
the string are not understood: -initString "new\nrandom\n" actually sends
the \ and n to the engine (which then does not recognize the line as a
valid command)!

So I also added a patch to expand escape sequences in the InitString and
ComputerString command-line options.

2009-08-31 20:27:24 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated installe script

I re-organized the doc files in the install, so they now all go in the
WinBoard\doc folder (and none in the root). I so included the COPYING
and COPYRIGHT files there. This required some updates of the links in
some html files, and of the menu link to README.html in the install script.
I also fixed an error with the current directory
in the menu short-cuts of some engines (which started in the fonts folder,
and could not find the opening book there...).

2009-08-31 20:25:17 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated documentation

2009-08-31 20:20:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated installer script

2009-08-31 19:51:48 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new help files for windows

2009-08-25 20:41:29 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated installer

2009-08-25 20:36:53 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
undid some previous changes

some files got mixed up

2009-08-25 20:32:22 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed small bug in wsetting

2009-08-25 20:29:06 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
trigger a focus switch to ICS input field when typing

old behavior was that "." or "," triggered this,
now every printable character  except 1-9 will trigger the focus switch

2009-08-25 20:26:20 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
bug in backend.c when receiving lines from ICS

A space was appended to every character received from an ICS
in stead of just at line breaks.

2009-08-24 23:47:48 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed warning messages from compiler

2009-08-23 14:24:38 -0700 Arun Persaud <arun@nubati.net>:
fixed build on OS X

this seems to fix it. Bug reported by Louis Zulli who also did the testing.

2009-08-23 11:54:28 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
OK, this is the beefed up version of the Polyglot info-string kludge,
for WB and XB.

2009-08-23 10:22:48 -0700 Arun Persaud <arun@nubati.net>:
added missing X_LIBS references to Makefile.am

2009-08-22 23:33:44 -0700 Arun Persaud <arun@nubati.net>:
made the install script and executable

2009-08-22 23:19:07 -0700 Arun Persaud <arun@nubati.net>:
changed beta1 to beta2

2009-08-22 23:14:11 -0700 Arun Persaud <arun@nubati.net>:
fixed enable zippy in configure script and added some checks for OS X

make tried to compile zippy even when --disable-zippy was given.
Also fixed a bug in xboard.c where #ifdef instead of #if was used
to test for ZIPPY (it's either 0 or 1, so we need #if). Also added
some special checks for OS X, not sure if these will do it, but it's a start;)

2009-08-22 19:09:54 -0700 Arun Persaud <arun@nubati.net>:
added configure summary to configure output, also cleaned up configure.ac a bit

used AS_HELP_STRING where possible

2009-08-22 18:10:57 -0700 Arun Persaud <arun@nubati.net>:
added check for malloc.h

this should fix a build error on OS X

2009-08-22 17:47:44 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
A small cosmetic change in the size of buttons
inside a groupbox of the Engine-Setup dialog.

2009-08-22 17:32:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
make xboard usable with UCI engines

I made a small patch in xoptions.c (where the corresponding Engine Settings
dialog was for XBoard), to make it at least usable for UCI engines: I now
divide the options over upto 4 columns, if there are too many to fit into
a single column. This seems to work. Still looks very ugly, but it is
functional.

2009-08-22 17:30:05 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix premove for winboard

This might fix the illusive premove problem. In 4.2.7 the code was not properly
indented, and this led to an unbalanced braces error that I then fixed the
wrong way. Click-click premoves did only work after clicking the toSquare twice.
It might be that they actually did work after clicking it once,
but that the highlights were not displayed (although set)
for lack of a display refresh.

2009-08-22 17:28:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug for double saved games

This patch should solve the problem with doubly saved games when XBoard is
closed. I calculate a cecksum of each saved game now (including move comments),
and suppress saving if the checksum is not changed.

2009-08-22 17:25:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed xengineoutput.c, to keep the duplicated code identical to that of wengineo.c.

2009-08-22 17:24:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated xboard.texi: added warning that pixmaps are not build for all variants

2009-08-22 17:19:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added a dialog for engine-specific option settings

2009-08-22 17:09:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated some documentation

2009-08-22 17:07:10 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed several bugs in the backend and added some more polyglot support

* I added recognition for the new UCI3 option types that are recognized in the WB
option features, to make sure this version is compatible with future Polyglots.
Also fixed a bug that failed to strip an asterisk prefix from the first
combo-box item.

* I fixed the ICS-time-in-PGN bug.

* I fixed a bug which caused a space to be missing when long lines broken up by
an ICS were joined.

2009-08-22 17:02:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
better polyglot support for engine ouput

I fixed the algorithm for clearing the Engine Output window to work better with
the latest Polyglot, whight outputs UCI "info strings" amongst the thinking
output.

2009-08-22 16:23:32 -0600 Eric Mullins <emwine@earthlink.net>:
Beginnings of installer for 4.4.0.  HGM asked me to forward the nsi file,
but it seemed best to just add the installer tree to git even though
it's not finished.  You must install NSIS then FontName-0.7.exe
(included in installer folder) then run build.bat in the same directory.

2009-08-05 22:18:29 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
patch backend.c to make the -noGUI option also work in ICS mode.

2009-08-01 13:09:49 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
temporary fix for pre-select

As a temporary kludge I replaced looking into the holdings for the piece type
by figuring out which piece would belong on the clicked holdings square.
This is a non-trivial process, as it depends on which pieces participate
in a certain variant.

2009-07-30 00:19:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed click-click moves

I got complaints about the way XBoard 4.4.0 handles click-click moves,
in particular changing the selected piece after selecting King
(for which I suppressed interference with FRC castling in a rather brutal way).
People tell me it is very annoying that clicks sometimes don't work to select a piece.
WinBoard uses refined logic in the back-end to handle this, but the XBoard
front-end is not interfaced with that yet.
(This would require a major rewrite of the mouse handler.)
This temporary patch suppresses this behavior in all variants that do not support
Fischer castling, and even there only exhibit it for Rook-after-King selection
(which will be interpreted as an attempt to enter a castling move as K x own R).

2009-07-26 08:43:35 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
option -adjudicateDrawMoves is not included in the XBoard list.

added it to the option list

2009-07-21 20:23:23 -0700 Arun Persaud <arun@nubati.net>:
converted files from dos to unix format

run dos2unix over a bunch of files

2009-07-16 07:43:38 -0600 Eric Mullins <emwine@earthlink.net>:
Stripped out unused VersionInfo

2009-07-15 23:16:19 -0700 Arun Persaud <arun@nubati.net>:
changed version to 4.4.0.beta1

2009-07-15 23:12:37 -0700 Arun Persaud <arun@nubati.net>:
updated INSTALL file to add ./autogen.sh

2009-07-15 22:44:05 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
higher number of engine options possible now

I upped the number of options per engine from
50 to 100, and the average number of characters per option from 10 to 20.

2009-07-15 12:30:37 -0600 H.G. Muller <h.g.muller@hccnet.nl>:
Fix of bad bug

2009-07-14 23:41:36 -0600 Eric Mullins <emwine@earthlink.net>:
Added version information to resources.

2009-07-14 23:40:50 -0600 Eric Mullins <emwine@earthlink.net>:
Added Jaws targets to IDE projects.

2009-07-14 23:39:12 -0600 Eric Mullins <emwine@earthlink.net>:
Final makefile adjustments and compiling instructions.

2009-07-13 22:35:17 -0600 Eric Mullins <emwine@earthlink.net>:
Cleaned up garbage left behind from my makefile update.

2009-07-13 22:26:56 -0600 Eric Mullins <emwine@earthlink.net>:
Updated cmdline makefiles to be able to produce JAWS binaries.

This breaks support for MSVC 4.x.  It may still be possible to
use that compiler if you obtain the latest SDK from Microsoft.
MSVC 6.0 still works, but I had to change the target windows
version to 0x500 which causes warnings about building beta
applications.  This is all due to the use of MENUBARINFO data
type in the jaws binary.  You can reduce the WINVER to 0x0400
safely if you are not building a JAWS binary, and MSVC 4.x
will work fine.

2009-07-13 22:26:10 -0600 Eric Mullins <emwine@earthlink.net>:
Removed dependency on jfwapi.h

Allows anyone to compile a jaws compatible binary.

2009-07-13 22:23:31 -0600 Eric Mullins <emwine@earthlink.net>:
Fixed duplicate resource in winboard.rc

PLEASE remember to pull before commiting.  This is the 2nd
time I've fixed this.  It's a waste of time to keep fixing
the same problems.

2009-07-13 19:36:58 -0700 Arun Persaud <arun@nubati.net>:
resolved conflict between Xt and Xaw libraries

seems like we don't need to link against Xt.

2009-07-13 19:33:57 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
help-menu was not un-grayed in the JAWS version, when it played with engines

2009-07-13 19:29:53 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
integrated jaws into winboard

I integrated the JAWS patch now into WinBoard in such a way that the
JAWS and standard version can use the same resource file. This new
winboard.c contains the improved dialog layot of the JAWS version,
but none of the menus and JAWS-specific acclerator keys. The latter
are now generated at run time by code in jaw.s. As a result jaws.h
could be cancelled, as there the JAWS-specific defines are no
longer needed outside jaws.c (now the .rc does not use them), and
is incorporated in it.

2009-07-12 15:37:26 -0700 Arun Persaud <arun@nubati.net>:
fixed problem in autoconf using Xaw3d

rewrote the section for Xaw3d in the autoconf file

2009-07-12 15:29:28 -0600 Eric Mullins <emwine@earthlink.net>:
Added Jaws support to GCC makefile

2009-07-12 15:28:20 -0600 Eric Mullins <emwine@earthlink.net>:
added help support: MSVC IDE and DevCpp IDE project files

2009-07-12 15:26:49 -0600 Eric Mullins <emwine@earthlink.net>:
Removed obsolete makefiles and support files.

2009-07-12 12:33:26 -0700 Arun Persaud <arun@nubati.net>:
updated AUTHORS with the help of git. use

git log --pretty=oneline --name-only --author=AUTHORNAME v4.2.7..HEAD  |sort |uniq

a bit of hand editing and a quick emacs macro later and you have a nice
comma seperated list of all files changes by one author between two commits.

2009-07-12 12:31:47 -0700 Arun Persaud <arun@nubati.net>:
updated Changelog using git log --no-merges --pretty="* %ai: %s%n %b" HEAD v4.2.7

2009-07-12 11:34:28 -0700 Arun Persaud <arun@nubati.net>:
cleaned up some more copyright notices

2009-07-12 11:22:30 -0700 Arun Persaud <arun@nubati.net>:
updated copyright to reflect A. Scotte as copyright holder

need to mention him, since the paperwork won't be finished before the next release

2009-07-12 10:56:29 -0700 Arun Persaud <arun@nubati.net>:
updated patchlevel to "k"

2009-07-12 10:53:50 -0700 Arun Persaud <arun@nubati.net>:
fixed autoconf problem with VERSION/PATCHLEVEL variables

xboard used it's own version of PRODUCT, VERSION and PATCHLEVEL variables.
Switched to PACKAGE_STRING provided by autoconf

2009-07-12 10:29:46 -0700 Arun Persaud <arun@nubati.net>:
cleaned up old CVS left overs

removed $Id tags from all files

2009-07-12 10:10:17 -0700 Arun Persaud <arun@nubati.net>:
converted xhistory via dos2unix

2009-07-12 10:09:24 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed crash in history window

someone discovered that opening the move-history window in XBoard leads to
an immediate crash. Turns out that renaming the menu item broke it! (The
name of the item was apprently used elsewhere in the code to access it,
for putting a check mark there.)

2009-07-12 10:04:30 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for Animation of castling moves in Chess960

Animation of castling moves in Chess960 turned out to sometimes make the
king disappear from the display. For the time being I patched this in
xboard.c to suppress animation of FRC castling moves altogether. As FRC
castlings internally are represented as KxR, the to-square does not make
sense anyway, which made the animation look very weird even when it led
not to a king disappearance act. And the Rook move of a castling is never
animated.

2009-07-11 22:44:53 -0600 Eric Mullins <eric@hiarcs.(none)>:
Update GCC makefile to remove .obj targets.

Dunno how they got in there, but they should be .o

2009-07-11 22:42:41 -0600 Eric Mullins <eric@hiarcs.(none)>:
Update makefile dependencies on help.c and help.h.

2009-07-11 22:36:59 -0600 Eric Mullins <eric@hiarcs.(none)>:
Allow compiling with MSVC6.0 and 4.1

Move prototypes into help.h, after making sure that DWORD_PTR is
defined.  Include help.h from winboard.c and help.c so both files
benefit from the definition.

2009-07-11 18:26:16 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
 lists these accelerator keys in the menus for JAWS

2009-07-11 18:24:19 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added shortcuts

This patch allows the use of Ctrl+C and Ctrl+V for Copy Game
and Paste even in I C S mode when the board has focus.

2009-07-11 18:22:17 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
better handling of pasting a game without PGN tags

patch in wclipbrd.h to make it smarter to decide between pasting
a game or a position so it can handle games without PGN tags.
If it doesn't parse as a FEN it is assumed to be a game.

2009-07-11 18:20:56 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed parser error for knight move

The parser had a strange quirk: it recognized bd2 as a valid Knight move
(Nb1-d2) while this SAN format should be reserved for Pawn moves only.

2009-07-11 18:19:30 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
 fixed a few warnings in connection with the help patch (now warning free)

2009-07-11 18:13:50 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
some major re-assignment of accelerator keys in the JAWS

2009-07-11 16:54:53 -0600 Eric Mullins <eric@hiarcs.(none)>:
several small fixes

uptracked winboard.ini

* Cleanup: moved "Some definitions required..." from winboard.c to config.h,
and combined some definitions from borland w/ MS.

* Changed internal HtmlHelp return type and 4th argument to facilitate various
compilers.  These changes, while not strictly adhering to HtmlHelp() conventions,
won't impact anything since the function modified is internal only.

* Modified HtmlHelp return values to integer to silence warnings.
* Added help.c to the project in makefile.gcc & makefile.ms.
* Fixed duplicate resource in winboard.rc.

2009-07-09 22:08:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added JAWS support; help files for Vista; bugfixes for winboard.c

* JAWS support
* help files should now work under Vista (the user has to have either
  a program to view old windows help files or to view html-files installed)
* I fixed the tabbing between all windows that were added according to Tim's sugestions.
* I added typing in of a move number in the move type-in dialog as a shortcut
  to going to that position by use of the < and > buttons. Mainly intended to
  ease life for the blind, but I think it can be generally useful.
  (Although the move-history dialog provides that functionality too,
  this is quicker if you don't happen to have it open.)
* I added typing of a FEN in the move type-in dialog in Edit Position mode.
  (Which could not be used without mouse at all, and is defective
  in crazyhouse even with mouse, as there was no way to populate holdings.)

2009-07-09 22:03:00 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
some bugfixes: ICS error handling

* play a different sound for takebacks in ICS mode
* pop up error messages for illegal moves for typed-in moves

2009-07-09 21:50:41 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed no longer needed debug message

2009-07-09 21:48:23 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed compile error from a previous change

2009-07-09 21:44:54 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
user selectable font in game list

This makes the game list use the same (user selectable) font
as the the move-history window.

2009-06-30 21:27:34 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed typos in xboard.texi documentation.

2009-06-30 21:16:59 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated the FAQ

2009-06-27 17:06:26 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed font in engine output window

The engine-output window now uses the same font as the move-history window
(which was selectable in the "Options  -> Fonts..." menu, while the other
wasn't).

2009-06-27 17:03:19 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some characters in xboard.texi

It seems that copying manual sections from the RTF to th texi file did
somehow mess up the double-quote characters, and changed them into some
strange (unicode?) symbols.

2009-06-27 16:56:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
two shogi related bugfixes

I discovered a bug in the move generator for the Shogi Dragon King. I
guess it went unnoticed so far because this is a promoted version of the
Rook, which hardly occurs in games. (moves.c)

There was also a problem with the piecesfix I sent you before; Shogi
chosen as initial variant did use wrong piece symbols. (I had tested this
on gothic, but there it happened to work for a different reason, unique to
gothic.) This affects xboard.c.

2009-06-27 16:54:04 -0700 Arun Persaud <arun@nubati.net>:
small cleanup

2009-06-27 16:51:02 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
adds bitmaps for shogi promotions, and selects the bitmaps or
pixmaps for the more rarely used piece types on a per-variant basis.

2009-06-27 16:44:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
adds new piece types in the promotion dialog and edit-position piece menu

2009-06-27 16:13:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated bitmaps files: files for fairy pieces where missing,
others had names that didn't work with autoloading.

2009-06-27 16:06:35 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed a bug concerning bitmaps

2009-06-27 15:53:45 -0700 Arun Persaud <arun@nubati.net>:
give a default directory for bitmaps files (tiny change)

this is also one of the debian patches, should be rewritten to use
the correct install directory. No Author was given.

2009-06-27 15:47:52 -0700 Brian May <>:
verbose_error_message_about_recognized_options (tiny change from Debian patches)

2009-06-27 15:45:14 -0700 Matt Zimmerman <>:
add a visual low time warning (tiny change from Debian patches)

2009-06-24 23:31:52 -0700 Arun Persaud <arun@nubati.net>:
dos 2 unix conversion of backend.c

2009-06-24 23:30:07 -0700 Arun Persaud <arun@nubati.net>:
exchanged some sprintf with snprintf found in a patch for the debian system,
extended it a bit to other sprintf's original patch included only 11 lines
by Florian Ernst <florian@debian.org>

2009-06-24 23:07:23 -0700 Mark Ioli <chessknight>:
enabled a patch for default settings in winboard

2009-06-24 22:53:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated copyright notice


2009-06-24 22:52:20 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
patches a bug in chosing the initial board size on a virgin startup
I introduced recently

2009-06-24 22:49:33 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
I put in testing for the winning condition in 3checks

on a check it just goes through the entire game to subject
every position on a check test, to see if there were two more.

2009-06-24 22:47:01 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated copyright notice in docs

2009-06-24 22:41:40 -0700 Florian Ernst <florian@debian.org>:
added small patch from debian (tiny change)

according to the debian patch tracker, this patch is by
Florian Ernst <florian@debian.org>.
It fixes whitespace issues in filename called from cmail.

2009-06-24 22:33:13 -0700 Arun Persaud <arun@nubati.net>:
converted dos2unix format for xboard.texi

2009-06-24 22:31:57 -0700 Arun Persaud <arun@nubati.net>:
deleted two more files that don't need to be in git

these files can be generated by autogen.sh

2009-06-21 12:10:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
major overhaul of the -stickyWindows feature

I did a major overhaul of the -stickyWindows feature.
The game-list and ICS-interaction windows are now also sticky.
I also added a form of stickiness when the main window is resized;
edges of auxiliary windows sticking to the right or bottom side of
the main window stay attached when the window resizes
(due to nr of board squares or their size). The way the window
coordinates are saved in the .ini file is now relative to the
main window, and some dummy options are added to be able to
recognize right- and bottom-edge sticking, and reconstruct that
when WB starts up with another board size. Also added are
volatile options to ensure there will be space for auxiliary windows
above and left of the main window.

2009-06-21 12:07:01 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed long-algebraic form of drops

The WB parser turned out not to understand the long-algebraic form
of drops send by an ICS. (like B/@@-e4), so even with
legality testing off I now use the SAN move for drops.

2009-06-18 18:35:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Refined stalemate adjudication in Suicide, some cleanup

Refined stalemate adjudication in Suicide, which seems to be not always won
for the stalemated side, but for the side with the smallest number of pieces.
Cleaned up the adjudication code in the process. (backend.c moves.c, moves.h)
Also includes a tiny change in the -autoKibitz format, as requested on
Talkchess.

2009-06-18 18:32:57 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Enhancement of the way -autoLogo decides which logos to display

2009-06-16 00:06:59 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
bugfix and enhancement in autoKibitz mode

changed the format of the autoKibitz: score/depth in stead of depth/score,
as in PGN. I also supress the ICS time for the move now in the PGN
if extended info is available. When enhancing the functionality of
the autoKibitz command (using the opponent engine kibitz for the saved PGN)
I discovered that the xengineoutput.c in our tree was obsolete,
and contained a routine of which the arguments were no longer compatble
with the call from backend.c, and caused segfaulting. I copied in
the  corresponding routine in wengineo.c, which was compatible. That the
compiler did not flag this is a sign of badly organized code, I suppose...

The enhancement itself affected backend.c.

2009-06-16 00:04:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
modified clock layout

I altered the display of the clocks in the presence of engine logos; I used to
stack them, but some inquiry on Talkchess sowed that people disliked the
stacking. So now I display them next to each other again, but as 2-line-high
fields to make room for te logos.

2009-06-15 23:59:32 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new zippy option zippyShortGame

On request of Mike Adams I added a new zippy option, -zippyShortGame,
to make life more difficult for abusers of abort and disconnect for cheating.

2009-06-15 23:56:40 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some bugs in the animation of atomic captures

2009-06-13 15:27:26 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
some small bugfixes

I had overlooked one place from which the FEN writer
(of whicf I changed the argument types), which made WB crash
if you copied a FEN (or PGN that cotained FEN) to the clipboard.
I must have overlooked a warning during compile, or some depedency
is not correct in the makefile. Anyway, wclipboard.c had to be changed.
I also moved adjudication of some losing conditions to before tetsing
for stalemate, (e.g. in atomic, if your king get destroyd you lose,
even if you have no moves after that because it was your only piece.).
this affects backend.c.
I had used the same bits in the rule-modifier flags for indicating
mandatory capture as was already used for indicating FRC-style castling.
This led to frequent illegal move calls in FRC... (moves.h)

2009-06-13 10:45:17 -0700 Arun Persaud <arun@nubati.net>:
cleaned up HTML in FAQ.html -- still need to work on content

2009-06-13 09:36:26 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added option for work-around for some FRC engines in regards to FRCFENs

It suddenly occurred to me that I had promised on CCC to include an option
to provide a work-around for the problem that some FRC engines do not
understand FRC FENs (and thus do not play at all under WinBoard,
as FRC always has to begin with sending the initial position).
So I added the options -firstNeedsNoncompliantFEN, -secondNeedsNoncompliantFEN.
This affects winboard.c and xboard.c, (for defining the option),
common.h, backend.h, backend.c, (for implementing it),
xboard.texi and winboard.rtf (decribing it).
This option provides users with a means to always force the FEN castling field
to KQkq (but can be used for many other work-arounds as well).

2009-06-13 09:30:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug with random calls

There also seemed to be a bug with the shuffling of opening positions;
I had changed the declaration of the position number from
long long int to u64 to comply with MSVC, but this suppressed shuffling
completely. I now changed it to int. I recently noted a problem with true
randomizing anyway: this was based on srand(time()), but time() apparently
did not change fast enough, so that starting several games in rapid succession
(because the book line contained a 3-fold repetition) produced identical games.
So I now seed the random once and for all during startup, based on the msec of
the time mark, and removed the other calls to srand().

2009-06-13 09:26:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed name for fairymax program in xboard.h

2009-06-13 09:25:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed my name from copyright message in help->about menu

2009-06-13 09:22:02 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed -stickyWindows option

I figured out why -stickyWindows was not working in XP and Vista
(while it always worked under Win2K), and I think I found a fix for
it that works under all Windows versions. (I tried XP and Win2K.)

2009-06-13 09:20:38 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Updated docs for Engine-Settings menu

2009-06-13 09:19:05 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Awareness of winning conditions for atomic and giveaway variants; two bugfixes

fixed bug in claim verification
Bugfix on initial position of Great Shatranj

2009-06-13 09:16:47 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Legality testing (mandatory capture) in giveaway variants

2009-06-13 09:16:17 -0700 Arun Persaud <arun@nubati.net>:
don't ignore winboard/parser.c

2009-06-13 09:12:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Added new variant Twilight Chess

2009-06-13 09:08:57 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
some renaming and restructuring of WB menu items, to conform more to XBoard

2009-06-13 09:07:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Fixed bug in atomic patch that interfered with non-atomic variants

2009-06-10 21:46:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed different use of engine option compared to Polyglot

it turns out the new Polyglot uses a sightly different version
of the GUI->engine option command than the one I proposed
(and implemented in XBoard; Michel sneaked in an '=' sign
between the NAME and VALUE of the option, to allow for
more unambiguous parsing. I guess in principle this is a good idea,
so I adapted XBoard to Polyglot rather than the other way around.
The result is that there are canges in xboard.c, and the documentation.
I noticed that I unjustly had internationalized the option strings
to be send to the engine in xoptions.c; this was of course nonsense,
as this was WB protocol. So I undid that too.

2009-06-10 21:37:47 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
add the already supported variants 3check and great (=Great Shatranj)
to the New Variant... menu.

2009-06-10 21:32:22 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
animate explosions in variant atomic (if animate moves is on).

2009-06-10 21:30:19 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed castling bug in variant twokings.

2009-06-10 21:22:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed forteitary wins for special game variations

feature that corrects forfeitary wins (e.g. on time)
of a bare King to draws of course breaks proper operation
in losers, suicide and giveaway

2009-06-09 21:02:51 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
automatically test ini file extension for files from commandline option @filename

The winboard.c is a patch that automatically tries indirection files on the
command line (@filename type arguments) also with an extension .ini if the name itself
did not match any existing file and contained no period. This saves the user typing the
.ini all the time (which I started to find pretty annoying while working on the installer
package).

2009-06-08 15:23:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added gamelisttag option to xboard

also updated documentation.

2009-06-08 15:20:00 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated RTF file for winboard

2009-06-06 09:12:48 -0700 Arun Persaud <arun@nubati.net>:
fixed syntax error in texi file

2009-06-06 08:57:52 -0700 Arun Persaud <arun@nubati.net>:
updated to patchlevel "j"

2009-06-06 09:00:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed adjudicating probelm in Shantranj

Refrain from adjudicating a draw based on insufficient mating material
(except bare King vs bare King) in Shatranj (where in this case you can
still win by baring the opponent's King).

2009-06-06 08:55:17 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated documentation and FAQ

2009-06-04 22:52:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
source clean up. Fix compiler warning, removed unused variables, etc.

2009-06-04 20:43:29 -0700 Eric Mullins <emwine at earthlink.net>:
adding support for different windows compiler

Eric kindly provided us with some makefiles for different windows
compiler and also fixed some issues that came up while using those compilers.

2009-06-04 18:27:26 -0700 Arun Persaud <arun@nubati.net>:
cleanup: got rid of a lot of files that are not needed for a new release

lots of documentation was available in several places,
old unused source files and not used graphics file were floating around
in the tree. This should clean up most of it. No need to keep these files
around, especially since we are using version control.

2009-05-29 18:56:06 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Added the Action-menu items that allow the user to adjudicate
ongoing games in Two-Machines mode. This was an already existing
backend function from Winboard_x; I only had to create a menu item for it
to be called. Due to an oversight I had forgotten to do that so far.
(Logically, I should have done it in the 4.3.5 release,
where I updated the XBoard menus to conform to the WinBoard menus.)

I tested them, and they seem to work. (As expected.)

2009-05-28 22:23:00 -0700 Arun Persaud <arun@nubati.net>:
updated patchlevel to "i"

2009-05-28 22:19:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
small change to mousewheel support; two changes in window behaviour

* Visible effects during resizing suppressed, bug in chosing new size fixed.
* No longer reserves left and top margins next to main window on first popup.
* built in some hysteresis into mousewheel support, ignorng the first event in any new
direction to suppress effects from accidential mouse movement.

2009-05-28 22:11:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
corrected 'animate dragging'

I finally figured out how the 'animate dragging' works in XBoard,
so that I could add code to do the unstacking of multiple pieces
in the holdings, rather than always leaving an empty square while
you drag them. (And then suddenly re-growing the remaining pieces
as you make the drop.)  It does not look as fancy as in WinBoard
yet, because the counts still only decrease when you release the
piece, rather than when you lift it. But this is not nearly as
disturbing as leaving empty holdings (if only temporarily) when
you still have pieces there.

2009-05-28 22:06:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Added comand-line options -debugFile (as synonym for -nameOfDebugFile,
as WinBoard also has these synonyms), and -engineDebugOutput
(wich already existed in the backend).

2009-05-28 21:57:53 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated documentation for new release

2009-05-28 21:55:51 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added Xiangqi perpetual-chase detection

2009-05-28 00:06:53 -0700 Arun Persaud <arun@nubati.net>:
Updated all files to GPL version 3.

2009-05-28 00:03:32 -0700 Arun Persaud <arun@nubati.net>:
converted two files from dos to unix format

2009-05-27 23:12:24 -0700 Arun Persaud <arun@nubati.net>:
updated INSTALL, NEWS and other files for new release

cleaned up a bit and updated some information in the text files.

2009-05-07 21:48:23 -0700 Arun Persaud <arun@nubati.net>:
winboard/config.h shouldn't be in .gitignore, only ./config.h

2009-05-07 21:47:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
bumped patchlevel to 0g

2009-05-07 21:46:02 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
corrected path in makefile

2009-05-07 21:45:48 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated rtf

2009-05-07 21:45:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added firstOptions, secondOptions, noGUI, firstXBook, secondXBook

2009-05-07 21:44:03 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
handle promotion case for Shogi

2009-05-07 21:43:34 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
add note about RESULT command for GUI programmers

2009-05-07 21:42:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
small changes to book.c

 added code for different board sizes
 added some debuginfo
 handle promotion of pieces

2009-05-05 23:07:18 -0700 Arun Persaud <arun@nubati.net>:
added a .gitignore file

2009-05-03 12:41:06 -0700 Arun Persaud <arun@nubati.net>:
wrong line ending for Unix... ran dos2unix on both files

2009-05-02 13:51:50 -0700 Arun Persaud <arun@nubati.net>:
fixed texinfo files, added windows help file, removed config.h from git

texinfo.in is not needed anymore, since it only provided a
version string, but this can be created automatically using autotools

deleted config.h from version control, since it is automatically created.
added winboard.hlp file (not sure if needed)

2009-04-26 23:34:34 -0700 Arun Persaud <arun@nubati.net>:
updated autoconf init file

* renamed autoconf init file from configure.in to configure.ac
* added bug-report email address to ac_init
* replaced ac_output(...) with ac_config_files, ac_config_commands and ac_output

2009-04-26 14:49:03 -0700 Arun Persaud <arun@nubati.net>:
parser.c is generated by lex, so it shouldn't be tracked
and also parcer.c shouldn't be in Makefile.am

2009-04-26 14:44:51 -0700 Arun Persaud <arun@nubati.net>:
added book.c to Makefile.am

2009-04-26 13:49:15 -0700 Arun Persaud <arun@nubati.net>:
use autoheader to create config.h.in

no need to track this in git anymore

2009-04-26 11:13:26 -0700 Arun Persaud <arun@nubati.net>:
fixed autoheader warings, remove depreciated acconfig.h

2009-04-26 10:30:23 -0700 Arun Persaud <arun@nubati.net>:
added a autogen.sh

2009-05-02 10:55:39 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.16

2009-05-02 10:50:10 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.15

2009-05-02 10:38:39 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.14

2009-05-02 10:13:41 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
HGM fixed cygwin compile for winboard

2009-04-24 16:11:57 -0700 Arun Persaud <arun@nubati.net>:
cross compilier working

2009-04-19 10:00:52 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.13

2009-04-19 09:52:47 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.12

2009-04-19 09:48:59 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.8

2009-04-19 09:44:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.7

2009-04-19 09:39:19 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes by H.G. Muller; version 4.3.4

2009-04-19 09:34:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.2

2009-04-19 10:26:24 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller

2009-04-16 23:06:13 -0700 Arun Persaud <arun@nubati.net>:
cleaned up the directory a bit. Removed winboard-dm-beta,
merged the two Changelogs together

2009-04-16 14:12:48 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20060129

2009-04-16 14:09:33 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20060112

2009-04-16 14:04:02 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20051231

2009-04-16 13:59:12 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20051129

2009-04-16 13:53:41 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20050322

2009-04-10 04:18:59 +0000 Arun Persaud <arun@nubati.net>:
translated a handfull of strings and set the codeset to UTF-8
for the translations.

2009-03-18 03:20:50 +0000 Arun Persaud <arun@nubati.net>:
Translation: added German po file (roughly 50% translated)

2009-03-01 04:23:54 +0000 Arun Persaud <arun@nubati.net>:
fixed bug #22853: changed all .Xdefaults to .Xresources in xboard.texi

2009-03-01 02:43:43 +0000 Arun Persaud <arun@nubati.net>:
fixed bug #25672, patch #6182 by adding DESTDIR support to Makefile.in

2009-03-01 02:33:26 +0000 Arun Persaud <arun@nubati.net>:
fixed a warning message in the configure script

2009-02-28 22:58:57 +0000 Arun Persaud <arun@nubati.net>:
fixed parser.l. Should fix bug #22812

2009-02-28 22:58:14 +0000 Arun Persaud <arun@nubati.net>:
fixed parser.l. Should fix bug #22812

2009-02-28 22:55:30 +0000 Arun Persaud <arun@nubati.net>:
added myself to the AUTHOR file

2007-06-15 04:26:57 +0000 Mark Loli <chessknight>:
Initial check-in of NSIS Winboard installer files.

* 06/12/2005: bugfix some more possible buffer overflows.

* 06/27/2004: added simple icsEngineAnalyze for xboard

* 06/26/2004: added icsEngineAnalyze for winboard: Analyze observe games
with a chessprogram on a Internet Chess Server (ICS)

* 02/12/2004: Bugfix ICS interaction console crashed while chess
engine starting and user type in some stuff. We wait now to finish
the engine boot.

* 02/11/2004: Winboard: Added color lines for the ics interaction
console if zippy used

* 02/09/2004: Added mousewheel support for winboard. Play moves
backward and forward with the mousewheel.

xboard/WinBoard 4.2.7 -- Fri Nov 28 13:36:00 PST 2003 -- Tim Mann

* 11/26/2003: In WinBoard, setting the -debug flag now logs ICS output
to WinBoard.debug too.  (This isn't needed in xboard because ICS
output already goes to stdout, so it's easy to capture along with the
debug output on stderr.)  This was issue #280 in the ToDo file.

* 11/23/2003: Cleaned up some minor problems in cygwin.mak.  Thanks to
Hans Werner Strube for the problem report.

* 11/23/2003: Updated the default list of chess servers in
winboard/defaults.h.  Deleted two that appear to be dead and added a
new one that is active.

* 11/19/2003: Swapped icon_white.bm and icon_black.bm in XBoard.
Hopefully this will get them the right way around by default on more X
window managers.  I wish I understood this better.

* 11/18/2003: Implemented a simple 32-bit random number generator for
WinBoard, replacing the Windows rand(), which ranges only up to
0x7fff.  Formerly on Windows, only zippy.lines sayings that started in
the first 32767 bytes of the file could ever be used.  This was issue
#505 from the ToDo file.

* 11/16/2003: The xboard man page and info files are now built from a
common set of texinfo source files, and the xboard man page now covers
cmail as well.  Formerly, ever since the texinfo file was first
contributed to the project, it was separate from the man page and the
two files had to be updated in parallel, making for a maintenance
nightmare.  To make combining the files possible, I took the Perl
script "texi2man" from the GNU Units project and added support for a
larger subset of the texinfo markup language.  I then carefully
compared the old man page and old texinfo file to make sure the latest
and clearest words survived into the new combined texinfo file.  It
would be great to merge in WinBoard's help file too, but that's a
larger project.  It would have to be heavily conditionalized to
deal with differences in features between XBoard and WinBoard.

* 11/15/2003: Cleaned up and applied a small patch from Daniel
Mehrmann, to stop overly long PVs in thinking output from causing a
buffer overflow crash in backend.c.

* 11/5/2003: When a chess engine sends a "telluser" command (including
the cases where "tellall" or "tellopponent" acts like telluser), the
information now goes into a nonmodel popup that is automatically
dismissed when the user clicks anywhere on the board.  This fix is
more significant on WinBoard, where formerly you got a fully modal
dialog that had to be dismissed by clicking on OK before anything else
could happen.  The bug was issue #406 in the ToDo file.

* 11/1/2003: Removed email addresses from this file to reduce spam
load, as it gets linked to from the Web.

* 11/1/2003: Updated READ_ME and winboard/READ_ME.txt.

* Modified xboard and winboard makefiles to be able to build the
project in the new combined directory structure.

* Applied a small security fix to pxboard, from Martin Maeok.

* Fixed a bug in the game list dialog.  The change in 4.2.6 to opening
games in text mode (meant to avoid getting extra \r's into comments)
caused a new bug in determining seek offsets when parsing a game file
to form the game list.  Also, the change was incomplete; on some code
paths games were still being opened in binary mode.  Thanks to Lenik
Terenin for reporting the offset bug.  I've now gone back to always
using binary mode when reading game files, and I've fixed the comment
bug by adding code to remove \r's from parsed comments explicitly.  I
still use text mode for writing game files so that games written by
WinBoard will have Windows-style line endings.

* Fix for minor bug in WinBoard installer.  If you chose a non-default
destination directory, the default directory was still used for a
couple of unimportant things, namely setting the App Paths registry
keys (unused by WinBoard) and trying to copy the existing WinBoard.ini
file to WinBoard.old.  I inherited this bug from the InstallShield 5
sample template.  Thanks to "l.d." for noticing the incorrect keys.

* Patch from Chris Priest: when two engines are being run through rsh,
avoid reusing the same stderr port for both.  I'm not sure why this
should be needed, but it's harmless, at least.

* Bugfix: The kludge to deal with old engines that give an error
message because they don't know the "st" command was too sloppy; it
could hit on an "st" substring anywhere in an error message.  GNU
Chess 4 is the only engine I know of where the kludge was needed, so I
changed the kludge to match a longer, more GNU-specific string.

* Changed the WinBoard self-extracting installer to choose a unique
temporary subdirectory name within the Windows temp directory instead
of always putting wb-setup directly in temp.  Besides being better
practice, this avoids the need to deltree wb-setup first, which
occasionally alarms someone who thinks that deltree is only used by
trojans to delete all your files.  (Yes, I'm serious.)

* Fixed a bug where FICS-style "wild/0" strings were not parsed as the
proper wild type.  The "/" was not being skipped.

* Fixed a WinBoard bug where temporary files created by game
copy/paste were being created in the root directory of the current
drive instead of the TMP directory and were not always deleted on exit.

* Fixed a small bug in winboard.c's ErrorDialog() function.  Thanks to
"Ron" (no last name given).  The bug might have caused a problem when
pressing OK or Cancel in an error dialog when more than one error
dialog was being displayed, but I'm not really sure.

* Removed a hack that worked around a bug in very old versions of
Crafty, where it would sometimes reply "illegal move" to a "."
command.  The hack kept us from recognizing real illegal move messages
in analyze mode from engines that don't respond to the "." command.
Thanks to Fabien Letouzey for the report.

* Fixed a bug in the xboard version of GetDelayedEvent.  It would
return the most recently scheduled event even if it had already fired.
This caused at least one visible error: in -ics -xreuse mode, starting
the engine again and seeing another "feature done=1" would re-run the
initialization code in InitBackEnd3, including the code that opens the
connection to ICS.  The WinBoard version didn't have this bug.  Thanks
to Bob Hyatt for the bug report.

* The promotion popup for ICC wild 26 (giveaway) now includes King.
Thanks to Fredrik Josefsson for the bug report.

* The first game in a file (or being pasted from the clipboard) can
now start with a bare move -- no PGN tags, no move number "1", etc.
Suggested by Shane Harrelson.  One could imagine taking this farther
and accepting something like "e4 e5 1/2-1/2 d4 d5" as two games, but
I haven't done that.

* Bug fix: xboard didn't really accept a paste of multiple games,
contrary to what I wrote when adding the feature to WinBoard in
4.2.4.  Now it works in both.

* Fixed generic start/end of game messages to work on chess.net, where
they put ratings in parens after the player names.

* Updated config.sub and config.guess to newer versions from
automake-1.4p5-2.  This makes configure work with MacOS X + X11.

* Bugfix: when examining a game fragment on FICS where black plays
first, don't show two "(0:00.000)" times on the initial "none" move.

* If TestLegality is on and one of the engines makes an illegal move
in TwoMachines mode, it forfeits immediately.  Formerly the game would
get stuck at that point and the engine that made the illegal move
would eventually lose on time.

xboard/WinBoard 4.2.6 -- Fri Feb  1 22:26:31 PST 2002
Tim Mann

Another small bugfix release.

* Put in a small change from Alexander Mai to allow xboard to build in
an OS/2 EMX environment.

* Fix WinBoard-only bug where editing a PGN file with comments would
insert more \r characters before the \n after every Load/Save cycle.
For some unknown reason we were reading the files in "rb" mode but
writing them in "a" mode, so we kept the \r characters on reading and
added an extra one on writing.  Fix: change the "rb" to "r".  Thanks
to Joel (last name not given) for the bug report.

* Put the arguments to rsh/remsh in the right order for better
portability.  Thanks to Michael Kalisz.

* FreezeUI is now implemented in WinBoard; it was previously only
implemented in xboard.  This function prevents the user from entering
moves or other commands while we are waiting for an engine to
initialize itself.  Implementing it fixes a bug where the user could
start a game (etc.) during feature negotiation.  One of the symptoms
of this bug was that we could send "new" one or move moves *after* the
first game started!

* Fixed some handle leaks (WinBoard only), including a nasty one that
leaked one handle per command sent to ICS.  Thanks to several folks
who helped characterize the bug and tried to look for leaks.

* We now install and look for the info file in ${prefix}/share/info
instead of ${prefix}/info.  The latter is still the default in
autoconf, but the former is currently used in Red Hat Linux and
probably elsewhere.

xboard/WinBoard 4.2.5 -- Sat Dec 15 11:42:51 PST 2001
Tim Mann

* Changed the bundled GNU Chess 5.02 in the WinBoard package to
include a much smaller book and to use much less hash table space by
default (8 MB transposition table, 0.5 MB pawn evaluation table).  The
large book included with 4.2.4 made the WinBoard download too big for
some people, and the default hash tables were larger than the
available physical memory on some people's computers. I built the
small book by running Crafty's "small.zip" book line collection
through a Perl script that makes it look enough like real PGN games
that the GNU Chess book builder will accept it.  The script and some
minor patches to GNU Chess 5 are available in the WinBoard source
distribution and at http://www.tim-mann.org/gnuchess.html.

* Fixed a bug in the code that deals with engines that complain that
"time" and "otim" are illegal moves.  This was a new bug in 4.2.4.

* Revamped the implementation of ToStart in analysis mode.  Formerly
there was some ill-conceived code that would try to get back to the
start of the game by doing a "new" command (and all the followup
commands that requires) while remaining in analysis mode.  This is
problematic for engine authors to support, though it works with
Crafty.  This code was trying to solve the problem of ToStart being
slow because the engine would try to start an analysis after every
"undo" command all the way back to the start.  But ToEnd already had a
much better solution to this problem, and now ToStart does the same
thing: we exit from analysis mode and enter force mode instead,
make/unmake moves to get to the end/start of the game, and then
reenter analysis mode.

* Formerly, Zippy could try to start playing a game before the engine
was initialized; that is, during the initial timeout for protover 1
engines, or before "feature done=1" for protover 2 engines.  We now
wait until the engine is initialized before connecting to ICS, which
fixes this in the common case.  If you turn off engine reuse for
multiple games (that is, if you give the -xreuse option), there could
still be problems; see item 503 in the ToDo file.  Thanks to Dieter
Buerssner for the bug report.

* Bugfix: All WinBoard versions since the merge with WinBoard Plus
(but not xboard) have had a bug in changing the PeriodicUpdates,
PonderNextMove, and ShowThinking options from the menu.  The bug
mostly just caused changing these options during a game to not take
effect until after the next reset.  For TwoMachines games, though,
changing PonderNextMove just before the game would take effect
immediately for the second engine but not until the next game for the
first engine.  Thanks to Koundinya Veluri for the bug report.

* Bugfix: In 4.2.4, we sometimes got confused when trying to leave and
reenter analyze mode.  One symptom was that Analyze File did not work.
Thanks to Igor Syry for the bug report.

xboard/WinBoard 4.2.4 -- Sun Dec  9 14:56:30 PST 2001
Tim Mann

* WinBoard now includes GNU Chess 5.02 in place of GNU Chess 5.00.

* WinBoard's PasteGameFromClipboard will now handle a paste with
multiple games in it, popping up the game list dialog.  xboard
already did this.  Suggested by Robert Gerstman.

* We now use the "clearboard" command on ICC where appropriate.

* Bugfix: don't generate a bogus "variant normal" command to an engine
for the loadable ICC wild types that we internally flag as
VariantLoadable.  Also clarified the message that Zippy sends when
declining such wild games -- it can't deal with the possibility of
loading an arbitrary position into the game.  Thanks to Dieter
Buerssner for reporting the problem.  It would be nice to be able to
actually play these wild types some day; presumably there would have
to be an option to either send "loadgame" with a specified position,
or to deal with an opponent sending it.

* If we get a holdings message from ICS when we thought we were
playing normal chess, we now try asking for a move list so that we can
find out from the header what's really happening.  Formerly we guessed
bughouse in this case.  Response to a comment from Gian-Carlo
Pascutto.

* Fixed two longstanding bugs in the clock code.  These affected only
play between a user and a local engine, or between two local engines,
not ICS play.  (1) The last fractional second used by a player before
moving and virtually pushing his clock was being charged to his
opponent instead of to him.  (2) The time and otim commands were being
sent to an engine before the (buggy) fractional second update was
done.  The second bug was pretty harmless in itself, but the first one
was serious.  Many thanks to Peter Rosendahl for carefully diagnosing
and reporting these bugs!

* Changed WinBoard timestamp key.  Nothing is changed other than the
key and a recompilation.  ICC may phase out the old key soon; if they
do, you'll need to use the timestamp.exe from WinBoard 4.2.4 or later
to connect to chessclub.com.

* Fixed an xboard-only bug where most dialogs would not take keyboard
input unless the mouse was actually over the dialog, even if the
dialog window had focus.  Thanks to Jason Varsoke for the bug report.

* Bugfix; Remember to send time and otim commands to engine before
sending playother.  Thanks to Bob Hyatt for the bug report.  Also
fixed a bug where time and otim were sometimes sent even with feature
time=0.

* Added small patches from Wilkin Ng that are meant to fix a crash in
CopyGameToClipboard and a "can't unlock clipboard memory" error in
PasteTextFromClipboard, under Windows 2000.

* Changed cygwin.mak to not use -mno-cygwin.  In other words, it now
uses cygwin1.dll instead of the mingw libraries.  This works around
bugs in fileno() and stat() that I encountered in mingw.  (fileno
seems to always return 0.  stat fails because the library routine uses
a different definition of struct stat than the header files provide.)
Thanks to Robert Gerstman for reporting the symptoms these bugs caused
when WinBoard was compiled with Cygwin.

* Added -showButtonBar option.  This lets you delete the << < P > >>
buttons and thus widen the message widget a bit.

* Added code to address a very obscure bug.  If an engine dies and
needs to be restarted while in one of the analyze modes, it was not
getting put back into analyze mode.  This bug should not really ever
have gotten tickled unless reuse was turned off and the engine sends
game end commands (such as 1-0) when a game ends by rule while in
analyze mode.  The next version of the protocol spec will say that
engines should not do that, but version 2 and earlier didn't address
the issue.

* We now use the FICS "iset ms 1" feature to get times in ms instead
of seconds.  Thanks to DAV for email telling me about this feature.

* Changed clock display to show tenths of seconds for 9.9 seconds and
less, instead of 0.9 seconds and less as before.

* It has been discovered that Zippy can play simuls on ICC (but not on
FICS).  If you arrange for Zippy to send the ICC command "simulize" in
the -zippyGameStart string, it will accept additional games while
playing.  Zippy will use the same engine for every game, so whenever
it switches opponents, the engine's state will be reset with the "new"
command.  This will of course weaken its play, so don't enable simuls
if you want your engine to have the highest possible rating.  Zippy
was never designed to work with simuls; it just works by accident, and
it hasn't been tested much.  So please report any bugs you notice, but
don't expect them to be fixed rapidly.  Thanks to Paul McGuire for
noticing that this works.

* Bugfix: Suppress the direct command to engine popup if there is no
engine.  In WinBoard this case used to cause a crash.  Thanks to
"Dargon" for the bug report.

* Bugfix: formerly we did part of the engine initialization for the
very first game too soon, before feature negotiation.  One result of
this is that engines would never get the "ics" command for the first
game.

* Lengthened timeout to detect protocol version 1 chess engines to 10
seconds.  This should reduce problems with protocol version 2 engines
that are slow to initialize missing the timeout and not getting a
chance to send their feature commands before the first game starts.

* Klaus Friedel says that adding a short sleep to WinBoard after
starting a new chess engine solves a problem that occurs under Windows
2000, in which engines sometimes don't see the initial command(s) from
WinBoard and hang.  I don't understand how that can happen, but the
sleep is harmless, so I've put it in.  Others have also reported what
may be the same problem, so hopefully this will fix it for them too.

* Bugfix: editing the Result field in EditTags will no longer cause a
later crash.  Thanks to DAV for a clear bug report that let me
reproduce the problem.

* ICC wild 28 is now recognized as shatranj, but it is not supported.
You might be able to play it by turning off Test Legality.

* Formerly we would always turn off "feature time" if the engine
printed an error message with the string "time" or "otim" in it; now
we do that only if the message comes before the engine makes its first
move.  This change is useful because some engines spew a lot of bogus
error messages about commands they don't fully parse, so something
like "result 0-1 {White lost on time}" could generate such a message.
Engines shouldn't do that, but if they do, mysteriously turning off
"feature time" is not a good way to react.

* Fixed an infrequently occurring Zippy bug: formerly, resuming from
adjournment by position (that is, with GetMoveList turned off) or
starting/resuming a wild game (nonstandard starting position) would
try to set up the position without putting the engine into force mode
first.  That was probably tolerated by most engines, but if the
position was black-to-play and the engine hadn't set feature
setboard=1, then the fake "a2a3" move (which we use as a kludge to get
black to be on move before sending the edit command) would appear to
be a real move, and the engine might reply to it!  This bug could also
be seen when trying to use Zippy to play a simul -- something that
Zippy was never designed to support, but which seems to mostly work
anyway.  Thanks to Paul McGuire for sending a WinBoard.debug file that
showed the bug occurring.  Some other cases of resuming adjournments
or starting games from nonstandard positions may have been broken too;
I think I've straightened out the problems.

* Agreeing to a draw in the human vs. local engine case formerly did
not work if the human offered first; now it does.  A human's
unsolicited offer is considered valid until he makes another move.
Thanks to Bruce Moreland for the bug report.

* Bugfix: We used to look for just "fr" in Event tags or strings from
ICSes to recognize Fischer Random games.  This caused a lot of false
matches.  Now we look for "wild/fr" instead, which is what FICS uses.

* Bugfix: Clicking on a move in the MoveList window only updated the
displayed position; if a chess engine was active, its state was not
updated.  Thanks to Alejandro Dubrovsky for the bug report.

* Bugfix: The "resign" command from engine to xboard formerly did not
work in ICS (Zippy) mode.

* Bugfix: Formerly we would register a garbage premove if the user
clicked on a piece, then clicked on an edge or outside the board.  Now
such an errant click is ignored.

* Bugfix: GameEnds would send "exit" to an engine in analyze mode even
if we did not actually want to leave analyze mode.

* Bugfix: "feature pause" was being rejected.  We don't currently use
it, but that is no reason to reject it.  Thanks to Gian-Carlo Pascutto
for the bug report.

* Bugfix: when "partner" needed to be sent both to ICS and the engine,
Zippy was erroneously sending the ICS prefix character to the engine
too.  Thanks to Gian-Carlo Pascutto for the bug report.

* Zippy now declines challenges when the engine is not yet ready to
play again, instead of ignoring them.  This is needed so that the
server will let the opponent repeat the challenge.  It might be better
to remember such challenges and accept them when the engine is ready,
but that would be a bit more complicated to implement.

* Bugfix: Zippy's emotes didn't work on FICS because there, "i" is a
built-in alias for "it", not a real command.  So sending "$i foo" gave
an error message instead of doing "it foo".  We now leave out the
alias-suppressing prefix for emotes.

xboard/WinBoard 4.2.3 -- Mon Feb 19 19:55:05 PST 2001
Tim Mann

* Bugfix: The error message "Variant X not supported by gnuchessx"
formerly could pop up even in -ncp mode.

* Fixed an xboard bug in premove highlighting.  If you had
HighlightLastMove turned on, premoves got highlighted in
highlightSquareColor (yellow) instead of premoveHighlightColor (red).

* Modified premove again.  Now we are back to displaying the move
locally immediately after sending it to the server, as in versions
prior to 4.2.1.  This is good because it lets you register your next
premove sooner.  As a better fix to the problem that the change in
4.2.1 had been trying to address, we now suppress animating the
opponent's move if you have a premove reply pending.  However, it's
probably still a good idea for you to turn off AnimateMoves entirely
if you are trying to play extremely fast games.

* Removed an erroneous patch that left zombie chess engines around
when both sigterm and reuse were turned off.  (Bug was in xboard only,
not winboard.)

* Bugfix: loading a game with autostepping did not work for games with
PGN result "*" (unfinished).  This bug was introduced in 4.1.0, caused
by some outdated code that was supposed to leave you in EditGame mode
after loading an unfinished game.  I fixed this, and also changed it
to leave you in EditGame mode after loading *any* game, but without
changing the tags to say it's an edited game.  It's not really clear
whether that is the best thing is to do here -- ideally, perhaps, the
tags should change to say "edited game" if you actually make any
changes, but that is harder to make work.

xboard/WinBoard 4.2.2 -- Tue Feb  6 20:00:00 PST 2001
Tim Mann

* Fixed a problem introduced in 4.2.1.  In -zippyPlay mode, 4.2.1
started sending the initString immediately after the old game ended,
but then when the next game started, it would still send "force" and
another initString.  Another problem was that the first initString put
the engine out of sync with the displayed board position, though that
might not usually have been noticeable.  This is now changed to do a
full Reset at the end of the previous game, and avoid doing a Reset at
the start of a new game if we are still in BeginningOfGame mode.

* Fixed some limitations in -zippyPlay mode.  The engine was not being
fed the moves or history of games that were displayed but not being
played, so it would get confused if you tried to do something like
examine a game, then enter EditGame mode from somewhere in the middle
of the game.

* Made a small change so that cygwin can compile xboard for Windows
(an X server is required to run it).  Thanks to Volker Zell.  Most
people would probably prefer to run WinBoard on Windows, however; note
that cygwin could already compile WinBoard.

* Added some missing documentation to engine-intf.html: It is okay to
send "feature done=0" even before you receive the xboard and protover
commands, if this is needed to give your engine enough time to
initialize.  See engine-intf.html for more discussion.

* Bugfix: "feature done=0" did not work for the second engine; now it does.

xboard/WinBoard 4.2.1 -- Sat Feb  3 19:52:26 PST 2001
Tim Mann

* Bugfix: in Zippy mode with feature san=1, the elapsed time was being
sent to the engine after the SAN move; for example, "e4 (0:01)" was
sent instead of just "e4".

* It seems that scroll wheel mice with incompletely installed software
(under Windows 95, at least) can send repeated middle button up events
when the wheel is turned.  Moved QuickPaste from middle button up to
middle button down to avoid problems with this.

* A premove is now sent *before* the opponent's move that it replies
to is animated.  The premove itself is no longer displayed (or
animated) when sent; instead, it is displayed when the chess server
echoes it back as a board update.

* Bug fix: in -xreuse mode, xboard was only sending command line
arguments to the engine the first time it was started.  (WinBoard
didn't have this bug.)

* In -zippyPlay mode, we now initialize the chess engine for a new
game immediately after the old game ends.  (In -xreuse mode, this
means starting a new engine process; in the default -reuse mode, it
just means sending "new".)  If the engine supports ping, we don't
accept challenges until the "new" has finished.  This should help
avoid losing time (re)initializing the engine after the game starts.

* We now handle the new FICS field in style 12 that says whether the
clocks are ticking.

* whiteFlag and blackFlag are now reset whenever an ICS board image
arrives, giving autoflag a fresh chance to work.

* Suppressed "geometry error" debug messages unless -debug flag is given.

* Bugfix: avoid core dump on Solaris with -debug flag, caused by
passing NULL to a %s format in GameEnds.

* Added -firstProtocolVersion and -secondProtocolVersion.  This will
allow use of extremely broken engines that hang or die when given the
"protover 2" command.  It should be rarely if ever needed.

* Zippy now strips highlights from player names in the Creating
message; previously the ratings would not be extracted from this
message properly if you had set the highlight variable.

* Bug fix: Zippy with -zp but not -zt used to be fooled by false
partner tells inside channel tells; e.g.:
Garf(24): Garf (your partner) tells you: sit

* Bug fix: when an engine reported its name with the new "feature
myname=" command, we had been putting just that name into the window
title even when in TwoMachines mode.

* By default, WinBoard no longer uses the new feature introduced in
4.2.0beta of keeping the ICS menu, ICS server list, and lists of chess
engine command lines in separate files; instead, the lists are back in
the winboard.ini file.  This gets rid of some problems where the
separate files could not be opened because the working directory was
not set to WinBoard's installation directory.

* WinBoard command lines and ini files now have another optional
syntax for quoting an option value.  All characters within { } curly
braces are interpreted literally except for '}' itself.  SaveSettings
now uses this syntax for string values that contain a backslash or
newline and do not contain a '}'.  This should address the problem
that the separate .ini files had been meant to fix; engine command
line lists can now be written without \-escapes.

* Fixed three bugs in relaying moves between engines in TwoMachines
mode: an engine would be sent SAN if the *other* engine had set
feature san=1, a relayed SAN move did not end with a newline, and
feature usermove was not implemented for relayed moves.

* Fixed several bugs in exiting: File/Exit would sometimes hang;
timestamp/timeseal would not get killed off; an engine crash would
cause error messages to be printed recursively until stack overflow.

* Fixed a bug in the code to detect which ICS is in use and adapt to
it; the chess.net case was broken.

* Removed the leading alias-suppression character when sending a move
to ICS, because it seemed to break accuclock on chess.net.

* Fixed a bug where a FICS prompt like "10:01_fics%" would be matched
as finger note number 10, causing a problem detecting when the user is
logged in.

* Added tellicsnoalias command to protocol.

* Changed st command in protocol back to old behavior.

* Added done=0 feature to protocol, to lengthen initial timeout.

* Added missing -colorSeek command line option to xboard.  (Was
present in WinBoard.)

* Bug fix: setting feature reuse=0 was not working.

xboard/WinBoard 4.2.0beta -- Sat Dec 16 16:34:56 PST 2000
Tim Mann

* Setting -searchTime no longer turns off -clockMode.  Note that when
-searchTime is set, some engines may search for the lesser of
searchTime and the amount of time their normal clock management would
dictate, while others will disable their normal clock management and
always search for exactly searchTime.

* Fixed WinBoard bug where on Windows 2000 (and maybe Windows 98) the
ICS Interaction window would scroll back to the top whenever it filled
to capacity and WinBoard trimmed some text off the top.

* Changed xboard dragging so that the center of the dragged piece is
forced to be over the mouse cursor.  (WinBoard dragging already worked
that way.)  This should avoid confusing cases when you start a drag
with the mouse near the edge of a square -- formerly most or all of
the piece could be over one square but the mouse cursor over another.
Suggested by DAV.

* Added move list window for xboard.  Code contributed by Manuel
Hoelss and re-hacked a bit by me.  Performance of this window is poor,
because the implementation regenerates the entire window contents
whenever anything changes.  It's hard to avoid this when using the
Athena List widget, though we could be a little smarter and notice
when the current move number has changed but the move list has not.
There are also several drawing problems caused by bugs in the Athena
Form and List widgets.  The window should not really allow a
horizontal scroll bar, but the bugs are much worse if I turn it off.
In both Xaw and Xaw3d, the List widget tries to resize itself when
XawListChange is called, even if you tell it not to; and what's worse,
if the widget cannot resize itself to be large enough to avoid
clipping any of the list item, it does not change the list!  Arrgh.
On top of that, the Xaw Form widget is very buggy in XFree86 4.0.1
(X11R6.4.3).

* The OK button in the WinBoard startup dialog is now simply disabled
if none of the radio buttons is selected, instead of bringing up an
error dialog.  Suggested by Ted Milbaugh.

* Used ping to address the worst of the race conditions in the
protocol.  Now if an engine supports ping, we ping it after sending
the "new" command and after trying to place it in force mode at the
end of a game.  When a ping has been sent and the corresponding pong
has not yet come back, we (1) ignore or undo any moves the engine
sends, (2) ignore game end messages (such as "offer draw", etc.) from
the engine, (3) ignore thinking output from the engine, (4) delay
starting the next game if in -matchGames mode, (5) in -zippyPlay mode,
respond to challenges with a polite message to try again soon instead
of accepting them.  There are a few more things that should be done
(and item 5 might not be quite what we want), but it's hard to fit
them all into the existing code.

* Patched the version of GNU Chess 5.00 included with WinBoard to
support protover, feature, setboard, and ping, and to fix some minor
bugs.  See gnu500+.patch.

* Changed the GNU Chess 4 kludges for missing "st" and "sd" commands
to be invoked only if the engine gives an error message for "st" or
"sd", and to always use protocol commands instead of engine
command-line options.  See "Idioms" in engine-intf.html.

* Added new protocol command "protover 2" to tell the engine what
version of the protocol is in use.  Version 2 is still compatible with
old engines; see engine-intf.html.

* Add new protocol command "feature ..."  The engine can send this in
response to the protover command command, to say what extended
protocol features it would like to enable, etc.  xboard responds
"accepted F" or "rejected F" for each feature F that is set.  See
engine-intf.html.

* Added new protocol command "setboard <fen>".  This is an alternative
to "edit", used only if the engine says "feature setboard=1".

* Added new protocol command "ping <msg>".  The engine is supposed to
respond "pong <msg>".  This gives us a tool to fix some race
conditions in the protocol, but it is not used to the fullest yet.

* Added new protocol command "tellopponent".  This will do a "say" if
you're on a chess server in Zippy mode, or pop up an information
dialog otherwise.

* Added new protocol command "tellall".  This will do a "kibitz" if
you're on a chess server in Zippy mode, or pop up an information
dialog otherwise.

* Added new protocol command "tellothers".  This will do a "whisper" if
you're on a chess server in Zippy mode, or do nothing otherwise.

* Changed the WinBoard /icsNames, /icsMenu, /firstChessProgramNames,
and /secondChessProgramNames options to accept a filename preceded by
"@", meaning to find the value in the file.  Changed the defaults to
use this feature, with filenames icsnames.ini, icsmenu.ini, fcp.ini,
and scp.ini.  This should make it easier for users to edit the values,
since one less level of quoting is needed, and each value is in its
own file, not mixed into winboard.ini.  Those who upgrade from an
older winboard version and already have a winboard.ini file will not
automatically have these values moved to a file; that has to be done
by hand if desired.

* We now strip .exe from engine names for "name" command, tags, etc.

* Allowed WinBoard input widget to hold more than one line.  You can get
a newline into the widget with copy/paste or with Ctrl+Enter.

* Fixed an xboard bug where the [P] button would appear in the
opposite highlight state from what it should be after being pressed.

* We now use the "/" or "$" alias suppression feature on the chess
servers, to avoid problems if the user inadvertently aliases a
needed command to something else.

* Changed the method used to deiconize xboard in AutoRaise and cmail.
This may fix bugs under some window managers where after
deiconization, the board window was mapped but nothing was drawn
inside.

* Preliminary, partial support for playing several chess variants
against a local engine or editing variant games.  The -variant option
must be given on the command line or WinBoard startup dialog; there is
no menu.  The current variant is not displayed (except in the
Tags/EditTags window).  Many variants will not work quite right even
if the engine supports them; see item 326 in the ToDo file for
details.

* Added a workaround to detect the variant type when examining a
scratch wild game on an ICS.

* Fixed two cases where "variant" command should be sent to the engine
when necessary but was not: loading a game from a file and restarting
a dead engine.  Thanks to Gian-Carlo Pascutto.

* Added missing support for FICS games that start from a bsetup position
with Black moving first.

* Fixed a bug in loading a file from the game list window while in
Analysis or AnalyzeFile mode.  This now leaves us in AnalyzeFile
mode, analyzing the new file.

* Fixed a bug in loading games with a comment before the first move.

* Fixed a bug in handling LoadGame (or -lgf) with -td 0.

* Added a command line option to select an initial minor mode from the
Mode menu.  This should satisfy requests from a couple of users with
special applications.

* Fixed a problem where some things in WinBoard's General Options
dialog box were grayed out at the wrong time.

* We look for a few messages from the chess engine pipe that are
intended to catch problems starting an engine via rsh, such as "No
such file".  Moved code so that these strings won't match until other
protocol messages have been looked for, and documented the messages in
engine-intf.html.

* Fixed the WinBoard bug that sometimes made the console input box
white-on-white even when not in password-entry mode.

* Small changes to WinBoard to be compilable with the latest Cygwin
net release (as of 10-16-2000).  Thanks to Mark Schoenberg.

* Recompiled GNU Chess 5.0 for WinBoard with the latest Cygwin net
release (as of 10-16-2000).  Also rebuilt the book just to be sure,
since I had one bug report about it.  It came out identical and seems
to work fine.

* Added messages for some common InstallShield errors instead of just
printing InstallShield's stupid error code numbers.

* Added -firstComputerString and -secondComputerString, allowing you
to suppress or change the command that is sent to a chess engine when
its opponent is another computer.

* Added "configure --with-Xaw3d" to allow use of Xaw3d widgets instead
of Xaw widgets in xboard.  Thanks to Johnny C. Lam of the NetBSD
project.  I've left Xaw as the default because Xaw3d is too ugly.

* The version of the Xaw Form widget released in XFree86 4.0.1
(X11R6.4.3) has a bug that causes xboard to display the button bar
on top of the message widget.  I've reported the bug and have
installed a kludge workaround into xboard.

xboard/WinBoard 4.1.0 -- Sun Sep 17 17:30:14 PDT 2000
Tim Mann

* Merged Winboard Plus 4.0.8 from Mark Williams into xboard
  source pool.  Status of Winboard Plus features in xboard:

  - White pieces now have borders, but the implementation is
    completely different from WinBoard's; see below.

  - Options menu not changed, probably won't be.

  - Copy&paste support working, using Mark's changes to backend.c, Ben
    Nye's changes to xboard.c for FEN positions, and some code of my
    own in xboard.c for PGN games.

  - Premove hooked up and working.  No pre-first-move, though.

  - ICS Alarm hooked up and working.

  - Auto-flip working.

  - PGN Training mode hooked up and working.

  - Improved menu item enable/disable working.

  - Improved >> button working.

  - Auto activate board working.  I changed this to be optional; you
    might not always want it, especially in Zippy mode.

  - Blindfold working.

  - Documentation updated.

* Fixed more colorization bugs.  Commands like "message foo tells you:
xxx" and "tell 33 tells you: xxx" will no longer generate bogus
colorization.

* Added low-tech sound support to xboard, by invoking an external
program on a filename for each sound to be played.

* ICC wild 27 is now recognized as VariantAtomic, and it sets the
"ignore check" flag, but is not otherwise supported.

* Converted the piece bitmaps from .bm to .xpm for use with xboard's
xpm support.  (An .xim version was not created.)  Wrote a shell script
using ImageMagick to do the conversion and to bucket fill from
coordinate 0,0 with the background color.  Used xpaint by hand to
clean up a few pieces where background color "leaked" into the inside
or didn't flow all the way around the outside, then a sed script to
fix up color names and bitmap names in the xpaint output.  If any more
sizes are added later, they should be straightforward to convert with
reference to the existing scripts.  With this conversion, not only do
the white pieces now have dark borders, but (unlike with WinBoard) the
light details on the black pieces are opaque.

* If the XPM library is found when building xboard, the new xpm pieces
are compiled in as the default.  External bitmap (or xpm) pieces can
still be used by giving the -bitmapDirectory (or -xpmDirectory)
option.  If the XPM library is not found, the old bitmap pieces are
the default.  In this case external bitmap (or xim) pieces can be used
by giving the -bitmapDirectory (or -xpmDirectory) option.  There is no
way to compile in xim pieces.

Winboard Plus 4.0.8 -- Sat Aug 5 15:51 PDT 2000
Mark Williams

* Bugfix release.

* Main menu now visible in Win NT.  Thanks to Microsoft for creating a
compiler which auto-mutilates the WinBoard.rc file so that the menu is
displayed under Win 98 but not Win NT.  I fixed the problem by hand editing the
.rc file.  Sigh.

* "Reset game" now works properly when invoked from Analysis mode when two
engines are present. Correction of bug introduced in Winboard Plus. Thanks to
Mogens Larsen for reporting the bug.

* Pasting a FEN position with Black to move now works in all modes.
Thanks to Mogens Larsen for reporting the bug.

* Added gnuchess.dat to the distribution and a couple of text files that were
missing in 4.0.7.

*** Merged in the following changes from Tim Mann:

* Bugfix: Highlights would sometimes not be taken down, at least in
xboard.  The problem is that SetHighlight works in chess coordinates,
not view coordinates, so if flipView has been toggled since the
highlight was put up, it gets taken down from the wrong square.  Fixed
by being careful to call ClearHighlights before toggling flipView, not
after.  Ugh.

* Bugfix: HighlightLastMove would sometimes highlight square a1 after
a FICS "tomove black" command.

* Bugfix: a move list with initial position that has black to play was
not being handled correctly.

* Removed "decline abort" and "decline adjourn" commands from Zippy.
The syntax is changing on FICS, and Zippy really doesn't have to
explicitly decline the requests anyway; it's sufficient to not accept
them.

* ICC wild 26 is now recognized as VariantSuicide (the FICS name; ICC
calls it "giveaway").

* Bugfix: PGN games with black to move in the initial position weren't
being legality checked correctly.  I think this was introduced in
4.0.6 when I fixed a different PGN bug.  Thanks to Mark Williams for
spotting the bug and suggesting a fix.

* Bugfix: the initial "name(" of a kibitz wasn't being colorized.

Winboard Plus 4.0.7 -- Thu May 12 17:57 PDT 2000
Mark Williams

* New white pieces with black borders.

* Major overhaul to Options menu. New dialogs for setting General Options,
  Board Options, ICS Options, Sounds, Fonts, Colors.

* Clipboard support for PGN game scores and FEN positions.

* Optional ICS Premove with user-specified first moves for White and Black.

* New sound events: ICS Win, ICS Loss, ICS Draw, ICS Unfinished, ICS Alarm.

* New auto-flip option when playing against a chess program.

* Added PGN Training mode.

* Certain menu options now disabled while program is thinking.

* ">>" button now always goes to the end of the game.

* In ICS mode, the board is automatically activated at the start of a
new game.

4.0.7 -- Sun Mar  5 17:17:49 PST 2000  Tim Mann

* Fixed a nasty bug in parsing ICS game histories that was introduced
in 4.0.6.

4.0.6 -- Fri Mar  3 16:20:11 PST 2000  Tim Mann

* Fixed bugs in Zippy's code for responding to messages sent with the
ICS "message" command.

* Fixed bugs where xboard could still create dialogs partially off the
top of the screen.  Fixed unwanted interactions between initial sizes
and positions of various unrelated xboard dialogs.  Deleted
borderXoffset and borderYoffset resources.

* Fixed restoring the xterm name on exit to work in more cases.

* Small fix to the WinBoard self-extracting installer: when it starts
up, it now always deletes any old wb-setup directory left over from a
previous installation.  Formerly this worked only on Windows 95/98, so
on NT the self-extractor would sometimes stop and ask the user whether
it was OK to overwrite the old wb-setup files.

* Modified WinBoard to be compilable with the free Cygwin tools
available from http://sourceware.cygnus.com/cygwin/.  Based on work by
Mark Schoenberg.  (His mods were enough to get WinBoard through the
compiler, but a few things were broken along the way, so I reworked them.)

* Merged changes from Don Fong to make WinBoard compilable with
Borland C++ 4.5.  I do not have Borland C++ and am unable to test with
it, but I did make sure the changes don't stop it working with MSVC++
5.0 and Cygwin.

* Forbade entering TwoMachines mode from MachineWhite or MachineBlack
mode when machine is on move.  This used to confuse the engine and
cause problems, because when we try to get the engine to stop, it
might make a move first, and it might not do that immediately.

* Variant classification now deals with new ICC wild 25, classifying
it as "3check".  Also, we are now conservative about new wild numbers
we don't know about, classifying them as "unknown" instead of
"normal".

* Replaced bad GNU Chess 5.00 book in WinBoard distribution with a
correct one.  1.e4 now no longer takes GNU Chess 5.00 out of book!
Thanks to Pete Galati.

* Made move parser accept and ignore nonstandard ep suffix on PGN moves,
e.g., "exf6ep" or "exf6e.p."

* Fixed bugs in parsing PGN files starting with no move number, or
with a move number other than "1." (including "1...").  Thanks to
Michael Soulier and Stefan Zipproth for example PGN files
demonstrating the bugs.

* Changed InitComboStringsFromString to not modify the input string;
this caused an exception when WinBoard was compiled with MSVC++ 6.
Thanks to Bert Tuyt for the report.

* In WinBoard, dragging a piece off the edge of the board without
releasing the mouse button no longer instantly aborts the move.  You
still must release the mouse button inside a square to complete a
move, but you can now drag off the edge and come back inside.

* WinBoard bugfix: If you went into EditGame or EditPosition mode
while observing or playing an ICS game, and a new move came in
(snapping you back to ICSClient mode) while you were dragging a piece
around, the drag state would not be reset, causing the piece you were
dragging to remain on the board wherever you dropped it.  Thanks to
David Brinegar for the bug report.

* WinBoard bugfix: If you moved or resized the board while your
opponent was moving, and you had AnimateMoving on, his move would not
be displayed until after your next move.  Thanks to DAV for reporting
the bug repeatedly until I finally understood it.

* Added a Zippy "farewell" feature; see zippy.README.

* Fixed a bug (xboard only) in processing -zippyReplayTimeout on the
command line.  Thanks to Steve Beer for the report and patch.

* Send "computer" command to both sides in TwoMachines matches.

* Fixed a Y2K bug in Evan's cmail code!  Thanks to Brian Mays for the
report and patch.

* Bugfix: Initialize variant field of GameInfo struct in gameinfo.c.
This could cause crashes in LoadGame.  Thanks to Andrzej Nagorko.

* Fixed several pattern matching problems: Finger notes and formula
vars no longer get replied to by zippyTalk or colorized.  Channel
tells by players with many titles are now colorized fully, and
zippyTalk handles channel tells by such players correctly.  The shout
"--> foo(99): bar" no longer gets colorized as a channel tell.  Code
is cleaned up a bit, and autocomment capture now uses the same
criteria as colorization.

* xboard fix: Enter key now closes error popups as in WinBoard.
Especially nice for the "Exiting: Connection closed by ICS" popup.

4.0.5 -- Tue Dec  7 10:30:40 PST 1999  Tim Mann

* Added missing documentation of SIGTERM usage into engine-intf.html.

* Bugfix: New -zippyReplayTimeout option was misspelled in WinBoard as
-zippyReplyTimeout.  Thanks to Francesco Di Tolla.

* xboard -ics now restores the xterm's original title upon exit, at
least if $WINDOWID is set.

* Bugfix: -matchGames mode wasn't terminating properly.  Final score
popup would come up twice and engines would not be killed off.  Thanks
to Frank Quisinsky for the bug report.  Bug was introduced in 4.0.4.

* Bugfix: "tell 50 foo shouts: bar" no longer gets colored as a shout;
similarly for "...s-shouts:" and "...c-shouts:".  Thanks to David Lee
for the bug report.

4.0.4 -- Fri Dec  3 17:51:27 PST 1999  Tim Mann

* Bug fix: formerly if you invoked SaveGame from EditPosition mode
with black to play, the position was not saved properly.  As a quick
fix, SaveGame now takes you out of EditPosition mode before saving.

* Changed -matchGames to keep track of the score (won-lost-drawn) and
display it in the banner.  The final score is displayed in a modal
popup before the program exits.

* Changed "Connection closed by ICS" to display in a model popup
before the program exits.

* Added -popupExitMessage option, default on.  Setting this to false
suppresses the modal popups that you sometimes get just before
xboard/winboard exits -- both the two new ones listed above and the
existing Fatal Error popup.  This is useful when running Zippy
unattended from a shell script (or .bat file) that loops and starts a
new copy after a time delay when there is an error.

* In xboard, added missing support for WM_DELETE_WINDOW to all
windows.  This makes xboard a better citizen, and is much needed with
the newer X window managers that put an [X] button on every window and
bind it to "kill application" if the applicationd does not support
"delete window".  We can't allow xboard to be thoughtlessly killed,
since that leaves the chess engine running in the background.

* We now avoid positioning tops of xboard dialog boxes offscreen.

* zippy.lines can now use the caret ('^') character as an inter-saying
separator. You no longer need to dig up a text editor that can put NUL
('\000') characters in text files.

* Bugfix: In traditional chess clock mode, White now gets time added
to its clock as soon as it makes time control.  Previously both White
and Black got their time added only when Black made time control,
which would cause some engines to make their 41st move as White too
quickly, thinking they were low on time.

* The zippyAcceptOnly feature no longer sends a decline command or
a tell.  Thus you can use it to put Zippy into a manual accept mode.

* Bugfix: "tell 50 foo tells you: bar" no longer gets colored as a
personal tell; similarly for "...whispers:" and "...kibitzes:".

* WinBoard no longer blanks the message line when you start a new
move, unless there was an error message there from the previous move.

* WinBoard now never puts the white piece drop menu on the middle
mouse button.  Both colors are always on the right button.  Windows
users often don't think to look for a middle button menu, or don't
really have a working middle button despite what Windows says.

* Guest login handles on ICC are now parsed again; an ICC wording
change had broken this feature.

* Autodetect when the engine does not support the "draw" command and
don't relay the command to it in that case.  Needed because sending an
unsupported command to GNU Chess makes it move immediately, so people
could make Zippy move without thinking by continually offering a draw.
Thanks to Frank Walker for the problem report.

* Small changes based on code from Robert Jurjevic: The WinBoard
analysis window can be minimized (though not to the taskbar).  The
WinBoard ICS Interaction window will autoscroll if you drag the mouse
above or below the window while selecting, and password entry mode
leaves the entry line as the background color instead of using 75%
gray.  Seeks are now colorized with a new color of their own.

* Added -zippyMaxGames feature.

* -zippyNoplayCrafty command line option was missing in xboard; fixed.
Thanks to John Perry.

* Fixed bug in detecting when Zippy loses his bughouse partner.
Thanks to Ben Dean-Kawamura.

* allobs fix in 4.0.3 didn't work; corrected it.

* WinBoard will now update the board immediately if a move is made
while the window is being moved or resized.

4.0.3 -- Sun Aug 15 18:44:39 PDT 1999  Tim Mann

* Bugfix: moved winboard wizard functions that send a command directly
to the chess engine from Ctrl+Alt+1 and Ctrl+Alt+2 to Alt+1 and Alt+2.
Ctrl+Alt is equivalent to the European AltGr key, so the old assignments
conflicted with typing an @-sign on some keyboards.

* Bugfix: prevent "If this message stays up, your chess program does
not support analysis" from appearing if AnalysisMode is selected when
already in Analysis or AnalyzeFile mode.  Also, deleting analysis window
in WinBoard now switches you to EditGame mode, to avoid the anomaly of
being in an analysis mode with no analysis window present.

* Change all Zippy environment variables to work as command line
options.  For now they still work as environment variables too, but
the environment variables are deprecated.

* Use unsigned long to hold node counts from engines.

* Print error instead of crashing on attempts to use xpm or xim pieces
in monochrome mode.  Thanks to Jim Torrance for the bug report.

* Tightened pattern recognition for ICS messages sent to Zippy; should
no longer match ICC allobs output.  Fixed recognition of when Zippy is
sent a message; small change to FICS output had broken it.

* Zippy now exits if the engine dies unexpectedly.

* Added Zippy "spoofedby" feature; see zippy.README.

* Narrowed the margins on some older WinBoard dialogs to make their
style uniform with the newer ones.

* Bugfix: Changing Ponder Next Move from the Options menu did not take
effect until the next game.  This bug was in WinBoard only.  Thanks to
Stefan Zipproth for the bug report.

* Got rid of "Internal error: bad move type" message when the engine
makes a move that we can parse but think is illegal.  Now the move is
just passed on (which also may be the wrong thing to do).

4.0.2 -- Thu Feb 25 19:55:32 PST 1999  Tim Mann

* Added one more built-in sound choice to WinBoard: move.wav from Pete
Galati.

* Added new larger piece sizes: big, huge, giant, colossal, titanic.

* Modified the xboard font searcher to be able to use scalable fonts.
The new -fontSizeTolerance flag controls how closely a nonscalable
font must match to be used in preference to a scalable font.

* Zippy environment variables ZIPPYABORT and ZIPPYADJOURN now control
whether Zippy will accept abort and adjourn requests.

* We now determine the variant type being played on ICS, send it as a
command "variant VARTYPE" to the chess engine (if in Zippy mode), and
put it in the PGN tags.  See engine-intf.txt for variant names.  See
ZIPPYVARIANTS in zippy.README to control what variants Zippy will
accept.  Note that this now applies to bughouse, too.

* Zippy now won't do -zippyTalk in a channel unless his handle is
mentioned there.

* Zippy now ignores bughouse holdings if not actually playing, instead
of stupidly trying to abort the game.  Let me know if other strange
things happen when Zippy is observing a game.

* Set ICS Interaction title bar to "user@server".  User name is
determined by parsing message during the login sequence.  Zippy now
uses this method to get its name too, so ZIPPYNAME is eliminated.
Problem: with xboard, the title bar gets set to "xterm" upon exit,
since we didn't know what it was to start with.

* Fixed xboard-only bug in -colorChannel1 command line option.  Thanks
to Fredrik Sandstrom for the bug report and fix.

* Check for overflow of MAX_MOVES.  Still not sure this is checked for
everywhere it needs to be.

* Added .epd to suffixes recognized by WinBoard as position files.
This is a bit of a kludge, as the .fen reading code was not written
with .epd files in mind, but reading them with it is said to work.

* Added ZIPPYGAMESTART feature, suggested by Jason Hoblit.  See
zippy.README.

* Restored the feature of soaking up the moves from a user-typed "moves",
"oldmoves", or "smoves" ICS command when xboard/WinBoard is idle, but
changed it so that the move list is also echoed to the screen.  Some folks
still liked the old feature since it is faster than examine mode, and
printing the moves to the screen should eliminate the confusion it caused
for other people.

* Bugfix: in WinBoard, starting a click-click move and then clicking on
a black line would cause the source square to be forgotten without taking
the highlight down.  Now the errant click is ignored.

* Corrected shortcut key labels for LoadNext/PrevPosition in WinBoard's
File menu.  Thanks to Andreas Stabel for the bug report.

* Bugfix: if you had a completely full ICS context menu in WinBoard
(90 items), the last one would do nothing if selected.

* The "computer" engine command added in 4.0.1 was not working; I had
left out part of the code patch.  Oops.

4.0.1 -- Fri Feb 12 21:24:15 PST 1999  Tim Mann

This is a minor bugfix release.  The first item listed below is the
only interesting new feature.

* You can now type in moves from the keyboard in WinBoard.  Either
select TypeInMove from Step menu, or (if you are not in ICS mode),
just start typing.  In ICS mode you can type moves into the ICS
interaction window anyway, so I've retained the feature that typing
switches you there.  Not implemented in xboard.

* Removed the "noise 1000" command that used to be sent to the chess
engine when entering analysis modes.

* Deleted the feature where we soak up the output of a user-typed ICS
"moves" or "oldmoves" command.  This ancient feature is not really
useful anymore, now that "examine" exists, and it caused a lot of
complaints.

* Increased maximum size of ICS text menu to 90 entries and added
overflow checking.

* The command sent to ICS by Zippy at the end of each game can now be
customized with the ZIPPYGAMEEND environment variable.

* We treat xboard.info as a pseudo-source since most people don't have
the tools to rebuild it.  But "make install" erroneously had a
dependency on it, even though "make all" did not.  Fixed.

* Miscellaneous minor updates and clarifications to engine-intf.txt.
In particular, documented the st and sd commands (support for command
line options -searchTime and -searchDepth), warts and all.

* Added a small code patch from Bob Hyatt to detect when Zippy's ICS
opponent is a computer and send the command "computer" to the engine.
Added this command to engine-intf.txt.  Thanks, Bob.

* Bugfix: configure was looking for usleep(), but config.h.in didn't
have an entry for it, so HAVE_USLEEP was never defined.  Also, in the
non-HAVE_USLEEP case, there was a possible race condition between the
signal handler and the pause() call.  Thanks to Ben Dean-Kawamura for
the bug reports.

* Bugfix: a "1..." preceding Black's first move (usually present if
there is a comment on White's first move) would cause the parser
to think a new game started there and report "End of game" on the
current game.  Thanks to Dell Garner for the bug report.

* Changed the abbreviation for -searchDepth from -sd to -depth to fix
a clash with -secondDirectory.

* Changed -searchDepth to be orthogonal to the various timing options.
Previously it would search for an unlimited time to the given depth;
now the engine is allowed to choose its search time in the normal way,
but is told to cut off the search early if it reaches the given depth.

* Bugfix: SaveSettings in WinBoard was saving both the long form
option highlightSquareColor and its abbreviation (hsc).

* Fixed a redisplay bug in DisplayBothClocks that could cause White's
clock to be highlighted in EditPosition mode when Black's should have been.

* Fixed Zippy's feature of passing on draw offers from the ICS opponent.
The colorization code was eating the offer before Zippy saw it, so I disabled
colorization of offers while in -zp or -zt mode.  (Other types of
colorization are already disabled in Zippy mode for similar reasons.)

* Added some more commands to the default ICS context menu in WinBoard,
and put "(name)" on the ones that insert a playername (or game number).

* Added missing documentation to WinBoard help file: PonderNextMove, the
-ponder/-xponder argument, and the up/down arrow history feature in the
ICS Interaction window.

* Fixed	ZIPPYNOPLAYCRAFTY feature to fire only if the opponent is Crafty,
not if some other Crafty is observing the game and kibitzes.

* Fixed bugs in generating "partner" commands when Zippy is playing
bughouse.

4.0.0 -- Sat Jun 20 16:59:47 PDT 1998  Tim Mann

* Fixed WinBoard resizing so that the edges you do not drag remain in
place, even when the final size is different from what you dragged to.
(This doesn't work on NT 3.51 or earlier, if anyone cares.)

* Fixed problems with resizing WinBoard on Windows NT: you no longer get
whitespace around the board, a clipped board, or a lot of flashing during
the drag.

* Added customization for highlight-square color.

* Bugfix: backend.c wrote to stderr in a few obscure places, which doesn't
work in WinBoard.

* Added Index Number field back to LoadGame/LoadPosition dialog boxes in
WinBoard.  This required some extra code to work with both the
Explorer-style dialog boxes and the old-style NT 3.51 dialog boxes.  Ugh.

* WinBoard startup dialog now understands -zp mode.  The first chess
engine selector is enabled and the value is used.

* Bugfix: ResetGame would send "exit" to engine twice if it was in an
analysis mode.

* Bugfix: The response "Illegal move: bk" to the "bk" command, indicating
that it is not implemented, would confuse xboard.

* Bugfix: Ignore empty hints ("Hint:\n") instead of printing a message
saying that some bogus string (often "Hint:") is illegal.

* Bugfix: LoadNextGame/LoadPreviousGame/ReloadSameGame were broken.

3.6.12 -- Sat Jun 13 14:57:10 PDT 1998  Tim Mann

Beta test release of xboard and WinBoard.

* Spruced up xboard man page a bit.

* Added Highlight Last Move to xboard too.

* The revamped xboard mouse click code had several more bugs than the
previous version, so I revamped it again.  All fixed now, I hope.

* xboard bugfix: crash in CreatePieceMenu.

* Oops.  winboard-3_6_11beta.exe installed 3.6.10beta, not the new version.

3.6.11 -- Fri Jun 12 20:00:48 PDT 1998  Tim Mann

Beta test release of xboard and WinBoard.

* Major reorganization to engine-intf.txt.  Some new features added,
many existing features clarified and hints for engine programmers added.
Support for new features added to program.

* Changed defaults for -scp (etc.) back to being independent of -fcp, as
in 3.6.2. That is, the default is no longer to copy the value from -fcp if
-scp is not specified.  This will sometimes make command lines longer but
will remove some confusing situations.

* Split -reuseChessPrograms into two options: -reuseFirst and
-reuseSecond.  Fixed obscure bugs when reuse is off.

* Detect ICC and change some command usage slightly there: only ICC has
set-quietly; only FICS has iset and bsetup clear.  With this feature, we
can now safely use bsetup clear when appropriate instead of deleting each
piece one by one.

* Added indent to lines that are wrapped by WinBoard ICS Interaction
window.  This seems to tickle a Microsoft bug in the RichEdit control:
occasionally the start of the next line after the wrapped line is indented
too.  I think the wrapped indent feature is useful enough that it's worth
having in spite of the bug.

* WinBoard bugfix: bounding box for the board was computed incorrectly by
mouse code.  It would think you moved off the bottom of the board before
you really did, so it was hard to drag pieces along the bottom rank on
smaller board sizes.

* Fixed obscure parser.l bug: ambiguity between capture using : instead of
x and email header line.  Also removed or simplified a lot of complex
patterns for English (as opposed to PGN) end-of-game indications while I
was in there.

* Added PonderNextMove option.

* xboard EditPosition piece menus now let you set the side to play by
selecting the "White" or "Black" label at the top of the menu, like
WinBoard.  (Both xboard and WinBoard still let you set the side to play by
clicking on the clock.)

* Merged documentation of Crafty and GNU Chess thinking output in
engine-intf.txt.  Corrected code in backend.c to match documentation; it
used to require the PV to start in column 27 (!).

* Fixed bug that caused crashes in "-reuseChessProgram false" mode.

* Draw by agreement in Two Machines mode now works as it is supposed to.
Other minor bugs in handling game end messages from machines are also
fixed, and engine-intf.txt is revised in this area.

* Revamped xboard code for handling mouse clicks on the board.  In
particular, it had a bug if a click-click promotion move was made.

* Fixed and reinstated optimization for << in analysis modes: send
initString and re-send the board if needed.  Sending repeated undos
is bad because Crafty prints some analysis after every one.

* Don't go into a spin loop while pausing between xboard animation frames.
This caused problems, especially when compiling with -O2 on HP-UX.

* WinBoard Options/Colors/RevertToDefaults now also turns off Monochrome
if it was on, and similarly for Options/ICSInteractionColors/RevertToDefaults.
This seemed to confuse people before.

* Bugfix: ICS Interaction context menu items with neither of the two
optional flags set did not work.

* Bugfix: PGN move numbers are optional, but we were insisting on "1"
right after the tags.

* Bugfix: only the first game of an -mg match was loading -lpf or -lgf.

* Other minor fixes and code cleanup.

3.6.10 -- Mon Jun  1 01:32:31 PDT 1998  Tim Mann

* Added ZIPPYNOPLAYCRAFTY feature; see zippy.README.

* Added timestamps for chess engine interaction to -debug output.

* Now allow 10 seconds (was 5) between games in match mode for engines to
respond to "force" command that ended previous game.

* When a game is picked from the game list and the names of White and
Black are known, display them in the window banner instead of the filename
and game number.

* Changed default for -scp and -sd to be the values of -fcp and -fd.

* Added boxes for both engines to WinBoard startup dialog.  Changed to
dropdown boxes whose content can be set from winboard.ini, similar to
the box for ICS name.

* Accept "offer draw" (or "*offer*draw*") from engine to offer a draw.

* Accept "move mmmm" from engine as well as silly "1. ... mmmm" syntax.

* Added support for bughouse engines (Zippy mode only).

* Move bombproofing for engines sending illegal or out of turn moves.

* Always send "xboard\n" to engine as first command.  Eliminates need
to run crafty as "crafty xboard".

* Rewrote xboard code for input from engines to fix longstanding bugs.
Previously an engine that sent one line in two separate writes with
some time lapse in between (or perhaps that sent several lines in one
write) could make xboard hang.  WinBoard did not have this bug.

* Fixed minor bugs in dealing with illegal moves.

* Added "iset startpos 1" for FICS.

* Removed special support to put "GNU Chess" or "Crafty" in the window
banner instead of the engine's base filename.  This gives a more level
playing field for other engines.  Also fixed bugs in the code that finds the
engine's base filename.

* Bugfix: Abort or Resign at the very start of a game in chess engine mode
would fail to send "force" to the engine.

* Fixed some minor bugs in new "result" messages, and changed format to
include a trailing PGN comment giving the reason the game ended.

* Changed syntax of /font options in WinBoard; old syntax was assuming
that a font name can't contain a digit, which is wrong.  Old font names in
WinBoard.ini files are still accepted.

* Serious further work on getting WinBoard to read/write files in the
"right" directories and documenting exactly what it does.

* Added LoadPreviousPosition, LoadNextPosition, ReloadSamePosition.

* Misc. tiny fixes and cleanup.

3.6.9 -- Sun May 24 20:53:08 PDT 1998  Tim Mann

xboard and WinBoard beta release.

* Tightened up illegal move handling.  Illegal or meaningless moves from a
file or chess engine should no longer get translated into a1a1 and blindly
applied.  Explicit moves to the same square (like a1a1) no longer make the
piece on that square capture itself and vanish.

* Added AlwaysOnTop feature to winboard.

* Fixed bug in winboard "@" command line indirection operator.

* Removed buggy "optimization" code for ToStart in analysis modes.

* Fixed typo bug in zippy.c that would often cause winboard to crash
right after starting a game in -zp mode.

3.6.8 -- Sat May 23 22:23:19 PDT 1998  Tim Mann

xboard and WinBoard beta release.

* Added -firstDirectory and -secondDirectory so that chess engines can
be started in a different directory from xboard/WinBoard itself.

* Added -matchGames to allow more than one game in -matchMode.  The games
are played with colors alternating between the two chess engines.  Had to
add a time delay at the end of each game to catch up with game ending
messages from both chess engines -- yuck.

* Changed TwoMachines mode to have firstChessProgram play White by
default.  Added -firstPlaysBlack to restore old behavior.

* Major rework of code in backend.c for dealing with first and second
chess engines.  Generalized the code and created a struct type with one
instance for each engine.  Several small bugs fixed along the way.

* Fixed bugs in Abort in local chess engine mode.

* Tightened pattern matching to recognize moves from machine.  Should cure
bogus "Illegal move" errors while Crafty is pondering with Show Thinking
on, among other things.

* WinBoard keeps focus in board window after popping up a comment due to
Forward/Backward/ToStart/ToEnd commands.

* Finally got rid of warnings on compiling moves.c under Windows.

* Fixed so WinBoard will compile on machines where WM_MOUSELEAVE is not
defined.

* Removed various bits of unused code.

* Parse (and ignore) NAGs in PGN files.

* Updated engine-intf.txt.

* Send "result R" to the chess program at the end of each game, where
R is the PGN result 1-0, 0-1, 1/2-1/2, or *.

* Bugfix: suppress animation when loading a game with timeDelay=0.

* Bug fix: pondering output from Crafty that contained "..." could be
mistaken for a move, causing bogus error messages and general chaos.

* xboard "make clean" bug fix: moved things created by configure to be
removed only by "make distclean".

* Fixed a remaining case where move was being animated before being
relayed to opponent.

* Backend was reversing time/otim commands to the chess program (new bug),
and was often not sending them on the first move of a game or the first
move after a mode change (old bug).  Fixing the latter required a kludge
to work with both GNU Chess and Crafty, because Crafty swaps white and
black clock times when it swaps sides, while GNU Chess does not.  The
kludge is that we always make sure the chess engine thinks its opponent is
on move before we set the clock.  This will sometimes result in sequences
like "white\ntime xxx\notim yyy\nblack\ngo", or the same with white and
black interchanged.

* Removed last trace of old -whiteString and -blackString arguments.

* Fixed so that you can type "bd" into the Direct Command dialog when
debugging gnuchess, without having xboard parse the clock display
(starting with "White") as "White wins" and end the game.

* Changed moves.c to make a distinction between IllegalMove (where we
could tell what move was intended, but it violates the chess rules) and
MeaninglessMove (where we could not tell).  This is a step towards getting
rid of cases where we translate meaningless moves into "a1a1", but some
work is probably needed to track them all down.

* Fixed bug in WinBoard monoMode dragging.

* Changed WinBoard to new style file dialogs.  In the process, disabled
the feature that let you enter the index number of a game or position within
the file in the dialog.  This is no loss in LoadGame, as you can pick your
game from the game list dialog that follows, but it does remove some
functionality from LoadPosition.

3.6.7 -- Mon May 18 21:25:00 PDT 1998  Tim Mann

xboard and WinBoard beta test release.  I've been unable to reproduce some
reported drawing bugs, so they may still not be fixed.

* Changed PopUpErrors option to PopupMoveErrors, which is more useful, and
changed default to off.  Errors other than move errors should always be in
popups; they are often too big for the message area and too important to
put where they can be easily missed.  But it seems good to get rid of the
popups for move errors by default.

* xboard analysis window no longer forces itself to top whenever there is
new output.  Also, now uses built-in Xaw word wrapping instead of trying
to do its own; works better.

* Bugfix: Reset did not take Crafty out of analyze mode.

* A chess engine no longer has to claim to be Crafty to be able to use
AnalysisMode and AnalyzeFile; it just has to implement the analyze
command as Crafty does.  Put in heuristics to generate more informative
error messages if the engine does not support analyze, and checked that
they work at least with GNU Chess.

* Added click-click moving, HighlightLastMove, and HighlightDragging to
WinBoard.  The highlight features are unlikely to go into xboard unless
the xboard drawing code is cleaned up to do *all* drawing on the board
from DrawPosition, as WinBoard does.  This is low priority for me.

* Eliminated bogus "Error gathering move list: no header" popup.  You
could get this by observing two fast games at once without turning off
GetMoveList.

* Disable WinBoard Sounds menu entirely in -ncp mode, since not even
MoveSound is used in that mode.

* WinBoard bugfix: Several problems were caused if the user changed
WinBoard's current directory in a Load, Save, or Browse dialog.  In
particular, WinBoard.ini would get saved in the wrong directory, and
sound .wav file names would not get saved with a full pathname.  I think
all such problems are now fixed.

* WinBoard bugfix: iconizing the board after an aborted mouse resize would
(partially) resize it to Tiny.

* WinBoard bugfix: board was not being drawn in color on 256-color
displays.  This bug was introduced in 3.6.6.

3.6.6 -- Tue May 12 17:43:43 PDT 1998  Tim Mann

xboard and WinBoard beta release.  Note: not all reported bugs are fixed.

* Move animation in WinBoard, programmed by Henrik Gram.  Great stuff!

* Animate backward moves too.

* xboard bugfix: -font (and friends) can now specify a font alias (such
as "fixed"), not just a full X Consortium name pattern.  Previously this
would give a resource conversion error message.

* Some coding style cleanup in xboard.c.

* Earlier error check for moving wrong color piece in EditGame mode.

* Completed fix to pattern matching; see 3.6.5.

* Fixed some software rot bugs in Zippy.

* Split AnimateDragging as separate option from AnimateMoves.

* Added FlashMoves to options menu and -flash/-xflash to command line
options (xboard only).

* Some preliminary work on visible bughouse holding support.  Most of the
code is not present in this release because I have not gotten it working
properly yet; my first approach went down a blind alley and I had to
remove most of the partially working code in preparation for a rewrite.

3.6.5 -- Fri May  8 14:22:09 PDT 1998  Tim Mann

Not generally released.

* Pack bughouse holdings display in banner more tightly when board is one
of the smaller sizes (when smallLayout or tinyLayout is true, that is).
An interim measure, but should help.

* Completed fix to make move list parsing recognize the end condition and
final comment.

* Fixed pattern matching for chatter (tells, etc.) to be more reliable.
This should reduce the incidence of colors starting in the wrong place and
of incorrectly matching things that look like other patterns inside
chatter, such as "shout <12>".  (These errors were already rare.)

* WinBoard now lets you customize the list of ICS's in the startup dialog.
For now, at least, requires editing WinBoard.ini with a text editor.

* Bug fix: WinBoard window sizing and position setting save/restore did
not work right when the taskbar was at the top (or left side) of the
screen and not in autohide mode.

* Merged xboard click/click mode and drag mode, and deleted
ClickClickMoving option on menu.  Now if you click on a piece, it
highlights and a further click on another square will move it.  (A second
click on the same square takes down the highlight.)  Or if you press down
on a piece and start to drag, you can drag it to a new square.

* When making click/click style moves, if your second click is on a piece
of the same color, instead of saying "Illegal move", we now cancel the first
starting square, replace it with the second, and wait for another click to
finish the move.

* Separate -secondInitString.  Default: same as -initString.  Suggested by
Remi Coulom.

* Patch from Frank McIngvale to make animation work with XIMs.  Yay!

* Changed move animation to happen after move is passed on to ICS or the
chess engine, where applicable.  Fixed problems with updating moveList
that this uncovered.

* Changed game list to show PGN result token for each game.

* The usual minor bug fixes.

3.6.4 -- Thu Apr 30 23:14:43 PDT 1998  Tim Mann

xboard and WinBoard beta test release.

* xboard documentation updated, both man page and info file.  An attempt
to generate both from the same source with LinuxDocSGML was abandoned, at
least for now.  WinBoard doc updated too.

* Merged updates to animation code from Hugh.  Fixed a couple of remaining
bugs, mostly to do with handling Pause mode correctly.

* Added SaveSettingsOnExit to WinBoard.

* WinBoard now saves the last screen position of the Comment, Edit Tags,
Game List, and Analysis windows (in addition to the board and ICS
Interaction windows) in WinBoard.ini.

* WinBoard now provides a way to customize the right-button context menu
in the output area of the ICS Interaction window.  For now, requires
editing WinBoard.ini with a text editor.

* Various minor fixes to ICS message recognition, most affecting only Zippy.

* Colorize the notification when someone sends you a message while you are
logged in, not the output of the "messages" command.

* Fixed colorization to turn off at the right place more reliably.

* Added a new color and WinBoard sound for "requests": abort, adjourn,
draw, pause, and takeback.  The same color and sound are used for all of
these.

* Added GUI to change sounds in WinBoard.

* Suppressed WinBoard error popup when a sound can't be played.  They were
popping up when two separate WinBoards tried to play a sound at the same
time (such as during a bughouse match).

* Fixed WinBoard crash when a sound file didn't exist.

* WinBoard ports of timestamp and timeseal now produce decent error
messages if they fail to connect, and WinBoard captures the messages and
puts them into a popup.  Previously WinBoard would exit with no message on
such errors.

* WinBoard resizing with mouse improved; now accurately picks the largest
size that fits in the new area.

* Added option to turn off error message popups.

* Added sizes slim, dinky, and teeny.

* Fixed some minor problems with error message wording.

3.6.3 -- Mon Feb 23 19:08:57 PST 1998  Tim Mann

xboard beta test release only.  Man page is updated for the changes, but info
file is not.

* Bug fix: LoadGame could not load a PGN game whose first move was
castling (which is possible from setup positions).

* Bug fix: we were ignoring illegal move messages from chess engines in
modes where the engine is refereeing but not participating (EditGame,
LoadGame, AnalyzeFile).  The problem was in a workaround for a Crafty bug,
where Crafty generates a bogus illegal move message if a "." (used by
the PeriodicUpdates feature) is sent in analysis mode when the current
analysis reveals a forced mate.  Installed a different workaround (that
works in most but not all cases) and reported the Crafty bug.  Bob Hyatt
replied with a fix, so the Crafty bug should be gone in Crafty 14.12 or so.

* WinBoard only: enabled resizing board with the mouse.  It snaps to the
nearest (but not too much larger) predefined size.

* The xboard default font is now sized according to piece size, just as
clockFont and coordFont have always been.

* Added more sizes: bulky, moderate, average, middling, mediocre, petite.

* xboard only: Added Animate Moves and Click-Click Moving to Options menu.

* xboard only: Added code to animate piece movement, from Hugh Fisher.

* New feature: autoflag is implemented in MachineWhite, MachineBlack, and
TwoMachines modes.  If it is on and either a chess program or the user
oversteps his time, xboard will automatically call the flag and end the
game.  This feature was requested by someone who runs matches between
programs and wants to penalize GNU Chess for its habit of running slightly
over at the end of a time control.  I personally think it's pointless.

* Fixed a bug in Zippy's pattern matching; he can now reply to ICC
messages again.

* Generate prettier notation for illegal moves.  If a move is illegal only
because it leaves the player in check, generate notation as if that were
not illegal.  For instance, if two knights are a knight's move away from
f3, one on g1 and one on e5 that is pinned, the notation would be Nf3 to
move the g1 knight, Nef3 to move the e5 knight.  (Suggested by Philippe
Schnoebelen.)  In addition, if a move is illegal because the type of piece
moved cannot go that way, would be jumping over another piece, etc., we
give fully disambiguated coordinate notation; for example, Ng1g3, Ke1xe8,
d2xd8=Q, etc.  An alternative would be to still write Ng3 if there is only
one knight on the board, or Ngg3 if the other knight is not on the g file,
but life is too short to code up all this stuff, and perhaps the way I did
it is better as it emphasizes that this move was really made despite being
illegal.  I wonder if the new PGN standard revision will speak to notation
of illegal moves?

* Fixed gross bug from 3.6.2: if a chess program said "checkmate" and
White was left on move, the PGN outcome was "1-0 {Black mates}" instead
of "0-1 {Black mates}"!  The bug occurred only for that specific string.

3.6.2 -- Wed Jul 23 16:47:29 PDT 1997  Tim Mann

* There was a bug in backing up from the end of a game against a chess
engine, introduced when -reuse mode was added.  Fixed.

* Recognize "{" as terminating an ICS move list.  Previously we needed to
see a prompt (containing %), but occasionally ICC can send more stuff
right after a move list with no prompt in between.

* In WinBoard, -mm now implies -cp, so you don't get the startup dialog.

* WinBoard startup dialog no longer sets -scp.  People used to get
confused because they would give the -fcp and -scp arguments, but omit
-cp.  This would bring up the startup dialog, which would set both -fcp
and -scp to the value in the engine name box.  Now you can change -scp
only with the command-line argument.  That will confuse some people too,
but hopefully fewer.  I think overall it's better than putting spaces for
both -fcp and -scp in the dialog, which would puzzle newbies.

* Bug fix: Analyze File mode now works in WinBoard.

* Bug fix: WinBoard window no longer cuts off part of the bottom row if
the menu bar wraps to a second line.

* Accept game end messages of the form "PGN-result {comment}" from the
chess engine, where PGN-result is 0-1, 1-0, or 1/2-1/2.  Accept "resign"
or "computer resigns" from the chess engine as a synonym for "0-1 {White
resigns}" or "1-0 {Black resigns}". Accept any message from the chess
engine containing "game is a draw" as a synonym for "1/2-1/2 {Draw}".
Accept "White resigns" or "Black resigns".

* Enable "Action / Draw" menu item in chess engine mode.  It sends the
command "draw" to the engine.  Accept any message from the chess engine
containing "offers a draw" as a draw offer.  WARNING: Draw offers from the
user and the engine (or from two engines) are not yet matched up by xboard
in chess engine mode.  Two engines could get into a loop offering each
other draws.

* Bug fix: Game end messages from the chess engine are always ignored in
Zippy mode.  Previously they could sometimes be processed, which was
sometimes making Zippy hang at the start of a new game that followed
quickly after an old one.

* Zippy can now respond to titled players in channels.  Zippy will avoid
talking to himself in a channel if he knows his own name.

* Bug fix: in colorization arguments, the bold setting was being ignored
if the background color was defaulted.  (xboard only.)

* Extended ParseFEN to accept Crafty 12.2's interpretation of FEN.
If fewer than 8 squares are given in a row, or fewer than 8 rows are
given, the uncovered squares are empty.  Also, there can be a / after the
8th row.

3.6.1 -- Sat May 17 01:02:33 PDT 1997  Tim Mann

* Bug fix: Hitting escape while entering a password on WinBoard no longer
sets the font color back to black (which made further typing visible).

* Bug fix: On Windows NT 4.0, WinBoard /ics /icshelper=timestamp would
often hang if you tried to exit with the Exit menu item, the [X] button,
etc.  The same fix may also have corrected the problem where running a
chess program with /xreuse would sometimes crash Windows 95 (but not NT)
when the chess program was killed and quickly restarted.

* Bug fix: Periodic Updates would not work if turned on after having been
off.  Also, the default was needlessly "off" in WinBoard.

* Zippy bug fix: Continuing an adjourned game was totally broken.  The
wrong moves, or no moves at all, were being fed to the chess program.

* WinBoard change: Giving -ics without -icshost now pops up the startup
dialog with "Use an Internet Chess Server" pre-selected, so that you get a
menu of chess servers instead of going directly to ICC.

* Bug fix: WinBoard's SaveSettings was saving -icshost, -icsport, and
-icshelper in winboard.ini.  This causes a problem if you use a different
icshost later that needs the default values for icsport (5000) and
icshelper ("", meaning none).

* Disabled complaints about unexpected "[Ii]llegal move" messages from
the chess program; we still get them at times.

* Greatly simplified the code for Move Now and SIGINT (ATTENTION).  Fixes
the bug where Move Now did not work with GNU Chess in WinBoard, and
several more obscure bugs as well.  Reintroduces a minor bug: GNU Chess might
not think on your time after a Move Now command.  Trying to fix this
causes too many other problems.  Documented change in engine-intf.txt.

* Cleaned up code for obtaining ratings from ICS.  It was kludgey and may
have had bugs on systems with no "Creating:" message.  It should fail
gracefully there, just not finding the ratings.

3.6.0 -- Thu May  8 19:55:58 PDT 1997  Tim Mann

* WinBoard now has right-button context menus in the ICS Interaction
window.  Some of the items do immediate commands on the player name you
have selected or pointed to.  (Suggested by Paolo Casaschi.)  Also, the
middle button or shift+right does a immediate Copy and Paste.

* Fixed a bug in Zippy's wild rejection.  The bug was causing Zippy to
reject all forms of wild.  Now it rejects only 1, 9, 16, 17, and 24, as
was intended.  These variants have different rules, while the other
variants defined so far only have different starting positions.
(Actually, wild 2, 3, and 4 never allow castling, but may sometimes by
chance have king and rook start on squares where castling appears legal.
This could cause a problem later.)

* Zippy now resumes adjourned games by feeding the chess program
the move list instead of the position.  Setting -getMoveList to False
restores the old behavior.  Feeding in the move list is better because
it enables the chess program to correctly handle en passant legality,
castling legality, draw by repetition, and draw by the 50 move rule.

* Added a WinBoard startup dialog for people who run WinBoard.exe without
using the Start menu or reading the help file.  Instead of being dumped
directly into GNU Chess mode, you now get a menu of choices.  You now have
to give the new WinBoard -cp option to go directly into chess engine mode.
I did not add this feature to xboard.

* Handling of "illegal move" from Crafty is now back on.  (It was turned
off in 3.4.6; see below.)  Crafty 12.0 doesn't seem to send bogus ones
anymore.  I did have to suppress sending time and otim in analyze mode to
make this work, but there is no harm in that.

* Zippy now sends "gameend" to ICS at the end of each game.  You can alias
this to "seek" or whatever you like.

* Added Crafty support for Move Now, using the "?" command.  We test
whether this command exists by trying it once at the start of the first
game, before it really makes sense.  If we don't get a message like
"Illegal move ... ?", we assume it's OK.  (We're careful about this
because sending a "?" to GNU Chess on Move Now keeps it from pondering the
next move as it should.)

* Added support for a tellusererror command from the chess engine.  See
engine-intf.txt.

* Attempted to make engine-intf.txt complete.

* Minor fixes/cleanup to GameEnds code, to be sure we always interrupt
when needed, and always undo an extra move generated by stopping the chess
program while it is thinking.

3.5.7 -- Sat May 03 22:37:44 PDT 1997  Tim Mann

Beta release of both xboard and WinBoard.

* Updated xboard documentation.  I really wish the man page was built from
the info file instead of being separate!  It's a pain to update them both.

* Updated documentation of the interface between XBoard/WinBoard and chess
programs, and renamed it to engine-intf.txt.

* Added support for tellics, telluser, and askuser commands from the chess
engine.  See engine-intf.txt.

* Various bug fixes.  On WinBoard, 256 color displays are finally handled
right; no more color flashing when you switch windows unless the colors
really need to be updated.  Also, I think the problem of the console font
failing to change or changing back by itself is finally fixed.

3.5.6 -- Tue Apr 29 03:08:00 PDT 1997

Beta release, WinBoard only.  ChangeLog was out of date in release,
updated here.

* Added ICC timestamp and FICS timeseal to WinBoard distribution.  These
are my own ports to Win32, based on and used by permission of the owners
of the proprietary source code (Daniel Sleator for timestamp, Henrik Gram
for timeseal).  The owners permit these programs to be distributed only in
binary form (to help prevent cheating), so to avoid running afoul of the
GPL, I have kept them as separate programs, not linked into the WinBoard
address space.  Updated Start menu icons to use them.

* Miscellaneous smaller changes.

3.5.5 -- Fri Apr 25 03:06:00 PDT 1997

Beta release, WinBoard only.  ChangeLog was out of date in release;
updated here.

* Added simple sound support to WinBoard.

* Updated WinBoard documentation.

* Internal implementation of the telnet protocol is now more complete.
You can now hop through a VMS host on the way to ICS.  For example, do
"xboard -ics -icshost vms.host.edu -icsport 23", then log in.  Do not use
the -telnet flag; that says to use an *external* telnet program.  To avoid
double echoes, you need to force character mode in VMS telnet after
connecting from VMS to ICS.  Do "^]^Mset mode char^M^M".

* Display opponent names in the title bar for MachineWhite, MachineBlack,
and TwoMachines modes.

* WinBoard now has an installer, built with InstallShield.  The installer
works with a binary-only distribution.  Sources are still freely
available, but now separately.

* Added SaveSettings to WinBoard, which saves current option settings to
winboard.ini.  Made sure all options can be saved and loaded, including
fonts and com port settings.

* If the game ends while you are dragging a piece, we now don't let you
finish the move.  Formerly the move was accepted and your opponent's clock
would start running again.

3.5.4 -- Fri Apr 18 01:15:24 PDT 1997  Tim Mann

Beta test release of WinBoard and xboard.  The documentation remains
out of date.

* Many fixes and improvements to new WinBoard user interface code.

* In Zippy mode, avoid sending another copy of the same move to the chess
program if ICS sends us another copy of the board image.  Hard to believe
it took me until now to diagnose and fix this problem!

3.5.3 -- Sat Apr 12 19:49:33 PDT 1997  Tim Mann

Beta test release of WinBoard and xboard.

* Fixed fatal bug in WinBoard input handling.

* Made code to stop chess program for reuse a bit smarter.  Removed kludge
of "white" in initString; it didn't work well, and is unneeded
with Crafty 11.21 and later.

3.5.2 -- Sat Apr 12 15:40:01 PDT 1997  Tim Mann

Beta test release of WinBoard.

* Ignore check and permit promotion to King during suicide games; no need
to turn off TestLegality.

* Renamed CheckLegality to TestLegality to avoid confusion with the chess
term "check".

* Added Rematch to Action menu.

* WinBoard now has a custom ICS interaction window with scrollback, a
separate line for input, and colorization.  Accelerators that conflict
with normal editing keys were changed (by requiring Alt+) so they can work
in both the console and the main window.

* WinBoard error popups are now non-modal and disappear when you make a
new move, as in xboard.

* Configure now defaults to --disable-ptys on all systems.  If anyone has
an ancient SysV system where pipes don't work with select, they can still
do "configure --enable-ptys" explicitly.  I would appreciate getting a bug
report if this happens to anyone, with complete output from configure and
"uname -a".

* "make install" now makes the installation directories too.

* Fixed a bug that would cause an "Illegal move" message for Black from
GNU Chess to be incorrectly considered bogus.

* Handle name changes during an ICS game (FICS bname and wname commands).

* You can force both chess programs to be killed at the end of each game
by turning off the reuseChessPrograms option.  There are still some
problems with reusing Crafty even in version 11.20.

* Now the second chess program stays around by default too, if it ever
gets started.

3.5.1 -- Sat Apr  5 16:47:48 PST 1997  Tim Mann

Beta test release.

* Don't kill off and restart the chess program for each game; keep the
same one running, using the "new" command to start a new game.  This
change works around the problem in Windows 95 that makes WinBoard crash it
at times, and is generally desirable to make new games start faster.  The
second chess program (for TwoMachines) is still killed at the end of the
game, and unfortunately this can still crash Windows 95.  Temporarily
added "white" to the initString to make this work with Crafty 11.20, which
has a minor bug in "new".  Older versions of Crafty have worse bugs in
"new"; they should not be used with this version of xboard.

* Support for FICS suicide chess: Parse illegal moves (that leave King in
check) in game history.  If CheckLegality is off, allow promotion to King
and illegal moves in game files.  We still generate e2e4 style notation
for illegal moves.

* Handle FICS "has timeseal; checking" message.

* Changed the coords from white back to black; this was a bug.

* Fixed problems compiling with K&R compilers.

* Fixed an old bug in RegisterMove that was crashing cmail on some systems
(notably linux).

3.5.0 -- Thu Jan  2 16:59:49 PST 1997  Tim Mann

Thanks to Frank McIngvale for much of the work on versions 3.4.4 and above!

* Fix Crafty resumed game time bug (frankm)

* Word wrap text in Analysis window (frankm)

* More debug info for XPM loading (frankm)

* Replaced config.sub, config.guess, etc., with up-to-date versions from
autoconf 2.12.  Hopefully this will fix problems on Pentium Pro machines.

* Removed some Makefile gunk that was causing looping for one person.

3.4.7 -- Thu Dec 19 14:22:41 PST 1996  Tim Mann

All changes from Frank:

* Retrieve ratings from ICC (and FICS, etc., when they add the Creating:
message), save them in the PGN tags, and pass them to Crafty in Zippy mode.

* Add settable time delay between characters in ICS login script.

* Colorize messages like personal tells.  Fix false recognition of channel
tells.

* Pass "tells" from Crafty through to ICS (in Zippy mode).

* Implement ~/ filename convention from C shell for game and position file
names.

* ZIPPYACCEPTONLY feature for testing.

3.4, patchlevel 6 -- Sat Nov 23 16:58:50 PST 1996  Tim Mann

* Put recognition of "illegal move" messages from Crafty for
illegal castling, etc., inside an #if that is currently turned off,
because of a bug in Crafty that generates bogus "illegal move" messages
after some moves that are actually legal and accepted by Crafty.

* Added -checkLegality option; previously this could not be turned off.

* Fixed an old bug in finding default board size parameters.

* Differentiated among channel tell, kibitz/whisper, and personal tell/say.

* Fixed a bug in detecting Xpm in the configure script.

3.4, patchlevel 5 -- Mon Nov 18 16:22:53 PST 1996  Tim Mann

* Added zic2xpm to the kit; it had been omitted by mistake.

* Added some default colors for -colorize

3.4, patchlevel 4 -- Sat Nov 16 18:10:17 PST 1996  Tim Mann

This is meant to be a beta release in preparation for version 3.5.

* Added InfoXBoard and ManXBoard to the Help menu.

* Made Frank's ICS input box optional, defaulting to off.

* Merged in Frank McIngvale's XbKit.  Many new features, including
-clickClick mode, the Analysis modes, piece flashing, ZIICS import,
ICS text colorization, and the ICS input box.  Many thanks to Frank for
supplying and documenting this code.

3.4, patchlevel 3 -- Mon Nov 11 18:23:14 PST 1996  Tim Mann

Small set of changes made while Frank McIngvale was working on XbKit in
parallel.  Unreleased in this form.

* Updated zippy.README.

* Removed useless X event handler and removed strange code for copying
form translation table to board that worked around the bug it caused.
This makes changing bindings in .Xdefaults more straightforward.

* Now pressing the Control key steps back one move, and releasing it steps
forward again.

* Moved quit from "q" to "Q" for greater safety.

* Use "unobserve" instead of "observe" to stop observing; needed on FICS.

* Support for interface variable.

* Strip titles from people who are talking to us, so (for example) Zippy
won't try things like "tell Darooha(*) hello".  Needed on FICS.

3.4, patchlevel 2 -- Tue Jul  9 19:06:42 PDT 1996  Tim Mann

This patchlevel is not planned to be an announced release.  It's in
preparation for integrating Frank McIngvale's XbKit.  It mostly contains
minor fixes I've accumulated since 3.4.pl1.

* WinBoard /telnet option now fires up an external program, as
with xboard, instead of trying to use a feature of NT 3.1 that does not
exist in later versions of NT or in Windows 95.  ChangeLog for 3.4.pl1
said this had been implemented there, but it really wasn't.

* Indicating player to move by the icon color now works under Windows 95.

* WinBoard now kills the chess program when you exit using the system menu
or the [X] button.  Thanks to Michael Lowe.

* Minor changes to Zippy, including: Now understands wild challenges on
FICS; these used to crash it.  Removed limit on how fast a game will be
accepted.  Use "set formula ..." on the chess server to limit this if you
are using GNU Chess.  Now sends correct opponent name to Crafty.

* Added some missing default values to documentation.  Thanks to Stuart
Cracraft.

* Bugfix: Trying to print "No fonts match pattern" error message would
crash.  This can happen to Linux users who don't install Helvetica, for
example.

* Bugfix: Defaulting feature in -size n,n,n,n,n,n would put us in an
infinite loop.

* Added more directories to search for Athena widgets on HPUX.

* New cmail (3.12) from Evan Welsh; includes small fix from Kayvan Sylvan.

* Recognize "illegal move" messages from Crafty for illegal castling, etc.

* Bugfix: "name" command added to zippy.c for Crafty was producing error
message if GNU Chess was in use.

* In bughouse mode, suppress holding messages from console window; show
holdings only in banner.

* Minor fixes/cleanup to Makefile.in and configure.in.

3.4, patchlevel 1 -- Mon Dec 11 13:43:12 PST 1995  Tim Mann

* This patchlevel updates WinBoard to match xboard, and includes a few
fixes and minor improvements.  "-size tiny" and "-size n,n,n,n,n,n"
are still not implemented for WinBoard.

* Installed support for Crafty based on code from Bob Hyatt.
Currently the only documentation for this is in the FAQ, and a few
things don't work with Crafty 8.23.  Please do not report these
problems as bugs in either xboard or Crafty.  Bob and I know about
them.  The worst ones (if not all of them) should be fixed in Crafty
8.24.

* Changed the kludge command we send when gnuchess wants to print
something that doesn't end with a newline, from "help" to "bogus".
This works because the error message gnuchess prints ends with a
newline.  It also improves compatibility with Crafty, which doesn't
need the kludge, but for which sending "help" causes a problem.

* Don't draw grid at all if lineGap is 0; previously we drew the grid
with X "0-width" lines (usually 1 pixel wide) and then overwrote it.

* Makefile: Removed xboard.info from "all" target so we won't try to
rebuild it, because this fails on hosts that don't have makeinfo
installed.  Other minor fixes to "clean" targets, etc.

* Fixes and cleanup to Auto Comment code that handles continuation
lines and highlighting.

* Auto Observe now tries to observe the game from the point of view of
the player who was on your gnotify list.  Requested by rng.
Limitations: We can't tell which player it was unless you have ICS
highlighting turned on.  Also, currently "observe foo" works as
required (observing from foo's point of view) only on ICC, but FICS
will probably implement this soon.

* "-size tiny" now makes the default font smaller automatically.  This
was implemented by introducing an extra Form widget in the hierarchy
for all xboard windows, named either normalLayout, smallLayout, or
tinyLayout.  So you can have resource specifications that apply only
to certain layouts; in particular, XBoard*tinyLayout*font.

* Bug fix: EditGame or EditPosition while playing or examining still was
not really being permitted.

* WinBoard bug fix: On the EditPosition menu, King did not work.

* Added text catalog of WinSock error messages to WinBoard, because
Microsoft still has not put them in the system message catalog.

* Removed support for older ICS game-ending messages that do not have
a PGN result token (*, 0-1, 1-0, or 1/2-1/2) after the closing '}'.
The code for older messages was sometimes firing on the newer
messages, due to parsing ambiguity.  If the current code sees an old
message, it will understand that the game is over, but will always
display * as a result token instead of trying to guess the result by
interpreting the text message.

3.4, patchlevel 0 -- Tue Nov 21 01:02:50 PST 1995  Tim Mann

* This patchlevel was released for xboard only.

* Updated the info file.  It should now be as up-to-date as the man page,
with good English except in the parts that pertain only to AmyBoard.

* Added "-size tiny", requested by Bob Hyatt.  Also cleaned up bitmap
support and added "-size n,n,n,n,n,n" to allow arbitrary-sized bitmaps,
if the actual bitmaps are supplied by the user.

* Updated bughouse support.

3.3, patchlevel 4 -- Sat Nov 18 02:27:21 PST 1995  Tim Mann

* Unreleased beta that works with preliminary FICS bughouse code.  Will
need changes before release to track FICS message changes.

* Removed use of .EX macro from man page.  It is not supported by some
nroff -man macro packages, notably the one on Slackware Linux.  Switched
to boldface for references to xboard and other commands within the man
page, as this seems to be the modern way.

* Bug fix: If ICS rejected a move, it was correctly undone on the board,
but the message widget still displayed the bad move.  Reported by DAV.

* Normally, xboard in ICS mode fetches the move list whenever the board
display switches to a new game.  Doing this is now an option
(getMoveList) that can be turned off, which is useful if you are watching
multiple blitz games.  Requested by rng.

* Move list fetching code is now smarter: it ignores a move list if it is
not for the right game.

* Added support for bughouse as implemented on FICS.  Holdings are shown
in the window title in place of the strength numbers.  A menu on mouse
buttons 2 and 3 (same on both) lets you drop pieces.  There is no checking
as to whether you actually hold the piece you are trying to drop; we rely
on ICS to check that.  Notation of the form P@f7 is generated and parsed.
The mate detector does not understand that non-contact mate is not really
mate in bughouse, but this does no real harm.  It results in a "#"
suffix being displayed on the move notation, but xboard does not assume the
game is over.

* Bug fix: Promotion to a knight was not working with ICC!  Thanks to
Wendigo for the report.

* Bug fix: Special pty code for host types *-*-aix3* and *-*-irix3*
(supplied from configure.in) had a bug that would cause childio.c to
fail to compile, due to a "continue" that was not within a loop.

* Bug fix: In pgntags.c, memory was being freed while still in use.  One
symptom this caused was that on some machines, cmail would fail with a
message that it could not find the BlackNA tag.  The error was in some
submitted code that I included in version 3.2.pl3 without reading
carefully enough.  Anders Forberg noticed the symptoms, and Evan Welsh
(who had nothing to do with causing the bug) found the bug and submitted a
fix; thanks to them both.

* Removed restriction against using EditGame while playing, observing,
or examining on ICS.  You still get a warning popup.

3.3, patchlevel 3 -- Sat Sep 16 11:44:05 PDT 1995  Tim Mann

* Bug fix: Going directly from MachineWhite to TwoMachines mode would kill
off the second chess program after Black's first move.

* Added -timeIncrement feature.  Thanks to Joel Rivat.

* Deleted code that tries to keep you from observing more than one game,
or observing while playing or examining.  There is actually no problem in
doing this, except that every time an update comes in from a different
game than is currently being displayed, xboard fetches the history of the
new game, which may be time-consuming if you are on a slow link.

* Fixed configure so as not to crash when neither lex nor flex is found.
lex or flex is needed only if the user wants to rebuild parser.c.  Thanks
to Phil Humpherys for reporting the crash.

* Bug fix: config.h.in used #define instead of #undef for some macros used
in the pty code in childio.c.  This causes the code to fail to compile on
some architectures, because the symbols are supposed to be undefined, not
defined to empty, when they are not set in configure.  Bug originated in
3.3.pl0 when config.h was introduced.  Thanks to Phil Humpherys for report.

* Bug fix: ShowThinking would not show anything when current position had
no move to display in the move window.  E.g., if position was created by
LoadPosition or EditPosition.

3.3, patchlevel 2 -- Mon Aug 28 11:11:11 PDT 1995  Tim Mann

* Zippy code was omitted from xboard-3.3.pl1 by mistake; now included.

* For WinBoard, added hint to help file that you may need to turn off
LocalLineEditing while typing dialing commands to your modem.

3.3, patchlevel 1 -- Sat Aug 19 15:13:30 PDT 1995  Tim Mann

* Zippy distribution is no longer separate from regular xboard distribution.

* Deal properly with Show Thinking output from GNU Chess when it is
thinking on its opponent's time.  In TwoMachines mode this output is
suppressed to avoid interfering with the output from the machine that is
on move; in other modes it is displayed (including the move that GNU Chess
is predicting the user will make next).  GNU Chess produces this output
only if it is built without -DQUIETBACKGROUND defined; this symbol is
defined by default in patchlevels before pl75, but undefined by default in
pl75.

* Bug fix: Handling of initial board position in move list for wild games
was broken, so wild games could not be observed and adjourned wild games
could not be continued.  Thanks to "Maximum Entropy" for the bug report.

* Added feature: algebraic notation now shows "+" indicator for check
and "#" for checkmate, as called for in PGN standard.  Thanks to Kevin
Maher for the suggestion.

3.3, patchlevel 0 -- Thu Jul 27 22:21:07 PDT 1995  Tim Mann

* Changed configuration to use a config.h file instead of passing zillions
of -D options on the cc command line.

* Merged a small fix and some updates to the texinfo file from Jochen
Wiedmann.  The texinfo file still needs work.

3.2, patchlevel 5 -- Tue Jul 18 20:29:39 PDT 1995  Tim Mann

* Beta test release of xboard only.

* Updated WinBoard code to include new xboard features.

* Added texinfo file from Jochen Wiedmann to the release, but not as the
primary documentation.  It needs updating, and the English needs work.
I did make a few improvements, mostly to change incorrect uses of @var to
either @samp or @code as appropriate.

* Merged in code changes to 3.2.pl4beta from Jochen Wiedmann.

* Fixed EditComment; did not pop up window in previous beta.

* Added AutoComment feature.

* Added GameListDestroy to disable the outdated game list popup in cases
where we load a new game file without building a new popup.

* Added yyskipmoves feature to parser.l to speed up building of gamelist.

* gamelist.c wouldn't compile with a non-ANSI compiler.  Fixed.

* Change to yy_text handling in patchlevel 3 still had problems.  Can't
use AC_DECL_YYTEXT in configure.in, because that defines YYTEXT_POINTER
according to whether the lexer on the current host makes yytext a pointer.
But most people will be using a parser.c that was generated on another
host and shipped with the package.

3.2, patchlevel 4 -- Sun Jun 25 19:13:43 PDT 1995  Tim Mann

* Beta test release of xboard only.

* Added FIREWALLS section to man page.

* Changed -icsport to be a string.  Now with the -telnet option,
specifying -icsport "" suppresses the second argument to telnet.

* Added EditTags feature.  Removed AboutGame from menu, because EditTags
subsumes it.  EditTags suggested by Jochen Wiedmann and first implemented by
him in AmyBoard.  xboard implementation is my own.

* Fixed some missing or incorrect prototypes.

3.2, patchlevel 3 -- Sat Jun  3 18:57:38 1995  Tim Mann

* Beta test release of xboard only.

* New version of cmail from Evan Welsh, to fix compatibility problems with
perl 5.0.

* Added game list feature on Load Game, based on code from Jochen
Wiedmann.  Integrated it with cmail.

* Several bug fixes from Jochen Wiedmann, including one to my yy_text
workaround for the difference in the type of yytext between lex and flex.

* Handle clock pause on FICS.

* Suppress clocks in untimed FICS games (time control 0 0).

* Rebuilt configure script with autoconf 2.3.  This fixes a bug in
configuring for X11R6, where -lSM -lICE would not be added when needed.

* Fixed inconsistent type declarations on IntSigHandler and
CmailSigHandler.  Bug report from Josh Daynard.

* backend.c wouldn't compile with a non-ANSI compiler.  Fixed.

3.2, patchlevel 2 -- Tue Feb  7 14:50:30 1995  Tim Mann

* Minor release of both xboard and WinBoard.

* Added recognition of some FICS messages.  On the other hand FICS is also
changing some of its messages to match what xboard already recognizes.

* Temporarily went back to using "promote" command on ICS instead of
"a7a8=Q", because FICS doesn't implement the latter yet.

* We now avoid using overlapped I/O on pipes in WinBoard, to make Windows
95 beta 2 happy.  This lets WinBoard work with GNU Chess on Windows 95!

* Installed patches from Jochen Wiedmann to coordinate with Amiga XBoard.

* Installed patch to cmail bug in LoadGame from Evan Welsh.

* Bugfix: checkmate and stalemate moves entered with EditGame in ICS mode
were not being handled correctly.  Bug was in GameEnds().

* Implemented EchoOn and EchoOff for xboard, using system("stty echo\n").
Now passwords won't be echoed when you connect directly to ICS.  Also,
telnet negotiation characters aren't displayed (when possible).

* Implemented more of the telnet protocol.  Now connecting to a telnet
server with "-icsport 23" should work even without giving the -telnet
option.  The telnet is in "old line-by-line mode".

3.2, patchlevel 1 -- Sat Dec 10 13:50:46 1994  Tim Mann

* This patchlevel released for WinBoard only.

* winboard.c: Fixed ConsoleInputThread().  Needed to change CRLF to LF,
not to CR.  This was stopping normal /ics mode from working.  Thanks to
Asher Kobin for the bug report.

* winboard.c: Fixed Raw(), EchoOn(), EchoOff().  Now they take effect
immediately, not on the next console read after the one in progress.

* winboard.c: Attempted to make WinBoard work with gnuchessx running
directly on Windows (not remotely via rsh).  It now works on NT, but only
if gnuchess is told not to think on its opponent's time ("easy\n" removed
from initString).  The problem seems to be that GenerateConsoleCtrlEvent
is not doing anything.  On Windows 95 beta 2, we get error messages on
both reading and writing to gnuchessx; I didn't investigate why.

3.2, patchlevel 0 -- Wed Dec  7 13:23:36 1994  Tim Mann

* Thanks to all the beta testers who gave me feedback: Josef Nelissen,
Steve Booth, Evan Welsh, Dima Dakhnovsky, Chris Petroff, Peter Jansen,
Derek Terveer, Michel van der List, Richard Lloyd, Shelly Mistry, and Mike
Lee.  Sorry if I forgot anyone.  Thanks to Virendra Kumar Mehta for
information about DYNIX/ptx.

* Don't exit on keyboard EOF unless we get two in a row.

* WinBoard only: added -localLineEdit switch to allow turning off local
line editing if you really want to.  It is still a bad idea to let the
echoing be done remotely, however; see below.

* Fixed some configure problems on HP-UX.  [Steve Booth]

* Fixed (I hope) configure problem on SunOS 5.3/Solaris 2.3.  [Josef Nelissen]

* cmail bugfix from Evan Welsh (cmail 3.4).

3.1, patchlevel 9 -- Fri Dec  2 23:54:56 1994  Tim Mann

* Beta distribution only

* Always do local echo/edit of user typing in ICS mode.  Doing the echo
downstream may seem nicer in some modes, and it can be hard to turn that
echo off, but the echoed characters can be interleaved with ICS output
and make it impossible to parse correctly.  For xboard this involved only
a change to recommendations in the man page, as Raw() isn't implemented.
For WinBoard, removing Raw() made a real difference.  Added code in
WinBoard to change /r/n back into /r on keyboard input, as we get the
former when Raw() is not called.

* Do not issue ICS "refresh" command after we start to observe a game
unless we get to the next prompt without seeing a board image.  Newest
version of ICS doesn't require this refresh, but old versions around still
do.

* cmail bugfix and small code cleanup in LoadGame, from Evan Welsh.

* Added keyboard accelerators N/P for LoadNextGame/LoadPreviousGame.  Evan
Welsh request.

* Using "-" on the command line as a filename for loading (saving) games
or positions specifies the standard input (standard output).  Alain Picard
suggestion.

* On WinBoard only, a command line option without a leading '-' or '/' is
now taken as the value of -lgf.

* Changed to not use stdin, stdout, stderr as initializers in backend.c;
needed for GNU libc compatibility.  You also must build parser.c with flex
(not lex) if you are using GNU libc, to avoid having the same problem
there.

* Changed WinBoard to avoid using "overlapped" input on the console.  It
now seems to fully work on Windows 95 beta 2.

* Improved comment popups on WinBoard.  Now newlines are handled properly,
and the plain Comment popup window doesn't disappear and reappear when we
step to a new move with a new comment.

* Fixed bugs in detecting the absence of the time and otim commands.

* Added built-in implementation of rcmd protocol to WinBoard.  Windows NT
does not implement passing signals through rsh, and Windows 95 does not
have rsh at all.

* Added -remoteUser option.

3.1, patchlevel 8 -- Mon Nov 28 15:26:07 1994  Tim Mann

* Beta distribution only

* Rearranged ChangeLog file into reverse chronological order to be closer
to GNU standards.

* Integrated new cmail code from Evan Welsh (including cmail RCS rev 3.2).
Includes a bug fix to TruncateGame.

* Updated ICS address to be chess.lm.com.

* Bug fixes to handling the aftermath of FatalError.  Thanks to Chris
Petroff for the bug report.

* Test for remsh before rsh, other fixes for HP-UX.  Thanks to Richard
Lloyd.  I wasn't able to do all the things he suggested, so there may
still be some rough edges in building on HP-UX.  See the FAQ file for hints.

* Bug fix; added missing check for HAVE_SYS_SYSTEMINFO.  Thanks to Josef
Nelissen for testing on Solaris 2.x.

* Updated WinBoard to match xboard.  (WinBoard still has a few option
dialogs that don't exist in xboard.)

* Changed Hint output to a popup.

* ShowThinking output and move output no longer overwrite each other.
ShowThinking output won't appear if the displayed position is not current.
ShowThinking output in TwoMachines mode made clearer and documented.

* Implemented --enable-ptys and --disable-ptys arguments to configure.

* Fixed Book and Hint code to work over a pty with echo enabled and tabs
expanded to spaces.  Thanks to Dima Dahknovsky for the bug report.

* Moved Attention calls from all over xboard to one place, inside
SendToProgram.

* Added bulletproofing to ShowThinkingEvent.

* Added code to handle "refresh N" boards that come in from ICS properly,
assuming ICS is changed to mark them with a new relation code (-3).

3.1, patchlevel 7 -- Sun Nov 13 22:16:01 PST 1994 -- Tim Mann

* Beta distribution only

* Changed ShowThinking to just show the current best line in the
DisplayMessage area, instead of dumping everything to stdout.

* Installed new cmail (RCS rev 3.1) and cmail.man (RCS rev 1.10), and
changes to cmail code in backend.c, from Evan Welsh.

* Miscellaneous minor fixes.

3.1, patchlevel 6 -- Fri Nov  4 12:53:53 PST 1994 -- Tim Mann

* This patchlevel was not actually released to anyone.

* Updated the pty code to be based on GNU Emacs 19.24, and moved it to a
separate file.  It was hard to split out just the pty configuration from
all the stuff emacs does with its custom configure script and .h files,
but I did my best.

* Converted from imake to GNU autoconf.  This was a serious upheaval.

* Put in code to help trap "error gathering move list" problem reported by
Michel van der List if it recurs.  I couldn't reproduce it.

3.1, patchlevel 5 -- Mon Oct 31 21:12:00 PST 1994 -- Tim Mann

* Beta distribution only.

* We now test for checkmate or stalemate in EditGame mode after every user
move, and in LoadGame mode whenever we hit the end of a game without
seeing a PGN end marker.  cmail needs an update to deal with this
correctly; Evan promises one.

* Bugfixes in new move generator.  Thanks to Mike Lee for reporting one of
the bugs.

* Imakefile was omitted from patchlevel 4.

3.1, patchlevel 4 -- Mon Sep 19 18:19:46 PDT 1994 -- Tim Mann

* Beta distribution only.

* The move generator includes a mate tester.  Initially this is used only
by cmail, and even that usage needs further work.

* Wrote a true move generator and used it to replace all the move
disambiguation and legality checking code in parser.l.  The move generator
is capable of dealing correctly with en passant and castling availability,
but the rest of the program still does not keep track of this information.

* Bug fix: xboard did not handle "foo has made you an examiner of game 23"
message.  Thus you could not use examine features until the next board
came in, showing your new relation to the game.  Thanks to POOKIEWOOKIE on ICS
for the bug report.

* Added AutoObserve feature.  Thanks to Chris Petroff for the idea.

* Added Book feature to use new gnuchess "bk" command.  Mike McGann request.

* Redid code to handle missing "time" command in gnuchess, because latest
gnuchess no longer sends a response to this command.

* Eliminated need for -DFLEX.  Thanks to Michael Shields (Vladimir?) for
the idea.

* Added missing code to implement MoveNow in TwoMachines mode.

* Added ShowThinking feature.  Thanks to Richard Lloyd for the idea.

* Applied patches from Evan Welsh; some fixes and improvements to the
cmail code.

* Fixed bug in moving from EndOfGame mode to MachineWhite or MachineBlack,
introduced in previous patchlevel.  Also fixed related bug in ending a
game in ICS mode; was entering EndOfGame mode instead of IcsIdle.

* Added patch to implement internetChessServerLogonScript flag, from Kevin
O'Connor.  Thanks!

3.1, patchlevel 3 -- Wed Sep  7 13:22:07 PDT 1994 -- Tim Mann

* Beta distribution only.

* Merged in new cmail code from Evan Welsh.  He added the ability to have
more than one game per message, needed for official IECG matches.  I added
the ability to resign or offer/accept/decline a draw in a cmail game.

* Bugfix: invalid -tc option caused segmentation fault; DisplayFatalError
was called too early in initialization.  Georges Honore reported this bug.

* Decided to keep EndOfGame mode as an element of the user interface---it
means that a gnuchess game or loaded game has ended, and the user must
explicitly select EditGame to edit it, rather than just being able to
enter more moves freely.  But internally there is no longer an invariant
tying this mode to whether the chess program is running.

* Zippy bugfix: Was saving only the final position in the -sgf file when
the game ended by something other than resignation or flag.  Also fixed
the longstanding bug that Zippy would think the final board of such a game
was a new game and restart the chess program.

* Now does a better job of faking castling availability in FEN.  We still
don't really keep track of it, but now at least we don't say that castling
is still available when the king or rook is not on its home square.

* Bugfix: Initial board of game history for wild games was going through
too much processing, causing us to forget the game length, which is now
needed by ParseGameHistory.  This was causing problems with resuming
adjourned wild games.

* Updated ICS host to ics.onenet.net.

* Zippy now accepts challenges where the opponent specified his color.

* Added ZIPPYPASSWORD2 to let operator give commands directly to gnuchess.

* Bitmap directory can include alternative icons now, too.

* Handle "Game * (*) has no examiners" message from ICS.

* Revamped window title and icon name selection.

3.1, patchlevel 2 -- Sun Jun 12 17:16:28 PDT 1994 -- Tim Mann

* "Beta" distribution for Zippy users only.

* Bugfix: common.h was assuming that X11 type Boolean is char, which is
not always true.  This might have caused all sorts of obscure bugs!

* Installed new bitmaps from Elmar Bartel as the default.  Many thanks!
The old bitmaps can be used by changing the "bitmaps" symbolic link before
compiling xboard, or by using the -bitmapDirectory option at runtime.

* Loading a game that ends with the PGN unfinished symbol ("*") now always
leaves you in EditGame mode.

* Added documentation of -icscomm to man page.  Thanks to Maarten Remkes
for the linux script.

* ^C now kills gnuchess as well as xboard.  Thanks to Dima Dakhnovsky for
reminding me how to do this.

* Bitmap icon color now indicates player to move.  Stuart Cracraft
suggestion.

* Changed piece bitmap flags to have just one flag, which points to a
directory full of bitmaps, instead of a flag for each bitmap.  Also
changed bitmap naming convention.

* "Connection closed by ICS" is no longer a FatalError popup.  This was
too annoying in the normal case where the user typed "quit".

* Changed default font to 14 pixels instead of 10 points.  This seems to
make it close to the size I want it to be on more displays.

* Major mode (GNU Chess, etc.) appears in title bar.  Stuart Cracraft
request.

* Bug fix: EditGameEvent, MachineBlackEvent, MachineWhiteEvent, and
TwoMachinesEvent were calling PauseEvent to get out of pause mode, which
now has undesired side effects, such as advancing the display to the
forwardMostMove.  It works fine to just set pausing = FALSE instead.

* IcsExamining mode now lets you access ICS edit position commands using
the same popup menus as xboard's EditPosition mode.  Thanks to DAV on ICS
for inspiring the idea.

* Corrected test for gcc on HP in Imakefile; thanks to Richard Lloyd.

3.1, patchlevel 1 -- Wed Jun  1 16:25:11 PDT 1994 -- Tim Mann

* Added parser.c.lex and parser.c.flex to the distribution.

* Added HP gcc options to Imakefile, from Mats Nylen.

* EndOfGame mode no longer highlights EditGame mode indicator, because the
modes really do differ.  I would like to get rid of EndOfGame mode in the
future, at least as far as users can see.

* Larger %a in parser.l, needed for RS/6000 users.

* Minor improvements to Mail Move error messages.

* When -debug flag is given to xboard, -v is passed to cmail.

* Old Save Style uses "1. ..." instead of "1..." when black moves after a
comment; more like xboard 3.0's actual style.

* New version of cmail from Evan Welsh.  Looks for UCB Mail in a more
portable way and has some minor bug fixes.

* Bug fix: Saving a FEN position while in EditPosition mode with black to
play was showing white to play in the saved position.

3.1, patchlevel 0 -- Fri May 20 16:36:15 PDT 1994 -- Tim Mann

* This is the first general release since 3.0, patchlevel 9.  Releases
since then have been limited-distribution or beta releases.

* Thanks to my version 3.1 beta testers: Dmitry Dakhnovsky, Ed Hanway,
Richard Lloyd, Mike McGann, Shelly Mistry, Josef Nelissen, Chris Petroff,
Jack Robertson, Michel van der List, Ky Macpherson, Derek Terveer, and
Evan Welsh.  Sorry if I've forgotten anyone who gave me feedback.

* Updated man page.

* Minor cleanup on menu sensitivity code.

* Integrated another even better version of cmail from Evan Welsh,
including some code he supplied in xboard itself.

* A few more fixes to cmail support.

* Automatically update clocks after an ICS "moretime" command.

* Handle ICS automatic examine mode (set examine 1) after a game.

3.0, patchlevel 14 -- Tue May 17 13:41:44 PDT 1994 -- Tim Mann

* Beta test release only.

* Don't suppress prompt on first board of game being examined; otherwise
it looks like nothing happened at all (i.e., like you're lagged).

* Added StopExamining and StopObserving (Chris Petroff suggestion).

* Made Reset do a refresh on ICS.  John Chanak's original ICS code for
xboard tried to do this; I finally decided it was a good idea after all.

* Fixed bugs in handling updates that come in while you are pausing in
examine mode.  This is pretty tricky to do right.

* Made un-Pausing immediately pop you to the current position.  This is
always necessary in examine mode, since the game may have changed under
you; your remembered moves might no longer be right.  So I made it do the
same in all modes.

* Took Detach Examine mode back out...used Pause mode for this instead!

* Put in a trap for the GNU Chess bug of printing an Illegal Move message
when its own hint move is illegal.

* Attempted to fix a Zippy bug; bogus "exited unexpectedly" messages after
it checkmates its opponent.  This involved adding an argument to GameEnds
to say who says it ended (ICS, GNU, etc.)  and taking different actions in
different cases.  Unfortunately, this just restored an older Zippy bug, where
Zippy restarts gnuchess when it gets the board with the final position,
because GameEnds still puts xboard in EndOfGame mode.  Sigh.

* We now capture elapsed time on last move when getting game history.
(Josef Nelissen bug report)

* Rewrote code to redisplay last file title so it really works.

* Fixed bug in oldSaveStyle.

* Larger %a and %o were needed for lex.

3.0, patchlevel 13 -- Mon May 16 16:26:22 PDT 1994 -- Tim Mann

* Beta test release only.

* FatalError popups stay on the screen now.  If the error is really fatal,
all functions are disabled, and the program exits when you press OK.

* Redisplay last file title when using Load (Next/Previous/Same) Game.

* Zippy understands new match challenge message format on ICS.

* Added Revert command.

* When examining a game on ICS, < > buttons do ICS backward/forward
commands, unless you set the Detach Examine option.  Thanks to Dima
Dakhnovsky for the idea.

* Fixed various minor problems in cmail mode.

* cmail generates the tags now.  New version of cmail from Evan Welsh.

* cmail mode won't let you do MailMove unless the currently displayed
position is exactly one move past the end of the game you loaded.

* Fixed building of man pages in Imakefile

* Updates to INSTALL file

3.0, patchlevel 12 -- Sat May  7 21:10:03 PDT 1994 -- Tim Mann

* Beta test release only.

* Brought man page up to date.

* Added Shift+R to resign from keyboard.

* Some items on Action menu available in GNU Chess mode now.

* Revamped Action menu.

* Reordered functions in backend.c as a small step toward reorganizing
this whole mess.

* Generate TimeControl PGN tag.

* Get type of ICS game (e.g., rated blitz) and save in PGN tags.

* Bug fix: Clocks were not redisplayed when entering EditGame mode.

* Bug fix: Clocks were not being redisplayed after loading a game file
with -td 0, so they could show the wrong color active.

* Bug fix: Chess programs would be killed and match mode would exit
prematurely when loading a PGN game fragment ending with "*".

* ICS command "sposition" no longer confuses xboard.

* Integrated new version of cmail (with support code in xboard) from Evan
Welsh.

* Added TruncateGame, MoveNow, RetractMove, and QuietPlay.

* Bug fix: switching between MachineWhite and MachineBlack was not calling
Attention().  Reported by Dino Dini.

* More improvements to INSTALL and Imakefile.

* Pack moves into 79 character lines in PGN output.  We don't generate
check indications, and we always break the line before the result,
so this is not quite PGN export format.

* Use FEN tag in PGN.

* Improved finding and counting of game starts in save files.

* Negative position or game numbers in -lpi/-lgi mean to seek to that byte
offset.  Hook for possible future features, not in man page.

* Detect and handle absence of either "time" or "otim" commands in
gnuchess.

* Don't use "promote" command to ICS anymore.

* Handle switching sides and taking back moves on FICS.

* Handle flip state flag in style 12 board.

* Handle examine mode on ICS.

* Improved error popups for various kinds of illegal moves.

* Suppress unasked-for hints from gnuchess (which it generates in post
mode).

* Load/save position functions use FEN.  Old style also supported.

* Added detailed error messages if loading a bitmap file fails.

* Small board has 2-pixel lines between squares instead of 3-pixel.

* Added OldSaveStyle and AboutGame.

* Renamed ForceMoves to EditGame.

3.0, patchlevel 11 -- Tue Sep 21 15:25:36 PDT 1993 -- Tim Mann

* The following changes were present in xboard 3.0, patchlevel 11, but the
first group did not make it into WinBoard 3.0 until later.  xboard
3.0.pl11 was a limited-distribution release only, mostly to Zippy users.

* Man page minor fixes.

* Added a missing file close.

* Removed automatic error popdown on Reset, which was destroying some
error messages before they could be read.

* Fixed char vs. unsigned char warnings on bitmaps.

* Use ICS board style 12.  Some improvements to ICS parsing.

* Comment window is now labelled with the move the comment is on, and
comments don't pop down when you step to the next move.

* Save files now in PGN format.

* Support for loading PGN files.  PGN tags pop up when a PGN game file
is loaded.

* More info in INSTALL and Imakefile about building for Suns (and
other systems).

* WinBoard 3.0 patchlevel 11 split off from an early version of xboard
3.0 patchlevel 11, so it does not have all the features of that
patchlevel.  The following changes made it into both xboard and
WinBoard:

* Made Comment dialog non-modal in WinBoard.

* EndOfGame mode is now more transparent.  It looks like ForceMoves
mode except that there is no chess program running.

* Small bug fixes in clock management.  Most noticeably, pausing when
it is gnuchess's move now works as documented (again).

* Add minimal support for -icscomm option.  Not documented yet because
I haven't sorted out the issues with setting the tty modes on the comm
port device, or with locking it properly.  But it's usable by wizards.

* Don't restart the chess program upon Backward event from EndOfGame mode.

* Suppress extra prompt after ICS sends us a board.

3.0, patchlevel 10 -- Sat Sep 11 18:44:03 PDT 1993 -- Tim Mann

* Beta test release only.

* Zippy now plays chess.  zippy.c and zippy.h are still not included
in the standard distribution, but are available on request.

* Switched to using style 12 on ICS.

* Updated man page, and documented use of XBoard*form.translations to
add more shortcut keys.

* Added shortcut keys "d" to claim/offer/accept a draw, and "t" to
call flag.  Suggested by venu on ICS.

* More explicit instructions in INSTALL file.

3.0, patchlevel 9 -- Tue Sep  7 14:02:00 PDT 1993 -- Tim Mann

* General release, minor update to 3.0.pl8.

* Loosened checking on whether it's okay to start a move, to satisfy
ICS ultra-blitz players.  Now we don't check whether it's your turn
until you let go of the piece.

* Parser now recognizes "+-+" as meaning the game ended in a draw.

* Got rid of S_NONE symbol, which seems to conflict with some symbol
Sun defines.

* Tweaked the man page.  Clarified that there is currently no way for
two people running copies of xboard to play each other without going
through the Internet Chess Server.

* Fixed a bug in color name conversion.  Asking for two different
colors whose names were the same in the first four characters would
get you two copies of the first one.  Thanks to Volker Zink for the
bug report.

* Improved confusing Usage() message.

* Added a bunch of Sun information to the Imakefile and INSTALL file.
Thanks to Ed Hanway, Arik Klingensmith, and others who responded.

* Test for defined(WIN32) instead of !defined(unix).

* Avoid using (void *) type with non-ANSI C compilers.  Thanks to
James Altucher for the bug report.

3.0, patchlevel 8 -- Thu Sep  2 12:23:01 PDT 1993 -- Tim Mann

* Note: Patchlevel 8 was the first non-beta release of xboard 3.0

* Added cmail to distribution.  Contributed (and still maintained) by
Evan Welsh.

* Bug fix: -queen option wasn't initializing menu check.  Reported by
Pat Surry.

3.0, patchlevel 7 -- Thu Aug 26 13:23:24 PDT 1993 -- Tim Mann

* Sent WinBoard 3.0.pl7 to Torre on ICS

* Added parser.h to hold the interface to parser.l

* Upgraded COPYING file and copyright notices to GNU GPL version 2.

3.0, patchlevel 6 -- Tue Aug 24 15:16:13 PDT 1993 -- Tim Mann

* We no longer display intermediate positions or intermediate comments
while loading a game file with -timeDelay 0 or loading an opening to
start up a -matchMode game.

* Loading an empty game from an xboard save file now gives a status
message "No moves in game" instead of an error popup saying "Game not
found in file."

* Added comment.awk to distribution.

3.0, patchlevel 5 -- Tue Aug 17 16:45:54 PDT 1993 -- Tim Mann

* Bug fix:  xboard would crash if it couldn't get all its colors; now
it switches to monoMode instead.  Also, xboard was trying to convert
color resources even when using a b/w display.  Reported by Larry
Rogers.

* Bug fix: Declared fields of TimeMark as signed so that we get signed
instead of unsigned arithmetic.  SubtractTimeMarks was breaking on
Alpha AXP (which has 64-bit longs) with old declarations.  Reported by
Michel van der List.

* Bug fixes:  Keyboard accelerators now work after EditComment window is
popped down.  Iconize keyboard accelerator now works even if xboard
was started with -iconic flag and later deiconized.

* Bug fix:  The routine that tests whether a move is illegal because it
would leave you in check was not handling e.p. captures properly.
Reported by Patrick Surry.

* Bug (?) fix:  Was adding time to clocks at time control even when
loading a game file.  Actually it's not entirely clear how time
controls should be dealt with when some moves are loaded from a file
or clicked in with ForceMoves.  For now ForceMoves mode does add the
time (because it can be used to change moves during a live game), but
LoadGame mode does not.

* Updated usage message.

* Previous attempted fix to matchMode had broken TwoMachines mode and
generally needed more work.  Also simplified command line interface to
matchMode.

3.0, patchlevel 4 -- Thu Aug  5 14:17:18 PDT 1993 -- Tim Mann

* Thanks again to the beta testers listed for 3.0 patchlevel 3, and also
Desnogues, Steve Cariglia, Niklas Engsner, Mark Silver, and Roger Rowe.

* Reorganized man page, splitting OPTIONS into subsections.

* matchMode was very broken; fixed.

* Changed convention for turning off command line options from --opt
to -xopt, to be less inconsistent with GNU standards.  Also changed
the long command line options to take True/False arguments like
resources; seems to make more sense this way.

* Added AlwaysQueen option -- suppresses promotion dialog and always
promotes to a queen if you move a pawn to the last rank.  Has no
effect on gnuchess (or your ICS opponents!) -- they can still
underpromote.

* Subtracted an extra fudge term when determining how wide message and
title widgets should be.  This fixes a problem some beta testers had.
Wish I knew why it's needed.

* Bugfix in parser; symptom was that you couldn't do LoadGame after
observing a game on ICS.

* Bugfix in Forward; didn't work after game ended while Pause was turned on.

* Removed bogus execute bits on .h files.

* Use REMOTE_SHELL and TELNET_PROGRAM definitions.

* MachineWhite and MachineBlack now work from TwoMachines mode.

* Popping down an error message with the [ok] button was not turning off
the errorUp flag, so the next move would cause xboard to try to pop it
down again, resulting in a wild memory reference and sometimes a crash.

3.0, patchlevel 3 -- Tue Aug  3 17:40:27 1993  -- Tim Mann

* Thanks to my beta testers: Patrick Surry, Takuya Kojima, Robert J. Luoma,
Chris L.  Petroff, Richard K. Lloyd, Michel van der List, Craig Metz,
Antoon Frehe, Simon Clift, Shelly, Eric Peterson, Christopher Mitchell,
Martin Koch, Ed Hanway, Steve Booth, Udo, Ken Hobday, and Joseph Duhamel.

* Improved error messages for trying to move the wrong color pieces or
to move when it's not your turn.

* Special code for monoMode on 1-bit displays now understands displays
where 1=white and 0=black.

* Declare getenv() if <stdlib.h> not included; avoids a compiler warning.

* Documented borderXoffset and borderYoffset.

* Added -titleInWindow option for use with X window managers that
don't let us set the title in the window banner.

* Fixed error message printing in WinBoard; system error messages no
longer appear as numeric codes.

* The error message popup is now non-modal; you don't have to press the
[ok] button before you can do something else.  In addition, the popup is
positioned so that it doesn't cover up the board (too much), and making a
move or otherwise clicking on the board pops it down.  (Not implemented in
WinBoard.)

* You can now call your opponent's flag in ICS mode by clicking on his
clock.

* Fixed minor bugs in -flipView option and documented exactly how xboard
decides which way to flip the view.

3.0, patchlevel 2 -- Fri Jul 30 22:20:23 PDT 1993 -- Tim Mann

* Added Autosave to Options menu.  Would be better to have Save
Options dialog as in WinBoard, but this was quick to do and gives the
most-needed functionality.

* Changed "Reload Game" on menu to "Reload Same Game".

3.0, patchlevel 1 -- Thu Jul  8 21:22:59 PDT 1993 -- Tim Mann

* Sent a copy of patchlevel 1 to Patrick Surry to beta-test.

* Added -cmail option that sets appData.cmailMode.  Currently a no-op.
In the future this may set special modes for use by the cmail script
for playing chess by email.

* Added LoadNextGame, LoadPreviousGame, and ReloadGame to File menu.
ReloadGame suggested by Patrick Surry.

* Added -flipView command-line option.  Suggested by Patrick Surry.

* Fixed bugs in parser.l:  (1) Pattern for "# xboard game file ..."
needed to match to end of line.  (2) Start of a new file was not matching
the ^ start-of-line character.  The fix for this is a kludge.

* Made game counting code in LoadGame more robust, and made LoadGame
able to detect the end of a saved partial game (by noticing the start
of the next game) in game files created by XBoard itself.  We don't
try to find the start of the next game that way in other kinds of game
files, because the only way I can think of to do that is to look for
another move #1, and that technique gets too many false hits.

* Fixed recently introduced bug in LoadGame when game starts with a
position diagram.

3.0, patchlevel 0 -- Fri Jun 25 14:17:17 PDT 1993 -- Tim Mann

* Changes in this patchlevel were too numerous to list.  Larger ones are
listed below.

* Added a popup dialog to enter and edit comments.  Inspired by some
code from Patrick Surry.  Changed the normal read-only comment popup
to the same style.

* Added ICS init script feature from Karl Schwamb.

* Added some ESIX fixes and OMIT_SOCKETS ifdef option, from Kayvan Sylvan.

* Revamped code to allow use of flex instead of lex on parser.l.
Using flex requires adding -DFLEX to defines in Imakefile.

* Source code is split into front end (xboard.c), which knows about X
and Unix, and back end (backend.c), which knows about chess, gnuchess,
and the ICS.  There is also a front end for Windows NT.

* Boolean command line options now use "-foo" to turn on and "--foo"
to turn off instead of "-foo true" and "-foo false".  [Later -xfoo;
see above.]

* Added menu commands to control autoflag, bell, and coords options.

* User interface has a new look: (1) Menu bar instead of array of
buttons.  A few very commonly used features have small buttons in
addition to being on the menus. (2) Large font for clock.  (3) Pop-up
dialogs for errors.

2.1, patchlevel 11 -- Sat Jun  5 00:01:01 PDT 1993 -- mann@src.dec.com

* Added code to deal with "wild" games on ICS.  This includes allowing
castling with the king on d1 or d8, which is allowed in wild(1) games
if the king started there.  Notation is o-o to castle "short"---to
whichever side the king is closer to---and o-o-o to castle "long."
Right now wild castling is always allowed by xboard; we rely on ICS or
gnuchess to reject it when we aren't really in wild mode.

* memcpy call had arguments in wrong order.

* Removed April Fool code

2.1, patchlevel 10 -- Mon Feb 15 10:19:31 PST 1993 -- mann@src.dec.com

* Avoid trying to select on a pipe when using System V.  Needed to
copy some code from InitChessProgram() up into establish().

* Bug fix in disambiguating pawn moves like "ed".

* Fix to error handling in ReceiveFromProgram.

* Bug fix: entering EditPosition mode with black to play highlighted
White's clock instead of Black's.

* Added telnetProgram resource in case "telnet" is not the name of the
telnet program.

2.1, patchlevel 9 -- Fri Jan 22 19:08:27 PST 1993 -- mann@src.dec.com

* Entering Force Moves mode clears "flag has fallen" messages from display.

* ICS host name can now be in numeric format; for example 128.2.232.4.

* Bug fix: LegalityTest was failing to test whether a pawn move was
illegal because the move would discover a check.

* Handle ICS message "mann asserts a win over manntest, who disconnected."

* Bug fix: A recent change to PromotionCallBack had broken
underpromotion to a knight.

* Bug fix: In EditPosition mode, dragging a piece onto a square border
would make it vanish.  xboard wasn't distinguishing this case from
dragging the piece off the board.  Thanks to Matthew Kidd.

* Removed "static" declaration from yywrap for compatibility with IRIX
version of lex.  Thanks to stiller@blaze.cs.jhu.edu.

* Added substitutes for bzero, bcopy, and gethostname for Solaris
SVR4.  Thanks to Michael Grant.

* Bug fixes to queen move disambiguation.  Bugs showed up only when
promotion resulted in more than one queen on the board.

2.1, patchlevel 8 -- Fri Dec 11 17:54:18 PST 1992 -- mann@src.dec.com

* parser bug fix: It now really works to leave off the piece a pawn is
promoting to and let it default to queen.

* When starting to observe or play an ICS game, don't draw board in
initial position and then immediately redraw it in the current
position.

* Handle ICS messages when an "abuser" forfeits a game by
disconnecting and when a game is aborted ("removed") by an
administrator.

* Bug fix: A user move when in LoadGame+Pause mode was resuming the
game load instead of putting us in force mode.

* It seems that crashes inside sscanf when xboard is compiled with gcc
(as on IBM PS/2 AIX, mentioned below, and also on VAX Ultrix 3.1) are
caused by an incompatibility between gcc and the sscanf implementation
on these platforms.  A workaround is to specify -fwritable-strings to
gcc (see the gcc documentation).  Added info on how to do this to the
Imakefile.  Thanks to Tom McConnell for this information.

* Clocks are allowed to go negative.  This is mostly for ICS
compatibility, but it affects gnuchess mode too.  Also, we give the
time bonus when a player hits the time control boundary even if his
flag is already down.  This choice is a bit debatable, but it makes
things look better when you are in TwoMachines mode and gnuchess's
time management screws up causing it to exceed its time limit.

* Implemented move legality checking code.  Moves made with the mouse
or parsed from a file are checked for legality before being made.
This is mostly in preparation for future extensions, such as
human-human play.  For now it makes -noChessProgram mode more useful.

* If the user takes back moves, we restore the clocks to the earlier
settings.

* We now handle the output of the ICS oldmoves command, including
parsing the game end condition.

* Added autoCallFlag mode.

* Fixed glitches in the medium size outline king and rook bitmaps, and
touched up the medium size solid king and outline queen.

* bug fix: DisplayMove would not display backwardMostMove - 1.

* Added CallFlag button and removed AcceptMatch.  CallFlag is more
important with new ICS, and accepting the current match offer is easy
with the new ICS command "accept" (can be abbreviated "ac").

* LoadGame and LoadPosition display tail of file name (plus index
number, if any) as title.

* MachineWhite, MachineBlack, and TwoMachines now work properly from
LoadGame and LoadGame+Pause mode.

* Use o-o and o-o-o to castle on ICS, not 00 and 000.

* Stripped out code for old ICS messages; new ICS is now installed.

* Bug fix: don't offer autosave when paused during LoadGame.

2.1, patchlevel 7 - Fri Dec 11 17:40:56 PST 1992 - mann@src.dec.com

* Track change to "Illegal move" message in new ICS.

2.1, patchlevel 6 -- Tue Dec  8 10:48:44 PST 1992 -- mann@src.dec.com

* Kludged around bug in keeping comment popup where you put it by
adding borderXoffset and borderYoffset resources that give the width
of the borders added by the window manager.  Yucch.

* Changed searchDepth kludge back to using "help" instead of "bd"; the
latter didn't work because the output contains a line starting with
"White", so we think gnuchess is telling us that White won.  Oops.

* Removed some code that uses an X11R5 feature, XrmGetDatabase.
Without this, the auto font sizing code is harder to make work, so to
keep my sanity I had to change it to affect only the fonts that appear
in the main window and the comment popup, not the other popups.  Maybe
this is better anyway.

* AcceptMatch button now works after a counterchallenge, too.

* Added code for more variants of messages about games being adjourned
or aborted.  These messages need to be unified in new version of ICS.

* Added workaround for minor bug in ICS; game number on first board
can be wrong.

* Removed code to say "refresh n" instead of "refresh"; was broken and
wasn't needed anyway.

* Added missing casts for compilers that distinguish enums from ints
and missing cast in connect call.

* Added code to recognize "both sides are out of time" draw message
proposed for next version of ICS.

* Thanks to Danny Sleator and Joe Peterson for bug reports.

2.1, patchlevel 5 -- Sun Dec  6 19:52:40 PST 1992 -- mann@src.dec.com

* Removed gcc and CDEBUGFLAGS from Imakefile.

* Corrected setting of mode to ForceMoves when game file ends or
contains an AmbiguousMove or BadMove.  Previous bug was harmless.

* Added AcceptMatch button and mention of 50-move rule for Draw button
to man page.

2.1, patchlevel 4 -- Sun Dec  6 02:55:42 PST 1992 -- mann@src.dec.com

* Now handles revised messages from new version of ICS.  New ICS is
not released yet, so this code might change further.  Next patchlevel
will remove support for old ICS; both are there now.

* Initial processing for a new game being watched or played now
happens when we see the first board image.  Removes the need to parse
some messages and unifies some code.

2.1, patchlevel 3 -- Tue Dec  1 19:40:40 PST 1992 -- mann@src.dec.com

* Handles ICS messages "Draw : neither player has mating
material" and "Draw : White has no material, Black has no time."

* Added AcceptMatch button for ICS mode.

* Fixed bug in previous fix to yylexstr().

* Fixed bugs in code for loading old position files that don't start
with "#" and for handling case where user asked for nth position in
file but there aren't that many.

* Handles ICS message "* has restored your old game"

* ResetProc always clears title line now.

* Don't issue just "refresh" when watching a game; use game number.
Upcoming new version of ICS may need this.

* Added code to try to prevent user from watching and/or playing more
than one game at a time.  There is a race condition inherent here; if
we get more than one board from the game before our command to stop
watching it takes effect, we'll think the user started it again.  Not
clear how to fix this.

* Redid ParseBoard8 to use sscanf.  Code is a good deal cleaner now.
Also, we now parse out the game number too, though we don't make much
use of it yet.

* (Tried to put in a feature that recognizes the current game in a
game file must have ended when we see the start of a new one, but had
to disable it because we have too many false hits with the current
parser, especially in gnuchess listing files.)

* Moves read from game files or received from ICS are now translated
into canonical algebraic form just like all other moves.  Minor nit:
If you use Reset while playing or observing a game in ICS mode, the
game history (including the current board position) is lost, so the
next move of the current game can't be translated.

* Default fonts now vary with board size, and are chosen by pixel size
instead of point size (since piece bitmaps have a fixed pixel size).

* Bug fix: An extra Forward was required to skip over time indications
in game files.

2.1 patchlevel 2 -- Fri Nov 27 23:30:00 PST 1992 -- mann@src.dec.com

* If you move the comment popup, the next time it pops up it will come
back where you put it.

* Fixed yylexstr() so calls to it can be interspersed with calls to
yylex().

* Fixed bugs in Forward/Backward while in LoadGame mode.

* Changed Save{Game,Position} functions to append instead of
overwriting if file exists.  Changed Load{Game,Position} functions to
deal with multiple games/positions per file.

* Changed load{Game,Position}File resources to trigger automatic load
on program startup.  Changed save{Game,Position}File resources to
trigger automatic save after every completed game and on program exit.

* Added autoSaveGames mode.

* Fixed bug with PromoPiece in call to MakeAlg from MakeMove.

* Many changes to get rid of picky compiler warnings and generally
clean up the code.

2.1 patchlevel 1 -- Fri Nov 27 02:45:00 PST 1992 -- mann@src.dec.com

* A last minute change before patchlevel 0 went out broke
ParseGameHistory().  Immediately fixed in patchlevel 1.

Version 2.1, patchlevel 0 -- Fri Nov 27 02:00:00 PST 1992 -- mann@src.dec.com

* Uses "time" command of gnuchess 4.0 and following to keep clocks in
sync.  Still works with older versions without this command; we test
whether the command is present the first time each chess program is
started.

* File name dialog pops up under the mouse cursor, so that it's got the
keyboard focus if the window manager is using pointer focus.

* Attempts to move the wrong color piece or an empty square are filtered
out in xboard instead of being passed on to GNU Chess or the ICS.

* The reason a game ended is now remembered even if you move backward
and forward after it ends.  It is forgotten only if you make a move
(which is as it should be---this is now a different game, which hasn't
ended yet).  The message saying why the game ended no longer wipes out
the last move.

* Pause, Backward, Forward, ForceMoves, and EditPosition now work from
TwoMachines mode.

* Forward and Backward now change only the board display unless you
are in ForceMoves mode.  Pause mode keeps new moves that are received
from being displayed on your screen until you unpause (or use
Forward).

* Added option to ring the bell after opponents' moves.

* Saved games that start from other than the standard initial position
now begin with a postion diagram as in saved position files.  The
loader is modified to understand such save files.

* Improved error checking when trying to read from gnuchess.

* Parser understands things that look like time indications, e.g., (0:12),
instead of popping them up as comments.

* Send "quit" to gnuchess before trying to kill it.  I needed this
locally because sending a SIGTERM to rsh was not killing the remote
program on some internal field test systems we have.

* Merged in code from John Chanak to make xboard a front end to the
Internet Chess Server, and added several improvements of my own.
(These include parsing end of game messages, loading the current state
and previous history of a game that's joined in progress via "watch"
or "load", automatic switch from board style 1 to 8 when needed,
removing irrelevant buttons and adding some new ones, adding the
useTelnet and gateway resources, and miscellaneous code cleanup, bug
fixes, and documentation.)  Many thanks to John for writing and
contributing the initial version of this code.

Fri Oct 30 20:16:40 PST 1992 (patchlevel 25) mann@src.dec.com

* gnuchess now castles by sending us "o-o" or "o-o-o" (starting with a
preliminary version of 4.0.pl60 that I have).  Added code to handle
this.  The old format ("e1g1", etc.) still works too.

* Added code to format moves in normal abbreviated algebraic notation
(for example, e4, exd4, f8Q, Nf6, 0-0) instead of coordinate algebraic
(for example, e2e4, e3d4, f7f8q, g1f6, e1g1).  Moves entered with the
mouse or received from gnuchess are translated into this canonical
format for display on the message line or in saved game files.  Moves
read from game files are not translated, however; they are shown and
saved just as they appear in the file.

Mon Sep 14 13:19:01 PDT 1992 (patchlevel 24) mann@src.dec.com

* It's not really correct to write an ep capture of a pawn on e5 as
fxe5; this should be written as fxe6 because e6 is where the capturing
pawn ends up.  Nevertheless, the parser now interprets fxe5 as the ep
capture f5xe6 unless there is a pawn on f4, in which case it
interprets fxe5 as f4xe5.  By design, the parser does not flag fxe5 as
ambiguous if there are pawns on both f4 and f5; instead it prefers the
more legitimate f4xe5 interpretation.

* A move like fxe6 or fe6 is now interpreted as an e.p. capture of the
pawn on e5 if there is one there and e6 is empty.

* A move like fxe5 can no longer be interpreted as an e.p. capture if
there isn't a pawn on e5 to be captured.  Previously this could happen
erroneously if there were pawns on both f4 and f5, and the f4 pawn was
capturing a piece on e5.

* The parser no longer munges the move it is parsing; in the past, for
instance, it would remove the "x" from a move like dxc5 before echoing
it to the screen.

* The parser now detects when a move is ambiguous and returns an
error, instead of arbitrarily choosing one possibility as it used to.

Mon Aug 10 18:40:47 PDT 1992 (patchlevel 23) mann@src.dec.com

* Added code so parser can handle fully qualified algebraic, e.g.,
Ng1-f3, N/g1-f3, Ng1f3, or even Pe2-e4.  The "P" and "/" work only for
fully qualified moves, not generally.

* Fixed parser bugs in handling moves with rank or file disambiguator,
e.g. N1f3 or Ngf3.

Mon Jul  6 17:55:32 PDT 1992 (patchlevel 22) mann@src.dec.com

* AIXV3 patch from Tom McConnell; thanks!

* After hitting the Backward button we see the last move made instead of
the word "Pausing" displayed.

* Fixed a couple of problems compiling on IRIX; thanks to Michel Arsenault
and Alan Walsh for bug reports and help with fixes.

* Added optional display of algebraic notation coordinates along left and
bottom edges of board.  This was inspired by some code from Jean-Christophe
Engel; thanks!

* Swapped EditPosition and Pause buttons to reduce danger of losing the
game in progress by hitting EditPosition when you wanted Backward.  Thanks
to Ove Lundberg for complaining (though it bugged me too).

* Despite one complaint, I kept the feature of changing both clocks when black
makes time control, rather than changing each individually when the player
involved makes it.  This is to avoid having it look like White is way ahead on
time while Black is thinking about the last move of the time control period
(i.e., when White has made time control but Black hasn't yet).

* Corrected clocks to work as in real tournaments.  Time is *added* when you
reach time control; previously the clocks were simply set to the length of the
new time period.  Also, when a player's flag falls, he still does not receive a
new time allotment at the next time control, but his opponent does still
receive more time if *his* flag has not fallen; previously, time controls were
ignored for both players if either flag fell.  I forget who reported this bug.

* Added a small ESIX patch from Kayvan Sylvan.

Mon Jun 22 13:24:38 PDT 1992 (patchlevel 21)

* Added some SVR4 support code from Ronald Cole.  It's Greek to me.

* Note:  Stephen Meatheringham reports a bug causing xboard to crash with an
error from the X server when run on a Sun Sparcstation IPX with Solaris 1.0.1
and OpenWindows 3.0.  This bug has not been tracked down yet.

* Fixed a problem with ATTENTION code.  On some operating systems, you have to
be even more cautious about when you send a SIGINT to gnuchess, because the
signal handler gets deinstalled each time it is used, and gnuchess does not
reinstall it immediately.  In particular, if you send a SIGINT and make an
illegal move or ask for a hint, gnuchess does not reinstall the handler until
*after* you make your next move, so you had better not send a SIGINT before
it.  I put a workaround for this case into xboard; I hope there are no more.

* The ATTENTION code is needed when compiling for the ESIX operating system,
because ESIX has a bug in the FIONREAD ioctl, so the code in gnuchess that
lets you interrupt its thinking on your time just by typing in your move does
not work.  Perhaps gnuchess will have a workaround for this eventually.

* Fixed yet another bug in using XtGetValues; code to inhibit shell resizing
was leaving a null pointer as the place to store the current sizes.

* Man page fixes: corrected -sl to -sd, updated LIMITATIONS.

* Added include of <sys/time.h> conditional on HAS_GETTIMEOFDAY.  I hope this
works for all systems; on mine, <time.h> and <sys/time.h> are the same file,
but with an #ifndef that makes it harmless to include both.

* Thanks for reports from Mike Pearlman, Stephen Meatheringham, Kayvan Sylvan,
d87-mal@nada.kth.se, Urban Koistinen, and Ronald Cole.

Mon Jun  8 11:39:18 PDT 1992 (patchlevel 20)

* Documented default value of initString and explained what it means.  This
paragraph also serves to inform the user that xboard by default will tell
gnuchess to think on his time, something one user apparently didn't understand.

* Redid -searchDepth (formerly -searchLevel) and -searchTime code.  They both
work correctly with gnuchess 3.1 now.  The -searchDepth option also works
correctly with gnuchess 4.0.  The -searchTime option does not work with
gnuchess 4.0.pl50 or earlier because those gnuchess versions do not have a
working searchTime feature.  Instead of having xboard do a half-baked emulation
of this feature by using a 1-move time control, I will be submitting a patch to
the gnuchess folks to restore the feature as in 3.1.

* Improved clock code.  It now keeps accurate track of fractional seconds of
clock running time, if your system has gettimeofday(); if not, it is generous
about them---if a clock has been going for n.m seconds when it is stopped, only
n seconds are charged.  Previously, xboard would charge one second immediately
when a clock was started, so if n.m had elapsed when it was stopped, n+1 would
be charged.  This should stop xboard from thinking gnuchess has let its flag
fall on the last move of a time control, as it often did before.  I also
improved the comments and condensed the code a little.  I hope there are no
systems that have X11 and don't have gettimeofday(), but if there are, I'd like
to know what to replace it with.

* "Flag dropped" messages now show up on the top line, beside the clocks, so
that they don't obscure more interesting messages on the second line.

* Fixed confusion of NULL and '\000'.

* Include time.h to get ctime() declaration.

* Fix to "parser bug" messages in parser.l.

* Changed code to work with old-fashioned tolower() macro that requires its
argument to be an uppercase letter.

* Minor fix to some usage error messages; was reversing program name and
erroneous argument value.

* Thanks to Mitch Wright, Ranier Orth, and Henrik Schmiediche for bug reports.

Fri Jun  5 13:06:08 PDT 1992 (patchlevel 19)

* Note: xboard does not seem to work when compiled with gcc 1.40 on a
PS/2 running AIX.  It crashes at the sscanf in line 768 of xboard.c.
You can work around the problem by specifying the -timeControl option
on the command line instead of defaulting it.  This does not seem to
be a bug in xboard itself; it runs okay on PS/2 AIX when compiled with
MetaWare High C.  [But see 2.1.pl8 above.]

* Removed bogus files from distribution.

* Changed variable name that conflicted with SVR4 ttyname function.

* Thanks to Christoph Strozyk for another bug report, and to several
of the folks mentioned under patchlevel 18 for testing it.

Wed Jun  3 17:50:37 PDT 1992 (patchlevel 18) mann@src.dec.com

* Added an include of sys/fcntl.h to pick up the definition of O_RDWR for
System V users.

* Fixed a bug in CatchPipeSignal; was testing the wrong variable to determine
which chess program got the signal.

* Removed the declaration of strrchr, which was causing problems for some
people, and added an include of <string.h> or <strings.h> instead.

* Fixed a bunch of type errors uncovered by compilers that check more carefully
than the one I was using.  I just patched many of them with casts---typically
cases where a function didn't take the same number and type of arguments as the
X header file prototype said it should---because I didn't see any other way to
fix them.  The versions of the X header files that I have don't actually have
full prototypes for these function types; they declare only the return type and
just give the argument types as comments.

* InitChessProgram returns immediately if chess program died while we were
waiting for it to say "Chess".  I think this fixes a bug that could make xboard
crash or go into an infinite loop printing "Warning: Select failed; error code
9" if gnuchess crashed there.

* Removed code that tries to put the file descriptor used to read messages from
gnuchess into nonblocking mode.  I don't see how this kludge could ever have
fixed the problem it was intended to (see below), and it seemed to be causing
a race condition when we were waiting for the initial message from gnuchess
after it started up.

* Thanks to Richard K. Lloyd, Konstantinos Konstantinides, Mark
Seiden, Erik Schoenfelder, Andreas Stolcke, Rainer Orth, Henry Thomas,
and Kris Van Hees for bug reports and help with fixes.

Sun May 31 08:00:00 PDT 1992 (patchlevel 17) Bart Massey bart@cs.uoregon.edu

*  'xboard' suffered from a couple of serious bugs.  An initial
   size needed to be given to the message label to avoid a race
   condition (!) so I gave it some text (otherwise occasionally
   xboard would fail because the message widget was 0 width under
   MIT X11R4).  The sizes needed to be Dimension, not int, because
   they were written in by Xt -- on my big-endian box Dimension
   is short, causing chaos.  Also, I hacked a declaration in for
   strrchr() to shut the compiler up -- this is arguably a kludge,
   but I couldn't think of anything better; maybe you can.

Fri May 22 13:40:50 PDT 1992 (patchlevel 16)

* First real (non-beta) release of version 2.0.

* Added GNU copyleft notices covering version 2.0 enhancements.

Thu May 21 12:30:09 PDT 1992 (patchlevel 15)

* Removed -g from Imakefile.

* Added casts in parser.l to prevent warning messages from some C compilers.

* Bugfix: code to exit if chess program couldn't be started had bug in error
message printing.

Tue May 19 11:58:06 PDT 1992 (patchlevel 14)

* Fixes one small bug: If LoadGame does not find a game in the file, it resets
xboard to BeginningOfGame mode (as if the Reset button was pressed), instead of
leaving it in LoadGame mode.

Mon Apr 13 18:32:27 PDT 1992 (patchlevel 13)

* Improved error handling when gnuchessx crashes.  Now displays a message and
enters EndOfGame state without exiting.  This should help with diagnosing
gnuchessx problems, since the position and move history are not lost.

* Debugged man page.

Version 2.0 -- Thu Apr  2 16:04:54 PST 1992 (patchlevel 12)

* Added small 40x40 pixel pieces; board size now specified as small, medium, or
large.

* Improved man page.

* Saved position files now say "white to play" if it's white's move.

* SavePosition while in EditPosition mode now gets side to play right.

* Made "Pawn" the default on edit position menus.

* Removed "To play" from edit position menus, since it's redundant.  Left
support code in so it can be restored if someone wants it.

* Tightened parser's definition of a move number to help further with skipping
over stuff before the first move.

* Put back feature of skipping over stuff in game files before a start of game
marker.  This helps when loading electronic mail messages that have things
like "00" in the header (looks like castling), or that talk about moves in
running text before the actual game score.  Tradeoff is that we can't load
games that don't either have move numbers or say "gnuchess game" just before
the moves.

* Changed version number to 2.0 because others have used "1.3" for patched
versions of 1.2.  Display version number and patchlevel at startup.

Thu Apr  2 15:30:22 PST 1992 (patchlevel 11)

* Bugfix:  Match started with TwoMachines button now handles the case where
user loaded/edited a position *and* forced some moves.

* added error message feedback to many cases where the user's button press is
rejected because it isn't allowed in the current mode.

* added -noChessProgram option to allow use as a passive chessboard without
gnuchess, replacing old buggy scheme that tried to do this automatically when
gnuchess was not found on the search path.

* parser accepts "=" in front of promotion piece

* parser accepts ":" notation for captures

* Removed SwitchSides button to make room for EditPosition.  Left code in
place, ifdef'ed out.

* Added EditPosition mode.

* Reformatted xboard.c to eliminate long lines.

* Promotion popup now appears near rank to which pawn is moving.

* UI improvement: Button representing current program mode is kept highlighted.

* Bug fix:  Hint button is now disabled when machine is on move.

Sat Mar 21 14:57:37 PST 1992 (patchlevel 10)

* TwoMachines now works from MachineWhite or MachineBlack mode.

* ForceMoves and Backward/Forward now work at the end of a game started by
the TwoMachines button.

* Sends o-o or o-o-o to gnuchess instead of O-O or O-O-O.

* Bug fix:  SwitchSides button is now disabled when machine is on move.

* Added -searchLevel option and corrected handling of -searchTime to reflect
the way gnuchess really handles command line options instead of what the
documentation used to say.  Allowed optional ":seconds" on times.

Tue Mar 17 21:00:35 PST 1992 (patchlevel 9)

* Removed non-working code that tried to recover when a remote chess program
could not be started; now exits with a message instead.

* Now waits for chess program to print its first message (normally "Chess")
before sending it any commands.

* Matches between two machines can now start from a black-to-play position or
black-to-play opening.

* Bug fix: The program would sometimes lose track of the board position after
the end of the game, drawing a board full of white pawns next time it got an X
redraw request.  Now fixed.

* Cleaned up handling of illegal moves in game files.  Now we just stop reading
and go into ForceMoves mode.

* Saved games against gnuchess indicate who won (restored and debugged 1.2
feature).

* Setting -searchTime turns off -clockMode.

* My trick for setting up a black-to-play position broke in the transition from
gnuchess 3.1+ to 4.0.  Installed a different trick that works with both.

* Bug fix: Was clobbering memory by mallocing one byte too few for the file
name in SetupPositionFromFileProc.  This usually resulted in a crash on the
second attempt to load a position from a file.

Mon Mar 16 16:49:00 PST 1992 (patchlevel 8)

* Game and position files are saved in CHESSDIR as well as loaded from there.
We actually chdir there, so gnuchess listing files also wind up there.

* Underpromotion moves from gnuchess really work now.

Sat Mar 14 14:55:24 PST 1992 (patchlevel 7)

* Cleaned up lots of bugs and kruft in parser.l.  It's a wonder the old version
worked at all.  Improved rejection of random text interspersed with the moves.

* Relabeled buttons to reduce confusion (Play From File --> Load Game;
Setup From File --> Load Position).

* Bug fix:  Doesn't exit at the end of a game that was started by pressing
the Two Machines button.

* Bug fix:  Doesn't get confused if you hit Machine Black (White) while
the machine is already playing black (white) and is on move.

* Prints "White to play" or "Black to play" after loading a position file.

* Bug fix:  No longer hangs if no start-of-game is found in a game file.

* More permissive about game file format.  The first line is not assumed
to be a header comment unless it starts with "#".  We don't insist on
seeing a "1." before the first move.

* Added pop-up dialog to allow underpromotion.  Moving a pawn to the last rank
pops up a dialog to let you select what piece to promote to.  Also added code
to handle underpromotion moves from gnuchess or from a game file correctly.

* Added code to send SIGINT to gnuchess before trying to move, if gnuchess
might be busy thinking on our time.  The code is ifdef'ed out because it's
not necessary; only beta-test versions of gnuchess 4.0 at patchlevel 19 or
below require it.

Mon Feb 24 20:10:22 PST 1992

* Merged fixes received from Stuart Cracraft and Mike McGann, to iconic mode
and to ShutdownChessPrograms.  (They both sent the same fixes.)  I did not
install the change that removed "easy" from the initialization string, so
xboard will still try to run gnuchessx in "hard" mode (thinking on opponent's
time) by sending this command.

Version 1.3 -- Thu Dec 19 18:19:00 PST 1991  mann@src.dec.com (Tim Mann)

* I've fixed a slew of bugs in this version of xboard:

* You can now back up from the end of a game, even if gnuchess was playing
against you.  Since gnuchess exits upon mate or draw (when it's not in force
mode), this feature works by starting up a new copy of gnuchess and feeding it
the saved starting position and moves.  Drawback: the new gnuchess starts with
clocks at the beginning of a fresh time control.

* Note: the "force" command to gnuchess is a toggle.  I fixed a couple of
places in xboard where "force" was being issued when gnuchess was already in
force mode, which resulted in chaos.  I don't know if they were in 1.2 or if I
added them myself in the course of putting in new features.

* ForceMoves button is now legal in PlayFromFile mode.  It closes the game file
and lets you force moves (or go Backward) from whatever position you've
reached.

* The parser now recognizes "white resigns" and "black resigns" (in any
combination of upper and lower case, with or without the closing "s").  These
used to be misinterpreted as meaning "white wins" or "black wins" respectively!
Added "1 - 0" and "0 - 1" as equivalents for "1-0" and "0-1".

* I removed the parser feature of considering "!" as a comment delimiter.
"!" is so common as an annotation in game scores that this feature seems like a
very bad idea.

* Added a wait() after each successful call to kill() to avoid leaving zombie
processes around.

* Removed the feature of putting an indication of how the game ended into the
internal move list when playing from a file.  The only benefit of this was that
it would get written back out if you saved the game at that point.  This
feature doesn't seem too useful, since you are unlikely to save a game you've
read in without making any changes, and it caused a lot of problems in the code
and user interface.  The end condition is still displayed as a message when
it's first read in from the file.  End conditions when playing against gnuchess
are still saved, too.

* programName is now the last file name component of argv[0], not all of it.

* xboard.c got three compiler warnings due to arguments that didn't match the
prototypes on X toolkit functions.  I got rid of them by adding some casts, and
adding extra unused arguments to the ReceiveFromProgram function.

* As I received it, the distribution had an extra period glued on the front
of every line that started with a period.  This broke the manpage in an
obvious way.  It also broke parser.l in a nonobvious way that stopped
PlayFromFile from working.

* Fixed one or two bugs where the clock was started when it shouldn't have
been.  I think one example was if you tried an illegal move in ForceMoves mode.

* Now starts the machine's clock if you hit MachineWhite when white is on move
or MachineBlack when black is on move.

* Now updates the to-move indicator (highlight on clock display) when you use
Forward/Backward or ForceMoves.

* gnuchess 3.1+ has a bug that makes it try to think on its opponent's time
even when in force mode; this causes problems with xboard's SetupFromFile
command because gnuchess's saved hint move is garbage after the new position is
loaded, so gnuchess prints out an error message when it tries to think about
what it would do if the user made this move.  Here is a patch for gnuchess
3.1+:

*** nondsp.c~   Mon Dec  2 12:37:18 1991
*-- nondsp.c    Thu Dec 19 15:36:06 1991
***************
*** 1223,1229 ****
    ok = flag.quit = false;
    player = opponent;
    ft = 0;
!   if (hint > 0 && !flag.easy && Book == NULL)
      {
        fflush (stdout);
        time0 = time ((long *) 0);
*-- 1223,1229 ----
    ok = flag.quit = false;
    player = opponent;
    ft = 0;
!   if (hint > 0 && !flag.easy && Book == NULL && !flag.force)
      {
        fflush (stdout);
        time0 = time ((long *) 0);

* SavePosition/SetupFromFile now handle black-to-play positions.  If it's
black's move in a saved position, the line "black to play" is printed
immediately after the board display.  Upon loading a position, xboard
looks for "black" at the beginning of this line to determine whether it's
black's move.

* SetupFromFile now leaves you (effectively) in ForceMoves mode.  This
eliminates some cases where the program would get into an inconsistent state,
and hopefully is more intuitive for the user, too.

* PlayFromFile now leaves xboard in ForceMoves mode after playing through all
the moves in the file.  You can use Backward/Forward, make moves, get gnuchess
to join the game with MachineWhite or MachineBlack, etc.  The game file can end
with either white or black to play.

* Backward/Forward now seem to work in all cases.  Previously using these
buttons during a game against the machine would get xboard out of sync with
gnuchess's idea of what was going on, resulting in chaos.  Now using these
buttons puts xboard in ForceMoves mode; you can bring gnuchess back into the
game using the MachineWhite or MachineBlack buttons.

Thu Jun 27 15:06:25 PDT 1991

  * Remove comment popups during a reset.

  * Bug in my forward move fix.  Didn't work for playgamefile mode.

Thu Jun 20 15:04:06 PDT 1991

  * Can't do a backward move when it isn't your turn because gnuchess
    gets confused.  Similar bug for forward move.  Do a bunch of moves,
    back up move and go forward.  These get filtered out now.

  * Put easy back into the initString.  This DISABLES easy mode which by
    default is ON.

  * New-line wasn't always being added to forward move strings sent to gnuchess.

  * Parsed comments as [ ..............text follows ] into d7d5

  * Long game file comments cause core dumps on HP systems.

  * Multiple uses of the get positition file button got confused
    on the second click.

  Minor fixes to the 1.2 release

Version 1.2 -- Tue Jun 11 17:14:12 PDT 1991

  * For version 1.2, Jeff Kenton, Richard LLoyd, David Jensen, Martin D.,
    Bill Schmidt, Scott Hemphill, Paul Vaughan and Bill Shauck all found
    a lot of bugs that we put into xboard just to see if they were paying
    attention.  They were.

  * Changed the protocol that xboard uses to work with the new version of
    gnuchessr.

  * There was an off by one error with the clock resetting code.  Also,
    the clock display highliting was wrong.  Thanks to Bill Shauck for
    pointing these out.

  * enumerations are not really integers on some C compilers.  I added casting.
    The new version of gnuchess expects the "go" command for two machine
    and machine plays white cases.  The whiteString resource is for
    compatibility with previous gnuchess versions which get confused by go.
    Thanks to Martin D. for catching these.

  * Fixed a bug where the checkmate message wasn't being parsed and xboard
    kept playing.  Also, the message was added to game file if saved.
    Thanks to Scott Hemhill for pointing this out.

  * Fixed a bug where saving a long game, resetting and saving a short game
    resulted in appending the end of the long game to the short one.
    If a game is just being played out and there is no reason for gnuchessr
    to be used, ignore pipe signals.  This allows people to use xboard
    as a chess board without need for gnuchess.  Also, trivially bad moves
    such as e2e2 are not passed on to gnuchessr but instead ignored out of
    hand.  This allows people using xboard as a chessboard with gnuchessr
    to pick a piece up, think and put it back down without making a move.
    Thanks to Jeff Kenton for pointing these out.

  * Added the CHESSDIR environment variable.  Game and position files are
    found in this directory.  If this variable is not declared, then the
    current directory is used.  File names starting with / are treated
    specially.

  * The bitmap file names were changed so that none exceeded 14 characters.
    This is necessary for R5.

        fcntl(from_prog[0], F_SETFL, O_NDELAY);

    The xboard fix was to set non-blocking i/o on the read pipe for gnuchessr

        printz ("Illegal move (no matching move generated)");

  * fixed a problem with the new version of gnuchessr where xboard wasn't
    getting gnuchessr error messages for illegal moves.  The problem seems
    to be fixed *without* any gnuchess changes but this is likely to be
    highly system dependant.  There should be a new line on line 246 of nondsp.c

  * -iconic doesn't work at all now.  The Iconify() does work.  This was
    a tradeoff and it is really an Xt bug.

  * Fixed a compiler warning for gcc and an error for the IBM RT compilers.
    This is the VOID_PROC macro in xboard.h.  Thanks to David Jensen for this.

  * If the DisplayWidth or DisplayHeight is less than 800, use small size mode.
    Also the size of the name widget was reduced from 500 pixels to 400 pixels
    because in small size mode there was a gap on the right.
    Changed the default font from fixed to helvetica_oblique14 to:
        **-helvetica-bold-r-normal--14-*-*-*-*-*-*-*
    helvetica_oblique14 is a font alias not on all R4 systems.
    Curiously enough, the 17 point is not available on 75dpi systems
    and the 18 point font is not available on 100dpi systems.
    Thanks to Richard K. Lloyd for pointing these out.

  * Minor hacks to work with R5 alpha.  Had to add an event handler to the
    boardWidget to get translations to work.  This may go away with the real R5.
    Added <Message>WM_PROTOCOLS: QuitProc() for R5 ICCCM compatibility.

  * If the first character of the file is not `1' then the first line
    of a game or position file is displayed as the name in a label widget.

  * Added a PopUp dialog for getting file names.

  * Modified the code to use the R4 routines rather than R3 compatibility.

  * Changed the forwards/backwards/readgamefile code to allow a play to step
    back and forth in a game.  If he steps all the way to the beginning
    he has to restart the game.  If he gets into a mated position, same problem.

  * Moved the man page from xboard.1 to xboard.man.  This makes imake man page
    installs work correctly.  Thanks to Richard K. Lloyd for pointing this out.

  * Corrected the queening code.  XBoard was sending the wrong syntax.
    It was sending for example h8(Q) when it should have been sending h8q.
    Thanks to Paul Vaughan and Mike McGann for pointing this out.

  * Added a lex parser for algebraic games.  It should be easy to use the parser
    for other interfaces such as the Microsoft Windows version.
    It parses comments of the form [anything] and ! to the end of a line.

Version 1.1 -- Mon Jan  7 14:46:03 PST 1991

  * Roger Dubar, Konstantinos Konstantinides, Wolfgang S. Rupprecht,
    Paul Scowen, Mvh Smidt and Kayvan Sylvan all helped immensely during
    beta-testing.

  * older non-ANSI versions of Sun compilers complain vociferously.

  * the remoteShell resource was added for HP-UX systems
    and other systems where the remoteShell isn't rsh.

  * -iconic doesn't work properly.  If XBoard is opened iconic then
    iconifying it later with a keystroke doesn't work.  I think
    this is an Xt bug.

  * For systems with smaller screens, XBoard can use smaller pieces,
    and a smaller board.  -bigSizeMode False uses a smaller set of pieces.
    These are scaled versions of the large pieces.  They look ok but could
    be improved.

  * getlogin() does not work in all cases.
    It was replaced by getpwuid(getuid())->pw_name).

  * Warning messages get displayed in the message box.

  * Any button restarts a paused game.

  * Kayvan Sylvan contributed a patch for ESIX.
    It seems that select() on pipes is broken on his system.  We declined
    to incorporate his patch though, because it was a work-around for
    something that was broken on one system, and selfishly, that system
    was not my own.  Nevertheless, it is likely that other System V users
    on PC's may need to use this patch and it is is included as the file
    ESIX.patch.  To use it, type

        patch xboard.c ESIX.patch

  * Fixed a bug where hint didn't work.  The local version of gnuchessr
    had been hacked.  The fix was to clone stderr and stdout for gnuchessr.

  * Fixed a bug where a player could play after a game had been finished.

  * The bitmaps have been pushed into the bitmaps directory.

  * Substantially rewrote and simplified the Two Machine code.

  * Added StrStr() because many systems don't have this ANSI function.

  * Added keyboard equivalents.  Added an iconify keystroke, C or c.

  * Works with gcc now.  gcc complained about casting float constants
    as XtPointers.

  * Detect if the visual doesn't support color.  If so, run in monoMode.
    An alternative would be to detect grayscale visual and use a collection
    of gray user interface colors.

        XBoard.clockMode:    False

  * For people who don't like or use chess clocks a clockMode switch
    has been added.  It is on by default.  It can be turned off in the
    .Xdefaults file with

  * Added a declaration, xtVersion, which will quickly break on R3 Intrinsics.

  * Hal Peterson contributed a new Imakefile.

  * Rewrote DisplayClocks().

  * Rewrote TwoMachinesPlay mode.

  * Konstantinos Konstantinides added the -searchTime option.

  * Substantially rewrote and simplified the clock code.  If a game was paused
    and then resumed, the clocks were out of sync.

  * Fixed a bug in HandleUserMove() where the user could make a move while the
    machine was thinking.  The fix detects and ignores these moves.  onMove
    was not being used and was removed.
